e788b53fe32d26910d4c303bccaf5639









'use strict';var _extends = Object.assign || function (target) {for (var i = 1; i < arguments.length; i++) {var source = arguments[i];for (var key in source) {if (Object.prototype.hasOwnProperty.call(source, key)) {target[key] = source[key];}}}return target;};

var ColorPropType = require('ColorPropType');
var NativeMethodsMixin = require('NativeMethodsMixin');
var PropTypes = require('prop-types');
var Platform = require('Platform');
var React = require('React');
var ReactNativeViewAttributes = require('ReactNativeViewAttributes');
var StyleSheet = require('StyleSheet');
var Touchable = require('Touchable');
var TouchableWithoutFeedback = require('TouchableWithoutFeedback');
var View = require('View');
var ViewPropTypes = require('ViewPropTypes');

var createReactClass = require('create-react-class');
var ensurePositiveDelayProps = require('ensurePositiveDelayProps');






var DEFAULT_PROPS = {
  activeOpacity: 0.85,
  delayPressOut: 100,
  underlayColor: 'black' };


var PRESS_RETENTION_OFFSET = { top: 20, left: 20, right: 20, bottom: 30 };



















































































































var TouchableHighlight = createReactClass({
  displayName: 'TouchableHighlight',
  propTypes: _extends({},
  TouchableWithoutFeedback.propTypes, {




    activeOpacity: PropTypes.number,




    underlayColor: ColorPropType,




    style: ViewPropTypes.style,



    onShowUnderlay: PropTypes.func,



    onHideUnderlay: PropTypes.func,





    hasTVPreferredFocus: PropTypes.bool,














    tvParallaxProperties: PropTypes.object,



    testOnly_pressed: PropTypes.bool }),


  mixins: [NativeMethodsMixin, Touchable.Mixin],

  getDefaultProps: function getDefaultProps() {return DEFAULT_PROPS;},

  getInitialState: function getInitialState() {
    this._isMounted = false;
    if (this.props.testOnly_pressed) {
      return _extends({},
      this.touchableGetInitialState(), {
        extraChildStyle: {
          opacity: this.props.activeOpacity },

        extraUnderlayStyle: {
          backgroundColor: this.props.underlayColor } });


    } else {
      return _extends({},
      this.touchableGetInitialState(), {
        extraChildStyle: null,
        extraUnderlayStyle: null });

    }
  },

  componentDidMount: function componentDidMount() {
    this._isMounted = true;
    ensurePositiveDelayProps(this.props);
  },

  componentWillUnmount: function componentWillUnmount() {
    this._isMounted = false;
    clearTimeout(this._hideTimeout);
  },

  UNSAFE_componentWillReceiveProps: function UNSAFE_componentWillReceiveProps(nextProps) {
    ensurePositiveDelayProps(nextProps);
  },

  viewConfig: {
    uiViewClassName: 'RCTView',
    validAttributes: ReactNativeViewAttributes.RCTView },






  touchableHandleActivePressIn: function touchableHandleActivePressIn(e) {
    clearTimeout(this._hideTimeout);
    this._hideTimeout = null;
    this._showUnderlay();
    this.props.onPressIn && this.props.onPressIn(e);
  },

  touchableHandleActivePressOut: function touchableHandleActivePressOut(e) {
    if (!this._hideTimeout) {
      this._hideUnderlay();
    }
    this.props.onPressOut && this.props.onPressOut(e);
  },

  touchableHandlePress: function touchableHandlePress(e) {
    clearTimeout(this._hideTimeout);
    if (!Platform.isTV) {
      this._showUnderlay();
      this._hideTimeout = setTimeout(
      this._hideUnderlay,
      this.props.delayPressOut);

    }
    this.props.onPress && this.props.onPress(e);
  },

  touchableHandleLongPress: function touchableHandleLongPress(e) {
    this.props.onLongPress && this.props.onLongPress(e);
  },

  touchableGetPressRectOffset: function touchableGetPressRectOffset() {
    return this.props.pressRetentionOffset || PRESS_RETENTION_OFFSET;
  },

  touchableGetHitSlop: function touchableGetHitSlop() {
    return this.props.hitSlop;
  },

  touchableGetHighlightDelayMS: function touchableGetHighlightDelayMS() {
    return this.props.delayPressIn;
  },

  touchableGetLongPressDelayMS: function touchableGetLongPressDelayMS() {
    return this.props.delayLongPress;
  },

  touchableGetPressOutDelayMS: function touchableGetPressOutDelayMS() {
    return this.props.delayPressOut;
  },

  _showUnderlay: function _showUnderlay() {
    if (!this._isMounted || !this._hasPressHandler()) {
      return;
    }
    this.setState({
      extraChildStyle: {
        opacity: this.props.activeOpacity },

      extraUnderlayStyle: {
        backgroundColor: this.props.underlayColor } });


    this.props.onShowUnderlay && this.props.onShowUnderlay();
  },

  _hideUnderlay: function _hideUnderlay() {
    clearTimeout(this._hideTimeout);
    this._hideTimeout = null;
    if (this.props.testOnly_pressed) {
      return;
    }
    if (this._hasPressHandler()) {
      this.setState({
        extraChildStyle: null,
        extraUnderlayStyle: null });

      this.props.onHideUnderlay && this.props.onHideUnderlay();
    }
  },

  _hasPressHandler: function _hasPressHandler() {
    return !!(
    this.props.onPress ||
    this.props.onPressIn ||
    this.props.onPressOut ||
    this.props.onLongPress);

  },

  render: function render() {
    var child = React.Children.only(this.props.children);
    return (
      React.createElement(View, {
          accessible: this.props.accessible !== false,
          accessibilityLabel: this.props.accessibilityLabel,
          accessibilityHint: this.props.accessibilityHint,
          accessibilityRole: this.props.accessibilityRole,
          accessibilityStates: this.props.accessibilityStates,
          style: StyleSheet.compose(
          this.props.style,
          this.state.extraUnderlayStyle),

          onLayout: this.props.onLayout,
          hitSlop: this.props.hitSlop,
          isTVSelectable: true,
          tvParallaxProperties: this.props.tvParallaxProperties,
          hasTVPreferredFocus: this.props.hasTVPreferredFocus,
          onStartShouldSetResponder: this.touchableHandleStartShouldSetResponder,
          onResponderTerminationRequest:
          this.touchableHandleResponderTerminationRequest,

          onResponderGrant: this.touchableHandleResponderGrant,
          onResponderMove: this.touchableHandleResponderMove,
          onResponderRelease: this.touchableHandleResponderRelease,
          onResponderTerminate: this.touchableHandleResponderTerminate,
          nativeID: this.props.nativeID,
          testID: this.props.testID },
        React.cloneElement(child, {
          style: StyleSheet.compose(
          child.props.style,
          this.state.extraChildStyle) }),


        Touchable.renderDebugView({
          color: 'green',
          hitSlop: this.props.hitSlop })));



  } });


module.exports = TouchableHighlight;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlRvdWNoYWJsZUhpZ2hsaWdodC5qcyJdLCJuYW1lcyI6WyJDb2xvclByb3BUeXBlIiwicmVxdWlyZSIsIk5hdGl2ZU1ldGhvZHNNaXhpbiIsIlByb3BUeXBlcyIsIlBsYXRmb3JtIiwiUmVhY3QiLCJSZWFjdE5hdGl2ZVZpZXdBdHRyaWJ1dGVzIiwiU3R5bGVTaGVldCIsIlRvdWNoYWJsZSIsIlRvdWNoYWJsZVdpdGhvdXRGZWVkYmFjayIsIlZpZXciLCJWaWV3UHJvcFR5cGVzIiwiY3JlYXRlUmVhY3RDbGFzcyIsImVuc3VyZVBvc2l0aXZlRGVsYXlQcm9wcyIsIkRFRkFVTFRfUFJPUFMiLCJhY3RpdmVPcGFjaXR5IiwiZGVsYXlQcmVzc091dCIsInVuZGVybGF5Q29sb3IiLCJQUkVTU19SRVRFTlRJT05fT0ZGU0VUIiwidG9wIiwibGVmdCIsInJpZ2h0IiwiYm90dG9tIiwiVG91Y2hhYmxlSGlnaGxpZ2h0IiwiZGlzcGxheU5hbWUiLCJwcm9wVHlwZXMiLCJudW1iZXIiLCJzdHlsZSIsIm9uU2hvd1VuZGVybGF5IiwiZnVuYyIsIm9uSGlkZVVuZGVybGF5IiwiaGFzVFZQcmVmZXJyZWRGb2N1cyIsImJvb2wiLCJ0dlBhcmFsbGF4UHJvcGVydGllcyIsIm9iamVjdCIsInRlc3RPbmx5X3ByZXNzZWQiLCJtaXhpbnMiLCJNaXhpbiIsImdldERlZmF1bHRQcm9wcyIsImdldEluaXRpYWxTdGF0ZSIsIl9pc01vdW50ZWQiLCJwcm9wcyIsInRvdWNoYWJsZUdldEluaXRpYWxTdGF0ZSIsImV4dHJhQ2hpbGRTdHlsZSIsIm9wYWNpdHkiLCJleHRyYVVuZGVybGF5U3R5bGUiLCJiYWNrZ3JvdW5kQ29sb3IiLCJjb21wb25lbnREaWRNb3VudCIsImNvbXBvbmVudFdpbGxVbm1vdW50IiwiY2xlYXJUaW1lb3V0IiwiX2hpZGVUaW1lb3V0IiwiVU5TQUZFX2NvbXBvbmVudFdpbGxSZWNlaXZlUHJvcHMiLCJuZXh0UHJvcHMiLCJ2aWV3Q29uZmlnIiwidWlWaWV3Q2xhc3NOYW1lIiwidmFsaWRBdHRyaWJ1dGVzIiwiUkNUVmlldyIsInRvdWNoYWJsZUhhbmRsZUFjdGl2ZVByZXNzSW4iLCJlIiwiX3Nob3dVbmRlcmxheSIsIm9uUHJlc3NJbiIsInRvdWNoYWJsZUhhbmRsZUFjdGl2ZVByZXNzT3V0IiwiX2hpZGVVbmRlcmxheSIsIm9uUHJlc3NPdXQiLCJ0b3VjaGFibGVIYW5kbGVQcmVzcyIsImlzVFYiLCJzZXRUaW1lb3V0Iiwib25QcmVzcyIsInRvdWNoYWJsZUhhbmRsZUxvbmdQcmVzcyIsIm9uTG9uZ1ByZXNzIiwidG91Y2hhYmxlR2V0UHJlc3NSZWN0T2Zmc2V0IiwicHJlc3NSZXRlbnRpb25PZmZzZXQiLCJ0b3VjaGFibGVHZXRIaXRTbG9wIiwiaGl0U2xvcCIsInRvdWNoYWJsZUdldEhpZ2hsaWdodERlbGF5TVMiLCJkZWxheVByZXNzSW4iLCJ0b3VjaGFibGVHZXRMb25nUHJlc3NEZWxheU1TIiwiZGVsYXlMb25nUHJlc3MiLCJ0b3VjaGFibGVHZXRQcmVzc091dERlbGF5TVMiLCJfaGFzUHJlc3NIYW5kbGVyIiwic2V0U3RhdGUiLCJyZW5kZXIiLCJjaGlsZCIsIkNoaWxkcmVuIiwib25seSIsImNoaWxkcmVuIiwiYWNjZXNzaWJsZSIsImFjY2Vzc2liaWxpdHlMYWJlbCIsImFjY2Vzc2liaWxpdHlIaW50IiwiYWNjZXNzaWJpbGl0eVJvbGUiLCJhY2Nlc3NpYmlsaXR5U3RhdGVzIiwiY29tcG9zZSIsInN0YXRlIiwib25MYXlvdXQiLCJ0b3VjaGFibGVIYW5kbGVTdGFydFNob3VsZFNldFJlc3BvbmRlciIsInRvdWNoYWJsZUhhbmRsZVJlc3BvbmRlclRlcm1pbmF0aW9uUmVxdWVzdCIsInRvdWNoYWJsZUhhbmRsZVJlc3BvbmRlckdyYW50IiwidG91Y2hhYmxlSGFuZGxlUmVzcG9uZGVyTW92ZSIsInRvdWNoYWJsZUhhbmRsZVJlc3BvbmRlclJlbGVhc2UiLCJ0b3VjaGFibGVIYW5kbGVSZXNwb25kZXJUZXJtaW5hdGUiLCJuYXRpdmVJRCIsInRlc3RJRCIsImNsb25lRWxlbWVudCIsInJlbmRlckRlYnVnVmlldyIsImNvbG9yIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBU0EsYTs7QUFFQSxJQUFNQSxnQkFBZ0JDLFFBQVEsZUFBUixDQUF0QjtBQUNBLElBQU1DLHFCQUFxQkQsUUFBUSxvQkFBUixDQUEzQjtBQUNBLElBQU1FLFlBQVlGLFFBQVEsWUFBUixDQUFsQjtBQUNBLElBQU1HLFdBQVdILFFBQVEsVUFBUixDQUFqQjtBQUNBLElBQU1JLFFBQVFKLFFBQVEsT0FBUixDQUFkO0FBQ0EsSUFBTUssNEJBQTRCTCxRQUFRLDJCQUFSLENBQWxDO0FBQ0EsSUFBTU0sYUFBYU4sUUFBUSxZQUFSLENBQW5CO0FBQ0EsSUFBTU8sWUFBWVAsUUFBUSxXQUFSLENBQWxCO0FBQ0EsSUFBTVEsMkJBQTJCUixRQUFRLDBCQUFSLENBQWpDO0FBQ0EsSUFBTVMsT0FBT1QsUUFBUSxNQUFSLENBQWI7QUFDQSxJQUFNVSxnQkFBZ0JWLFFBQVEsZUFBUixDQUF0Qjs7QUFFQSxJQUFNVyxtQkFBbUJYLFFBQVEsb0JBQVIsQ0FBekI7QUFDQSxJQUFNWSwyQkFBMkJaLFFBQVEsMEJBQVIsQ0FBakM7Ozs7Ozs7QUFPQSxJQUFNYSxnQkFBZ0I7QUFDcEJDLGlCQUFlLElBREs7QUFFcEJDLGlCQUFlLEdBRks7QUFHcEJDLGlCQUFlLE9BSEssRUFBdEI7OztBQU1BLElBQU1DLHlCQUF5QixFQUFDQyxLQUFLLEVBQU4sRUFBVUMsTUFBTSxFQUFoQixFQUFvQkMsT0FBTyxFQUEzQixFQUErQkMsUUFBUSxFQUF2QyxFQUEvQjs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFvSEEsSUFBTUMscUJBQXVCWCxpQkFBaUI7QUFDNUNZLGVBQWEsb0JBRCtCO0FBRTVDQztBQUNLaEIsMkJBQXlC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QjtBQW9CRSwyQkFBaUIsS0FBS0MsNEJBcEJ4QjtBQXFCRSw4QkFBb0IsS0FBS0MsK0JBckIzQjtBQXNCRSxnQ0FBc0IsS0FBS0MsaUNBdEI3QjtBQXVCRSxvQkFBVSxLQUFLMUQsS0FBTCxDQUFXMkQsUUF2QnZCO0FBd0JFLGtCQUFRLEtBQUszRCxLQUFMLENBQVc0RCxNQXhCckI7QUF5QkdoRyxjQUFNaUcsWUFBTixDQUFtQnBCLEtBQW5CLEVBQTBCO0FBQ3pCdkQsaUJBQU9wQixXQUFXb0YsT0FBWDtBQUNMVCxnQkFBTXpDLEtBQU4sQ0FBWWQsS0FEUDtBQUVMLGVBQUtpRSxLQUFMLENBQVdqRCxlQUZOLENBRGtCLEVBQTFCLENBekJIOzs7QUErQkduQyxrQkFBVStGLGVBQVYsQ0FBMEI7QUFDekJDLGlCQUFPLE9BRGtCO0FBRXpCL0IsbUJBQVMsS0FBS2hDLEtBQUwsQ0FBV2dDLE9BRkssRUFBMUIsQ0EvQkgsQ0FERjs7OztBQXNDRCxHQXZPMkMsRUFBakIsQ0FBN0I7OztBQTBPQWdDLE9BQU9DLE9BQVAsR0FBaUJuRixrQkFBakIiLCJmaWxlIjoiVG91Y2hhYmxlSGlnaGxpZ2h0LmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTUtcHJlc2VudCwgRmFjZWJvb2ssIEluYy5cbiAqXG4gKiBUaGlzIHNvdXJjZSBjb2RlIGlzIGxpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZSBmb3VuZCBpbiB0aGVcbiAqIExJQ0VOU0UgZmlsZSBpbiB0aGUgcm9vdCBkaXJlY3Rvcnkgb2YgdGhpcyBzb3VyY2UgdHJlZS5cbiAqXG4gKiBAZmxvd1xuICogQGZvcm1hdFxuICovXG4ndXNlIHN0cmljdCc7XG5cbmNvbnN0IENvbG9yUHJvcFR5cGUgPSByZXF1aXJlKCdDb2xvclByb3BUeXBlJyk7XG5jb25zdCBOYXRpdmVNZXRob2RzTWl4aW4gPSByZXF1aXJlKCdOYXRpdmVNZXRob2RzTWl4aW4nKTtcbmNvbnN0IFByb3BUeXBlcyA9IHJlcXVpcmUoJ3Byb3AtdHlwZXMnKTtcbmNvbnN0IFBsYXRmb3JtID0gcmVxdWlyZSgnUGxhdGZvcm0nKTtcbmNvbnN0IFJlYWN0ID0gcmVxdWlyZSgnUmVhY3QnKTtcbmNvbnN0IFJlYWN0TmF0aXZlVmlld0F0dHJpYnV0ZXMgPSByZXF1aXJlKCdSZWFjdE5hdGl2ZVZpZXdBdHRyaWJ1dGVzJyk7XG5jb25zdCBTdHlsZVNoZWV0ID0gcmVxdWlyZSgnU3R5bGVTaGVldCcpO1xuY29uc3QgVG91Y2hhYmxlID0gcmVxdWlyZSgnVG91Y2hhYmxlJyk7XG5jb25zdCBUb3VjaGFibGVXaXRob3V0RmVlZGJhY2sgPSByZXF1aXJlKCdUb3VjaGFibGVXaXRob3V0RmVlZGJhY2snKTtcbmNvbnN0IFZpZXcgPSByZXF1aXJlKCdWaWV3Jyk7XG5jb25zdCBWaWV3UHJvcFR5cGVzID0gcmVxdWlyZSgnVmlld1Byb3BUeXBlcycpO1xuXG5jb25zdCBjcmVhdGVSZWFjdENsYXNzID0gcmVxdWlyZSgnY3JlYXRlLXJlYWN0LWNsYXNzJyk7XG5jb25zdCBlbnN1cmVQb3NpdGl2ZURlbGF5UHJvcHMgPSByZXF1aXJlKCdlbnN1cmVQb3NpdGl2ZURlbGF5UHJvcHMnKTtcblxuaW1wb3J0IHR5cGUge1ByZXNzRXZlbnR9IGZyb20gJ0NvcmVFdmVudFR5cGVzJztcbmltcG9ydCB0eXBlIHtQcm9wcyBhcyBUb3VjaGFibGVXaXRob3V0RmVlZGJhY2tQcm9wc30gZnJvbSAnVG91Y2hhYmxlV2l0aG91dEZlZWRiYWNrJztcbmltcG9ydCB0eXBlIHtWaWV3U3R5bGVQcm9wfSBmcm9tICdTdHlsZVNoZWV0JztcbmltcG9ydCB0eXBlIHtDb2xvclZhbHVlfSBmcm9tICdTdHlsZVNoZWV0VHlwZXMnO1xuXG5jb25zdCBERUZBVUxUX1BST1BTID0ge1xuICBhY3RpdmVPcGFjaXR5OiAwLjg1LFxuICBkZWxheVByZXNzT3V0OiAxMDAsXG4gIHVuZGVybGF5Q29sb3I6ICdibGFjaycsXG59O1xuXG5jb25zdCBQUkVTU19SRVRFTlRJT05fT0ZGU0VUID0ge3RvcDogMjAsIGxlZnQ6IDIwLCByaWdodDogMjAsIGJvdHRvbTogMzB9O1xuXG50eXBlIElPU1Byb3BzID0gJFJlYWRPbmx5PHt8XG4gIGhhc1RWUHJlZmVycmVkRm9jdXM/OiA/Ym9vbGVhbixcbiAgdHZQYXJhbGxheFByb3BlcnRpZXM/OiA/T2JqZWN0LFxufH0+O1xuXG50eXBlIFByb3BzID0gJFJlYWRPbmx5PHt8XG4gIC4uLlRvdWNoYWJsZVdpdGhvdXRGZWVkYmFja1Byb3BzLFxuICAuLi5JT1NQcm9wcyxcblxuICBhY3RpdmVPcGFjaXR5PzogP251bWJlcixcbiAgdW5kZXJsYXlDb2xvcj86ID9Db2xvclZhbHVlLFxuICBzdHlsZT86ID9WaWV3U3R5bGVQcm9wLFxuICBvblNob3dVbmRlcmxheT86ID9GdW5jdGlvbixcbiAgb25IaWRlVW5kZXJsYXk/OiA/RnVuY3Rpb24sXG4gIHRlc3RPbmx5X3ByZXNzZWQ/OiA/Ym9vbGVhbixcbnx9PjtcblxuLyoqXG4gKiBBIHdyYXBwZXIgZm9yIG1ha2luZyB2aWV3cyByZXNwb25kIHByb3Blcmx5IHRvIHRvdWNoZXMuXG4gKiBPbiBwcmVzcyBkb3duLCB0aGUgb3BhY2l0eSBvZiB0aGUgd3JhcHBlZCB2aWV3IGlzIGRlY3JlYXNlZCwgd2hpY2ggYWxsb3dzXG4gKiB0aGUgdW5kZXJsYXkgY29sb3IgdG8gc2hvdyB0aHJvdWdoLCBkYXJrZW5pbmcgb3IgdGludGluZyB0aGUgdmlldy5cbiAqXG4gKiBUaGUgdW5kZXJsYXkgY29tZXMgZnJvbSB3cmFwcGluZyB0aGUgY2hpbGQgaW4gYSBuZXcgVmlldywgd2hpY2ggY2FuIGFmZmVjdFxuICogbGF5b3V0LCBhbmQgc29tZXRpbWVzIGNhdXNlIHVud2FudGVkIHZpc3VhbCBhcnRpZmFjdHMgaWYgbm90IHVzZWQgY29ycmVjdGx5LFxuICogZm9yIGV4YW1wbGUgaWYgdGhlIGJhY2tncm91bmRDb2xvciBvZiB0aGUgd3JhcHBlZCB2aWV3IGlzbid0IGV4cGxpY2l0bHkgc2V0XG4gKiB0byBhbiBvcGFxdWUgY29sb3IuXG4gKlxuICogVG91Y2hhYmxlSGlnaGxpZ2h0IG11c3QgaGF2ZSBvbmUgY2hpbGQgKG5vdCB6ZXJvIG9yIG1vcmUgdGhhbiBvbmUpLlxuICogSWYgeW91IHdpc2ggdG8gaGF2ZSBzZXZlcmFsIGNoaWxkIGNvbXBvbmVudHMsIHdyYXAgdGhlbSBpbiBhIFZpZXcuXG4gKlxuICogRXhhbXBsZTpcbiAqXG4gKiBgYGBcbiAqIHJlbmRlckJ1dHRvbjogZnVuY3Rpb24oKSB7XG4gKiAgIHJldHVybiAoXG4gKiAgICAgPFRvdWNoYWJsZUhpZ2hsaWdodCBvblByZXNzPXt0aGlzLl9vblByZXNzQnV0dG9ufT5cbiAqICAgICAgIDxJbWFnZVxuICogICAgICAgICBzdHlsZT17c3R5bGVzLmJ1dHRvbn1cbiAqICAgICAgICAgc291cmNlPXtyZXF1aXJlKCcuL215QnV0dG9uLnBuZycpfVxuICogICAgICAgLz5cbiAqICAgICA8L1RvdWNoYWJsZUhpZ2hsaWdodD5cbiAqICAgKTtcbiAqIH0sXG4gKiBgYGBcbiAqXG4gKlxuICogIyMjIEV4YW1wbGVcbiAqXG4gKiBgYGBSZWFjdE5hdGl2ZVdlYlBsYXllclxuICogaW1wb3J0IFJlYWN0LCB7IENvbXBvbmVudCB9IGZyb20gJ3JlYWN0J1xuICogaW1wb3J0IHtcbiAqICAgQXBwUmVnaXN0cnksXG4gKiAgIFN0eWxlU2hlZXQsXG4gKiAgIFRvdWNoYWJsZUhpZ2hsaWdodCxcbiAqICAgVGV4dCxcbiAqICAgVmlldyxcbiAqIH0gZnJvbSAncmVhY3QtbmF0aXZlJ1xuICpcbiAqIGNsYXNzIEFwcCBleHRlbmRzIENvbXBvbmVudCB7XG4gKiAgIGNvbnN0cnVjdG9yKHByb3BzKSB7XG4gKiAgICAgc3VwZXIocHJvcHMpXG4gKiAgICAgdGhpcy5zdGF0ZSA9IHsgY291bnQ6IDAgfVxuICogICB9XG4gKlxuICogICBvblByZXNzID0gKCkgPT4ge1xuICogICAgIHRoaXMuc2V0U3RhdGUoe1xuICogICAgICAgY291bnQ6IHRoaXMuc3RhdGUuY291bnQrMVxuICogICAgIH0pXG4gKiAgIH1cbiAqXG4gKiAgcmVuZGVyKCkge1xuICogICAgIHJldHVybiAoXG4gKiAgICAgICA8VmlldyBzdHlsZT17c3R5bGVzLmNvbnRhaW5lcn0+XG4gKiAgICAgICAgIDxUb3VjaGFibGVIaWdobGlnaHRcbiAqICAgICAgICAgIHN0eWxlPXtzdHlsZXMuYnV0dG9ufVxuICogICAgICAgICAgb25QcmVzcz17dGhpcy5vblByZXNzfVxuICogICAgICAgICA+XG4gKiAgICAgICAgICA8VGV4dD4gVG91Y2ggSGVyZSA8L1RleHQ+XG4gKiAgICAgICAgIDwvVG91Y2hhYmxlSGlnaGxpZ2h0PlxuICogICAgICAgICA8VmlldyBzdHlsZT17W3N0eWxlcy5jb3VudENvbnRhaW5lcl19PlxuICogICAgICAgICAgIDxUZXh0IHN0eWxlPXtbc3R5bGVzLmNvdW50VGV4dF19PlxuICogICAgICAgICAgICAgeyB0aGlzLnN0YXRlLmNvdW50ICE9PSAwID8gdGhpcy5zdGF0ZS5jb3VudDogbnVsbH1cbiAqICAgICAgICAgICA8L1RleHQ+XG4gKiAgICAgICAgIDwvVmlldz5cbiAqICAgICAgIDwvVmlldz5cbiAqICAgICApXG4gKiAgIH1cbiAqIH1cbiAqXG4gKiBjb25zdCBzdHlsZXMgPSBTdHlsZVNoZWV0LmNyZWF0ZSh7XG4gKiAgIGNvbnRhaW5lcjoge1xuICogICAgIGZsZXg6IDEsXG4gKiAgICAganVzdGlmeUNvbnRlbnQ6ICdjZW50ZXInLFxuICogICAgIHBhZGRpbmdIb3Jpem9udGFsOiAxMFxuICogICB9LFxuICogICBidXR0b246IHtcbiAqICAgICBhbGlnbkl0ZW1zOiAnY2VudGVyJyxcbiAqICAgICBiYWNrZ3JvdW5kQ29sb3I6ICcjREREREREJyxcbiAqICAgICBwYWRkaW5nOiAxMFxuICogICB9LFxuICogICBjb3VudENvbnRhaW5lcjoge1xuICogICAgIGFsaWduSXRlbXM6ICdjZW50ZXInLFxuICogICAgIHBhZGRpbmc6IDEwXG4gKiAgIH0sXG4gKiAgIGNvdW50VGV4dDoge1xuICogICAgIGNvbG9yOiAnI0ZGMDBGRidcbiAqICAgfVxuICogfSlcbiAqXG4gKiBBcHBSZWdpc3RyeS5yZWdpc3RlckNvbXBvbmVudCgnQXBwJywgKCkgPT4gQXBwKVxuICogYGBgXG4gKlxuICovXG5cbmNvbnN0IFRvdWNoYWJsZUhpZ2hsaWdodCA9ICgoY3JlYXRlUmVhY3RDbGFzcyh7XG4gIGRpc3BsYXlOYW1lOiAnVG91Y2hhYmxlSGlnaGxpZ2h0JyxcbiAgcHJvcFR5cGVzOiB7XG4gICAgLi4uVG91Y2hhYmxlV2l0aG91dEZlZWRiYWNrLnByb3BUeXBlcyxcbiAgICAvKipcbiAgICAgKiBEZXRlcm1pbmVzIHdoYXQgdGhlIG9wYWNpdHkgb2YgdGhlIHdyYXBwZWQgdmlldyBzaG91bGQgYmUgd2hlbiB0b3VjaCBpc1xuICAgICAqIGFjdGl2ZS5cbiAgICAgKi9cbiAgICBhY3RpdmVPcGFjaXR5OiBQcm9wVHlwZXMubnVtYmVyLFxuICAgIC8qKlxuICAgICAqIFRoZSBjb2xvciBvZiB0aGUgdW5kZXJsYXkgdGhhdCB3aWxsIHNob3cgdGhyb3VnaCB3aGVuIHRoZSB0b3VjaCBpc1xuICAgICAqIGFjdGl2ZS5cbiAgICAgKi9cbiAgICB1bmRlcmxheUNvbG9yOiBDb2xvclByb3BUeXBlLFxuICAgIC8qKlxuICAgICAqIFN0eWxlIHRvIGFwcGx5IHRvIHRoZSBjb250YWluZXIvdW5kZXJsYXkuIE1vc3QgY29tbW9ubHkgdXNlZCB0byBtYWtlIHN1cmVcbiAgICAgKiByb3VuZGVkIGNvcm5lcnMgbWF0Y2ggdGhlIHdyYXBwZWQgY29tcG9uZW50LlxuICAgICAqL1xuICAgIHN0eWxlOiBWaWV3UHJvcFR5cGVzLnN0eWxlLFxuICAgIC8qKlxuICAgICAqIENhbGxlZCBpbW1lZGlhdGVseSBhZnRlciB0aGUgdW5kZXJsYXkgaXMgc2hvd25cbiAgICAgKi9cbiAgICBvblNob3dVbmRlcmxheTogUHJvcFR5cGVzLmZ1bmMsXG4gICAgLyoqXG4gICAgICogQ2FsbGVkIGltbWVkaWF0ZWx5IGFmdGVyIHRoZSB1bmRlcmxheSBpcyBoaWRkZW5cbiAgICAgKi9cbiAgICBvbkhpZGVVbmRlcmxheTogUHJvcFR5cGVzLmZ1bmMsXG4gICAgLyoqXG4gICAgICogKihBcHBsZSBUViBvbmx5KSogVFYgcHJlZmVycmVkIGZvY3VzIChzZWUgZG9jdW1lbnRhdGlvbiBmb3IgdGhlIFZpZXcgY29tcG9uZW50KS5cbiAgICAgKlxuICAgICAqIEBwbGF0Zm9ybSBpb3NcbiAgICAgKi9cbiAgICBoYXNUVlByZWZlcnJlZEZvY3VzOiBQcm9wVHlwZXMuYm9vbCxcbiAgICAvKipcbiAgICAgKiAqKEFwcGxlIFRWIG9ubHkpKiBPYmplY3Qgd2l0aCBwcm9wZXJ0aWVzIHRvIGNvbnRyb2wgQXBwbGUgVFYgcGFyYWxsYXggZWZmZWN0cy5cbiAgICAgKlxuICAgICAqIGVuYWJsZWQ6IElmIHRydWUsIHBhcmFsbGF4IGVmZmVjdHMgYXJlIGVuYWJsZWQuICBEZWZhdWx0cyB0byB0cnVlLlxuICAgICAqIHNoaWZ0RGlzdGFuY2VYOiBEZWZhdWx0cyB0byAyLjAuXG4gICAgICogc2hpZnREaXN0YW5jZVk6IERlZmF1bHRzIHRvIDIuMC5cbiAgICAgKiB0aWx0QW5nbGU6IERlZmF1bHRzIHRvIDAuMDUuXG4gICAgICogbWFnbmlmaWNhdGlvbjogRGVmYXVsdHMgdG8gMS4wLlxuICAgICAqIHByZXNzTWFnbmlmaWNhdGlvbjogRGVmYXVsdHMgdG8gMS4wLlxuICAgICAqIHByZXNzRHVyYXRpb246IERlZmF1bHRzIHRvIDAuMy5cbiAgICAgKiBwcmVzc0RlbGF5OiBEZWZhdWx0cyB0byAwLjAuXG4gICAgICpcbiAgICAgKiBAcGxhdGZvcm0gaW9zXG4gICAgICovXG4gICAgdHZQYXJhbGxheFByb3BlcnRpZXM6IFByb3BUeXBlcy5vYmplY3QsXG4gICAgLyoqXG4gICAgICogSGFuZHkgZm9yIHNuYXBzaG90IHRlc3RzLlxuICAgICAqL1xuICAgIHRlc3RPbmx5X3ByZXNzZWQ6IFByb3BUeXBlcy5ib29sLFxuICB9LFxuXG4gIG1peGluczogW05hdGl2ZU1ldGhvZHNNaXhpbiwgVG91Y2hhYmxlLk1peGluXSxcblxuICBnZXREZWZhdWx0UHJvcHM6ICgpID0+IERFRkFVTFRfUFJPUFMsXG5cbiAgZ2V0SW5pdGlhbFN0YXRlOiBmdW5jdGlvbigpIHtcbiAgICB0aGlzLl9pc01vdW50ZWQgPSBmYWxzZTtcbiAgICBpZiAodGhpcy5wcm9wcy50ZXN0T25seV9wcmVzc2VkKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICAuLi50aGlzLnRvdWNoYWJsZUdldEluaXRpYWxTdGF0ZSgpLFxuICAgICAgICBleHRyYUNoaWxkU3R5bGU6IHtcbiAgICAgICAgICBvcGFjaXR5OiB0aGlzLnByb3BzLmFjdGl2ZU9wYWNpdHksXG4gICAgICAgIH0sXG4gICAgICAgIGV4dHJhVW5kZXJsYXlTdHlsZToge1xuICAgICAgICAgIGJhY2tncm91bmRDb2xvcjogdGhpcy5wcm9wcy51bmRlcmxheUNvbG9yLFxuICAgICAgICB9LFxuICAgICAgfTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgLi4udGhpcy50b3VjaGFibGVHZXRJbml0aWFsU3RhdGUoKSxcbiAgICAgICAgZXh0cmFDaGlsZFN0eWxlOiBudWxsLFxuICAgICAgICBleHRyYVVuZGVybGF5U3R5bGU6IG51bGwsXG4gICAgICB9O1xuICAgIH1cbiAgfSxcblxuICBjb21wb25lbnREaWRNb3VudDogZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5faXNNb3VudGVkID0gdHJ1ZTtcbiAgICBlbnN1cmVQb3NpdGl2ZURlbGF5UHJvcHModGhpcy5wcm9wcyk7XG4gIH0sXG5cbiAgY29tcG9uZW50V2lsbFVubW91bnQ6IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuX2lzTW91bnRlZCA9IGZhbHNlO1xuICAgIGNsZWFyVGltZW91dCh0aGlzLl9oaWRlVGltZW91dCk7XG4gIH0sXG5cbiAgVU5TQUZFX2NvbXBvbmVudFdpbGxSZWNlaXZlUHJvcHM6IGZ1bmN0aW9uKG5leHRQcm9wcykge1xuICAgIGVuc3VyZVBvc2l0aXZlRGVsYXlQcm9wcyhuZXh0UHJvcHMpO1xuICB9LFxuXG4gIHZpZXdDb25maWc6IHtcbiAgICB1aVZpZXdDbGFzc05hbWU6ICdSQ1RWaWV3JyxcbiAgICB2YWxpZEF0dHJpYnV0ZXM6IFJlYWN0TmF0aXZlVmlld0F0dHJpYnV0ZXMuUkNUVmlldyxcbiAgfSxcblxuICAvKipcbiAgICogYFRvdWNoYWJsZS5NaXhpbmAgc2VsZiBjYWxsYmFja3MuIFRoZSBtaXhpbiB3aWxsIGludm9rZSB0aGVzZSBpZiB0aGV5IGFyZVxuICAgKiBkZWZpbmVkIG9uIHlvdXIgY29tcG9uZW50LlxuICAgKi9cbiAgdG91Y2hhYmxlSGFuZGxlQWN0aXZlUHJlc3NJbjogZnVuY3Rpb24oZTogUHJlc3NFdmVudCkge1xuICAgIGNsZWFyVGltZW91dCh0aGlzLl9oaWRlVGltZW91dCk7XG4gICAgdGhpcy5faGlkZVRpbWVvdXQgPSBudWxsO1xuICAgIHRoaXMuX3Nob3dVbmRlcmxheSgpO1xuICAgIHRoaXMucHJvcHMub25QcmVzc0luICYmIHRoaXMucHJvcHMub25QcmVzc0luKGUpO1xuICB9LFxuXG4gIHRvdWNoYWJsZUhhbmRsZUFjdGl2ZVByZXNzT3V0OiBmdW5jdGlvbihlOiBQcmVzc0V2ZW50KSB7XG4gICAgaWYgKCF0aGlzLl9oaWRlVGltZW91dCkge1xuICAgICAgdGhpcy5faGlkZVVuZGVybGF5KCk7XG4gICAgfVxuICAgIHRoaXMucHJvcHMub25QcmVzc091dCAmJiB0aGlzLnByb3BzLm9uUHJlc3NPdXQoZSk7XG4gIH0sXG5cbiAgdG91Y2hhYmxlSGFuZGxlUHJlc3M6IGZ1bmN0aW9uKGU6IFByZXNzRXZlbnQpIHtcbiAgICBjbGVhclRpbWVvdXQodGhpcy5faGlkZVRpbWVvdXQpO1xuICAgIGlmICghUGxhdGZvcm0uaXNUVikge1xuICAgICAgdGhpcy5fc2hvd1VuZGVybGF5KCk7XG4gICAgICB0aGlzLl9oaWRlVGltZW91dCA9IHNldFRpbWVvdXQoXG4gICAgICAgIHRoaXMuX2hpZGVVbmRlcmxheSxcbiAgICAgICAgdGhpcy5wcm9wcy5kZWxheVByZXNzT3V0LFxuICAgICAgKTtcbiAgICB9XG4gICAgdGhpcy5wcm9wcy5vblByZXNzICYmIHRoaXMucHJvcHMub25QcmVzcyhlKTtcbiAgfSxcblxuICB0b3VjaGFibGVIYW5kbGVMb25nUHJlc3M6IGZ1bmN0aW9uKGU6IFByZXNzRXZlbnQpIHtcbiAgICB0aGlzLnByb3BzLm9uTG9uZ1ByZXNzICYmIHRoaXMucHJvcHMub25Mb25nUHJlc3MoZSk7XG4gIH0sXG5cbiAgdG91Y2hhYmxlR2V0UHJlc3NSZWN0T2Zmc2V0OiBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gdGhpcy5wcm9wcy5wcmVzc1JldGVudGlvbk9mZnNldCB8fCBQUkVTU19SRVRFTlRJT05fT0ZGU0VUO1xuICB9LFxuXG4gIHRvdWNoYWJsZUdldEhpdFNsb3A6IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB0aGlzLnByb3BzLmhpdFNsb3A7XG4gIH0sXG5cbiAgdG91Y2hhYmxlR2V0SGlnaGxpZ2h0RGVsYXlNUzogZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHRoaXMucHJvcHMuZGVsYXlQcmVzc0luO1xuICB9LFxuXG4gIHRvdWNoYWJsZUdldExvbmdQcmVzc0RlbGF5TVM6IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB0aGlzLnByb3BzLmRlbGF5TG9uZ1ByZXNzO1xuICB9LFxuXG4gIHRvdWNoYWJsZUdldFByZXNzT3V0RGVsYXlNUzogZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHRoaXMucHJvcHMuZGVsYXlQcmVzc091dDtcbiAgfSxcblxuICBfc2hvd1VuZGVybGF5OiBmdW5jdGlvbigpIHtcbiAgICBpZiAoIXRoaXMuX2lzTW91bnRlZCB8fCAhdGhpcy5faGFzUHJlc3NIYW5kbGVyKCkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICBleHRyYUNoaWxkU3R5bGU6IHtcbiAgICAgICAgb3BhY2l0eTogdGhpcy5wcm9wcy5hY3RpdmVPcGFjaXR5LFxuICAgICAgfSxcbiAgICAgIGV4dHJhVW5kZXJsYXlTdHlsZToge1xuICAgICAgICBiYWNrZ3JvdW5kQ29sb3I6IHRoaXMucHJvcHMudW5kZXJsYXlDb2xvcixcbiAgICAgIH0sXG4gICAgfSk7XG4gICAgdGhpcy5wcm9wcy5vblNob3dVbmRlcmxheSAmJiB0aGlzLnByb3BzLm9uU2hvd1VuZGVybGF5KCk7XG4gIH0sXG5cbiAgX2hpZGVVbmRlcmxheTogZnVuY3Rpb24oKSB7XG4gICAgY2xlYXJUaW1lb3V0KHRoaXMuX2hpZGVUaW1lb3V0KTtcbiAgICB0aGlzLl9oaWRlVGltZW91dCA9IG51bGw7XG4gICAgaWYgKHRoaXMucHJvcHMudGVzdE9ubHlfcHJlc3NlZCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpZiAodGhpcy5faGFzUHJlc3NIYW5kbGVyKCkpIHtcbiAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICBleHRyYUNoaWxkU3R5bGU6IG51bGwsXG4gICAgICAgIGV4dHJhVW5kZXJsYXlTdHlsZTogbnVsbCxcbiAgICAgIH0pO1xuICAgICAgdGhpcy5wcm9wcy5vbkhpZGVVbmRlcmxheSAmJiB0aGlzLnByb3BzLm9uSGlkZVVuZGVybGF5KCk7XG4gICAgfVxuICB9LFxuXG4gIF9oYXNQcmVzc0hhbmRsZXI6IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiAhIShcbiAgICAgIHRoaXMucHJvcHMub25QcmVzcyB8fFxuICAgICAgdGhpcy5wcm9wcy5vblByZXNzSW4gfHxcbiAgICAgIHRoaXMucHJvcHMub25QcmVzc091dCB8fFxuICAgICAgdGhpcy5wcm9wcy5vbkxvbmdQcmVzc1xuICAgICk7XG4gIH0sXG5cbiAgcmVuZGVyOiBmdW5jdGlvbigpIHtcbiAgICBjb25zdCBjaGlsZCA9IFJlYWN0LkNoaWxkcmVuLm9ubHkodGhpcy5wcm9wcy5jaGlsZHJlbik7XG4gICAgcmV0dXJuIChcbiAgICAgIDxWaWV3XG4gICAgICAgIGFjY2Vzc2libGU9e3RoaXMucHJvcHMuYWNjZXNzaWJsZSAhPT0gZmFsc2V9XG4gICAgICAgIGFjY2Vzc2liaWxpdHlMYWJlbD17dGhpcy5wcm9wcy5hY2Nlc3NpYmlsaXR5TGFiZWx9XG4gICAgICAgIGFjY2Vzc2liaWxpdHlIaW50PXt0aGlzLnByb3BzLmFjY2Vzc2liaWxpdHlIaW50fVxuICAgICAgICBhY2Nlc3NpYmlsaXR5Um9sZT17dGhpcy5wcm9wcy5hY2Nlc3NpYmlsaXR5Um9sZX1cbiAgICAgICAgYWNjZXNzaWJpbGl0eVN0YXRlcz17dGhpcy5wcm9wcy5hY2Nlc3NpYmlsaXR5U3RhdGVzfVxuICAgICAgICBzdHlsZT17U3R5bGVTaGVldC5jb21wb3NlKFxuICAgICAgICAgIHRoaXMucHJvcHMuc3R5bGUsXG4gICAgICAgICAgdGhpcy5zdGF0ZS5leHRyYVVuZGVybGF5U3R5bGUsXG4gICAgICAgICl9XG4gICAgICAgIG9uTGF5b3V0PXt0aGlzLnByb3BzLm9uTGF5b3V0fVxuICAgICAgICBoaXRTbG9wPXt0aGlzLnByb3BzLmhpdFNsb3B9XG4gICAgICAgIGlzVFZTZWxlY3RhYmxlPXt0cnVlfVxuICAgICAgICB0dlBhcmFsbGF4UHJvcGVydGllcz17dGhpcy5wcm9wcy50dlBhcmFsbGF4UHJvcGVydGllc31cbiAgICAgICAgaGFzVFZQcmVmZXJyZWRGb2N1cz17dGhpcy5wcm9wcy5oYXNUVlByZWZlcnJlZEZvY3VzfVxuICAgICAgICBvblN0YXJ0U2hvdWxkU2V0UmVzcG9uZGVyPXt0aGlzLnRvdWNoYWJsZUhhbmRsZVN0YXJ0U2hvdWxkU2V0UmVzcG9uZGVyfVxuICAgICAgICBvblJlc3BvbmRlclRlcm1pbmF0aW9uUmVxdWVzdD17XG4gICAgICAgICAgdGhpcy50b3VjaGFibGVIYW5kbGVSZXNwb25kZXJUZXJtaW5hdGlvblJlcXVlc3RcbiAgICAgICAgfVxuICAgICAgICBvblJlc3BvbmRlckdyYW50PXt0aGlzLnRvdWNoYWJsZUhhbmRsZVJlc3BvbmRlckdyYW50fVxuICAgICAgICBvblJlc3BvbmRlck1vdmU9e3RoaXMudG91Y2hhYmxlSGFuZGxlUmVzcG9uZGVyTW92ZX1cbiAgICAgICAgb25SZXNwb25kZXJSZWxlYXNlPXt0aGlzLnRvdWNoYWJsZUhhbmRsZVJlc3BvbmRlclJlbGVhc2V9XG4gICAgICAgIG9uUmVzcG9uZGVyVGVybWluYXRlPXt0aGlzLnRvdWNoYWJsZUhhbmRsZVJlc3BvbmRlclRlcm1pbmF0ZX1cbiAgICAgICAgbmF0aXZlSUQ9e3RoaXMucHJvcHMubmF0aXZlSUR9XG4gICAgICAgIHRlc3RJRD17dGhpcy5wcm9wcy50ZXN0SUR9PlxuICAgICAgICB7UmVhY3QuY2xvbmVFbGVtZW50KGNoaWxkLCB7XG4gICAgICAgICAgc3R5bGU6IFN0eWxlU2hlZXQuY29tcG9zZShcbiAgICAgICAgICAgIGNoaWxkLnByb3BzLnN0eWxlLFxuICAgICAgICAgICAgdGhpcy5zdGF0ZS5leHRyYUNoaWxkU3R5bGUsXG4gICAgICAgICAgKSxcbiAgICAgICAgfSl9XG4gICAgICAgIHtUb3VjaGFibGUucmVuZGVyRGVidWdWaWV3KHtcbiAgICAgICAgICBjb2xvcjogJ2dyZWVuJyxcbiAgICAgICAgICBoaXRTbG9wOiB0aGlzLnByb3BzLmhpdFNsb3AsXG4gICAgICAgIH0pfVxuICAgICAgPC9WaWV3PlxuICAgICk7XG4gIH0sXG59KTogYW55KTogUmVhY3QuQ29tcG9uZW50VHlwZTxQcm9wcz4pO1xuXG5tb2R1bGUuZXhwb3J0cyA9IFRvdWNoYWJsZUhpZ2hsaWdodDtcbiJdfQ==