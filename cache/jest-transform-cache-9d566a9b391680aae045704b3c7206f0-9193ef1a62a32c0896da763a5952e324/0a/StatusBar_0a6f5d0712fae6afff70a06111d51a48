9e5f61e1d29b0943fdd2872d9f3b0e54










'use strict';var _createClass = function () {function defineProperties(target, props) {for (var i = 0; i < props.length; i++) {var descriptor = props[i];descriptor.enumerable = descriptor.enumerable || false;descriptor.configurable = true;if ("value" in descriptor) descriptor.writable = true;Object.defineProperty(target, descriptor.key, descriptor);}}return function (Constructor, protoProps, staticProps) {if (protoProps) defineProperties(Constructor.prototype, protoProps);if (staticProps) defineProperties(Constructor, staticProps);return Constructor;};}();var _extends = Object.assign || function (target) {for (var i = 1; i < arguments.length; i++) {var source = arguments[i];for (var key in source) {if (Object.prototype.hasOwnProperty.call(source, key)) {target[key] = source[key];}}}return target;};function _classCallCheck(instance, Constructor) {if (!(instance instanceof Constructor)) {throw new TypeError("Cannot call a class as a function");}}function _possibleConstructorReturn(self, call) {if (!self) {throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call && (typeof call === "object" || typeof call === "function") ? call : self;}function _inherits(subClass, superClass) {if (typeof superClass !== "function" && superClass !== null) {throw new TypeError("Super expression must either be null or a function, not " + typeof superClass);}subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } });if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;}

var React = require('React');
var PropTypes = require('prop-types');
var ColorPropType = require('ColorPropType');
var Platform = require('Platform');

var processColor = require('processColor');

var StatusBarManager = require('NativeModules').StatusBarManager;












































function mergePropsStack(
propsStack,
defaultValues)
{
  return propsStack.reduce(function (prev, cur) {
    for (var prop in cur) {
      if (cur[prop] != null) {
        prev[prop] = cur[prop];
      }
    }
    return prev;
  }, _extends({}, defaultValues));
}





function createStackEntry(props) {
  return {
    backgroundColor:
    props.backgroundColor != null ?
    {
      value: props.backgroundColor,
      animated: props.animated } :

    null,
    barStyle:
    props.barStyle != null ?
    {
      value: props.barStyle,
      animated: props.animated } :

    null,
    translucent: props.translucent,
    hidden:
    props.hidden != null ?
    {
      value: props.hidden,
      animated: props.animated,
      transition: props.showHideTransition } :

    null,
    networkActivityIndicatorVisible: props.networkActivityIndicatorVisible };

}var








































StatusBar = function (_React$Component) {_inherits(StatusBar, _React$Component);function StatusBar() {var _ref;var _temp, _this, _ret;_classCallCheck(this, StatusBar);for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {args[_key] = arguments[_key];}return _ret = (_temp = (_this = _possibleConstructorReturn(this, (_ref = StatusBar.__proto__ || Object.getPrototypeOf(StatusBar)).call.apply(_ref, [this].concat(args))), _this), _this.































































































































































    _stackEntry = null, _this.































    _updatePropsStack = function () {

      clearImmediate(StatusBar._updateImmediate);
      StatusBar._updateImmediate = setImmediate(function () {
        var oldProps = StatusBar._currentValues;
        var mergedProps = mergePropsStack(
        StatusBar._propsStack,
        StatusBar._defaultProps);



        if (Platform.OS === 'ios') {
          if (
          !oldProps ||
          oldProps.barStyle.value !== mergedProps.barStyle.value)
          {
            StatusBarManager.setStyle(
            mergedProps.barStyle.value,
            mergedProps.barStyle.animated);

          }
          if (!oldProps || oldProps.hidden.value !== mergedProps.hidden.value) {
            StatusBarManager.setHidden(
            mergedProps.hidden.value,
            mergedProps.hidden.animated ?
            mergedProps.hidden.transition :
            'none');

          }

          if (
          !oldProps ||
          oldProps.networkActivityIndicatorVisible !==
          mergedProps.networkActivityIndicatorVisible)
          {
            StatusBarManager.setNetworkActivityIndicatorVisible(
            mergedProps.networkActivityIndicatorVisible);

          }
        } else if (Platform.OS === 'android') {
          if (
          !oldProps ||
          oldProps.barStyle.value !== mergedProps.barStyle.value)
          {
            StatusBarManager.setStyle(mergedProps.barStyle.value);
          }
          if (
          !oldProps ||
          oldProps.backgroundColor.value !== mergedProps.backgroundColor.value)
          {
            StatusBarManager.setColor(
            processColor(mergedProps.backgroundColor.value),
            mergedProps.backgroundColor.animated);

          }
          if (!oldProps || oldProps.hidden.value !== mergedProps.hidden.value) {
            StatusBarManager.setHidden(mergedProps.hidden.value);
          }
          if (!oldProps || oldProps.translucent !== mergedProps.translucent) {
            StatusBarManager.setTranslucent(mergedProps.translucent);
          }
        }

        StatusBar._currentValues = mergedProps;
      });
    }, _temp), _possibleConstructorReturn(_this, _ret);}_createClass(StatusBar, [{ key: 'componentDidMount', value: function componentDidMount() {this._stackEntry = createStackEntry(this.props);StatusBar._propsStack.push(this._stackEntry);this._updatePropsStack();} }, { key: 'componentWillUnmount', value: function componentWillUnmount() {var index = StatusBar._propsStack.indexOf(this._stackEntry);StatusBar._propsStack.splice(index, 1);this._updatePropsStack();} }, { key: 'componentDidUpdate', value: function componentDidUpdate() {var index = StatusBar._propsStack.indexOf(this._stackEntry);this._stackEntry = createStackEntry(this.props);StatusBar._propsStack[index] = this._stackEntry;this._updatePropsStack();} }, { key: 'render', value: function render()

    {
      return null;
    } }], [{ key: 'setHidden', value: function setHidden(hidden, animation) {animation = animation || 'none';StatusBar._defaultProps.hidden.value = hidden;if (Platform.OS === 'ios') {StatusBarManager.setHidden(hidden, animation);} else if (Platform.OS === 'android') {StatusBarManager.setHidden(hidden);}} }, { key: 'setBarStyle', value: function setBarStyle(style, animated) {animated = animated || false;StatusBar._defaultProps.barStyle.value = style;if (Platform.OS === 'ios') {StatusBarManager.setStyle(style, animated);} else if (Platform.OS === 'android') {StatusBarManager.setStyle(style);}} }, { key: 'setNetworkActivityIndicatorVisible', value: function setNetworkActivityIndicatorVisible(visible) {if (Platform.OS !== 'ios') {console.warn('`setNetworkActivityIndicatorVisible` is only available on iOS');return;}StatusBar._defaultProps.networkActivityIndicatorVisible = visible;StatusBarManager.setNetworkActivityIndicatorVisible(visible);} }, { key: 'setBackgroundColor', value: function setBackgroundColor(color, animated) {if (Platform.OS !== 'android') {console.warn('`setBackgroundColor` is only available on Android');return;}animated = animated || false;StatusBar._defaultProps.backgroundColor.value = color;StatusBarManager.setColor(processColor(color), animated);} }, { key: 'setTranslucent', value: function setTranslucent(translucent) {if (Platform.OS !== 'android') {console.warn('`setTranslucent` is only available on Android');return;}StatusBar._defaultProps.translucent = translucent;StatusBarManager.setTranslucent(translucent);} }]);return StatusBar;}(React.Component);StatusBar._propsStack = [];StatusBar._defaultProps = createStackEntry({ animated: false, showHideTransition: 'fade', backgroundColor: 'black', barStyle: 'default', translucent: false, hidden: false, networkActivityIndicatorVisible: false });StatusBar._updateImmediate = null;StatusBar._currentValues = null;StatusBar.currentHeight = StatusBarManager.HEIGHT;StatusBar.propTypes = { hidden: PropTypes.bool, animated: PropTypes.bool, backgroundColor: ColorPropType, translucent: PropTypes.bool, barStyle: PropTypes.oneOf(['default', 'light-content', 'dark-content']), networkActivityIndicatorVisible: PropTypes.bool, showHideTransition: PropTypes.oneOf(['fade', 'slide']) };StatusBar.defaultProps = { animated: false, showHideTransition: 'fade' };


module.exports = StatusBar;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlN0YXR1c0Jhci5qcyJdLCJuYW1lcyI6WyJSZWFjdCIsInJlcXVpcmUiLCJQcm9wVHlwZXMiLCJDb2xvclByb3BUeXBlIiwiUGxhdGZvcm0iLCJwcm9jZXNzQ29sb3IiLCJTdGF0dXNCYXJNYW5hZ2VyIiwibWVyZ2VQcm9wc1N0YWNrIiwicHJvcHNTdGFjayIsImRlZmF1bHRWYWx1ZXMiLCJyZWR1Y2UiLCJwcmV2IiwiY3VyIiwicHJvcCIsImNyZWF0ZVN0YWNrRW50cnkiLCJwcm9wcyIsImJhY2tncm91bmRDb2xvciIsInZhbHVlIiwiYW5pbWF0ZWQiLCJiYXJTdHlsZSIsInRyYW5zbHVjZW50IiwiaGlkZGVuIiwidHJhbnNpdGlvbiIsInNob3dIaWRlVHJhbnNpdGlvbiIsIm5ldHdvcmtBY3Rpdml0eUluZGljYXRvclZpc2libGUiLCJTdGF0dXNCYXIiLCJfc3RhY2tFbnRyeSIsIl91cGRhdGVQcm9wc1N0YWNrIiwiY2xlYXJJbW1lZGlhdGUiLCJfdXBkYXRlSW1tZWRpYXRlIiwic2V0SW1tZWRpYXRlIiwib2xkUHJvcHMiLCJfY3VycmVudFZhbHVlcyIsIm1lcmdlZFByb3BzIiwiX3Byb3BzU3RhY2siLCJfZGVmYXVsdFByb3BzIiwiT1MiLCJzZXRTdHlsZSIsInNldEhpZGRlbiIsInNldE5ldHdvcmtBY3Rpdml0eUluZGljYXRvclZpc2libGUiLCJzZXRDb2xvciIsInNldFRyYW5zbHVjZW50IiwicHVzaCIsImluZGV4IiwiaW5kZXhPZiIsInNwbGljZSIsImFuaW1hdGlvbiIsInN0eWxlIiwidmlzaWJsZSIsImNvbnNvbGUiLCJ3YXJuIiwiY29sb3IiLCJDb21wb25lbnQiLCJjdXJyZW50SGVpZ2h0IiwiSEVJR0hUIiwicHJvcFR5cGVzIiwiYm9vbCIsIm9uZU9mIiwiZGVmYXVsdFByb3BzIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7OztBQVVBLGE7O0FBRUEsSUFBTUEsUUFBUUMsUUFBUSxPQUFSLENBQWQ7QUFDQSxJ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QixFQUN0Q0ksVUFBVSxLQUQ0QixFQUV0Q0ssb0JBQW9CLE1BRmtCLEVBR3RDUCxpQkFBaUIsT0FIcUIsRUFJdENHLFVBQVUsU0FKNEIsRUFLdENDLGFBQWEsS0FMeUIsRUFNdENDLFFBQVEsS0FOOEIsRUFPdENHLGlDQUFpQyxLQVBLLEVBQWpCLEMsQ0FYbkJDLFMsQ0FzQkdJLGdCLEdBQW1CLEksQ0F0QnRCSixTLENBeUJHTyxjLEdBQWlCLEksQ0F6QnBCUCxTLENBa0NHNEIsYSxHQUFnQi9DLGlCQUFpQmdELE0sQ0FsQ3BDN0IsUyxDQWlIRzhCLFMsR0FBWSxFQUlqQmxDLFFBQVFuQixVQUFVc0QsSUFKRCxFQVNqQnRDLFVBQVVoQixVQUFVc0QsSUFUSCxFQWNqQnhDLGlCQUFpQmIsYUFkQSxFQXNCakJpQixhQUFhbEIsVUFBVXNELElBdEJOLEVBMEJqQnJDLFVBQVVqQixVQUFVdUQsS0FBVixDQUFnQixDQUFDLFNBQUQsRUFBWSxlQUFaLEVBQTZCLGNBQTdCLENBQWhCLENBMUJPLEVBZ0NqQmpDLGlDQUFpQ3RCLFVBQVVzRCxJQWhDMUIsRUF1Q2pCakMsb0JBQW9CckIsVUFBVXVELEtBQVYsQ0FBZ0IsQ0FBQyxNQUFELEVBQVMsT0FBVCxDQUFoQixDQXZDSCxFLENBakhmaEMsUyxDQTJKR2lDLFksR0FBZSxFQUNwQnhDLFVBQVUsS0FEVSxFQUVwQkssb0JBQW9CLE1BRkEsRTs7O0FBNkd4Qm9DLE9BQU9DLE9BQVAsR0FBaUJuQyxTQUFqQiIsImZpbGUiOiJTdGF0dXNCYXIuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIENvcHlyaWdodCAoYykgMjAxNS1wcmVzZW50LCBGYWNlYm9vaywgSW5jLlxuICpcbiAqIFRoaXMgc291cmNlIGNvZGUgaXMgbGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlIGZvdW5kIGluIHRoZVxuICogTElDRU5TRSBmaWxlIGluIHRoZSByb290IGRpcmVjdG9yeSBvZiB0aGlzIHNvdXJjZSB0cmVlLlxuICpcbiAqIEBmb3JtYXRcbiAqIEBmbG93XG4gKi9cblxuJ3VzZSBzdHJpY3QnO1xuXG5jb25zdCBSZWFjdCA9IHJlcXVpcmUoJ1JlYWN0Jyk7XG5jb25zdCBQcm9wVHlwZXMgPSByZXF1aXJlKCdwcm9wLXR5cGVzJyk7XG5jb25zdCBDb2xvclByb3BUeXBlID0gcmVxdWlyZSgnQ29sb3JQcm9wVHlwZScpO1xuY29uc3QgUGxhdGZvcm0gPSByZXF1aXJlKCdQbGF0Zm9ybScpO1xuXG5jb25zdCBwcm9jZXNzQ29sb3IgPSByZXF1aXJlKCdwcm9jZXNzQ29sb3InKTtcblxuY29uc3QgU3RhdHVzQmFyTWFuYWdlciA9IHJlcXVpcmUoJ05hdGl2ZU1vZHVsZXMnKS5TdGF0dXNCYXJNYW5hZ2VyO1xuXG4vKipcbiAqIFN0YXR1cyBiYXIgc3R5bGVcbiAqL1xuZXhwb3J0IHR5cGUgU3RhdHVzQmFyU3R5bGUgPSAkRW51bTx7XG4gIC8qKlxuICAgKiBEZWZhdWx0IHN0YXR1cyBiYXIgc3R5bGUgKGRhcmsgZm9yIGlPUywgbGlnaHQgZm9yIEFuZHJvaWQpXG4gICAqL1xuICBkZWZhdWx0OiBzdHJpbmcsXG4gIC8qKlxuICAgKiBEYXJrIGJhY2tncm91bmQsIHdoaXRlIHRleHRzIGFuZCBpY29uc1xuICAgKi9cbiAgJ2xpZ2h0LWNvbnRlbnQnOiBzdHJpbmcsXG4gIC8qKlxuICAgKiBMaWdodCBiYWNrZ3JvdW5kLCBkYXJrIHRleHRzIGFuZCBpY29uc1xuICAgKi9cbiAgJ2RhcmstY29udGVudCc6IHN0cmluZyxcbn0+O1xuXG4vKipcbiAqIFN0YXR1cyBiYXIgYW5pbWF0aW9uXG4gKi9cbmV4cG9ydCB0eXBlIFN0YXR1c0JhckFuaW1hdGlvbiA9ICRFbnVtPHtcbiAgLyoqXG4gICAqIE5vIGFuaW1hdGlvblxuICAgKi9cbiAgbm9uZTogc3RyaW5nLFxuICAvKipcbiAgICogRmFkZSBhbmltYXRpb25cbiAgICovXG4gIGZhZGU6IHN0cmluZyxcbiAgLyoqXG4gICAqIFNsaWRlIGFuaW1hdGlvblxuICAgKi9cbiAgc2xpZGU6IHN0cmluZyxcbn0+O1xuXG50eXBlIERlZmF1bHRQcm9wcyA9IHtcbiAgYW5pbWF0ZWQ6IGJvb2xlYW4sXG59O1xuXG4vKipcbiAqIE1lcmdlcyB0aGUgcHJvcCBzdGFjayB3aXRoIHRoZSBkZWZhdWx0IHZhbHVlcy5cbiAqL1xuZnVuY3Rpb24gbWVyZ2VQcm9wc1N0YWNrKFxuICBwcm9wc1N0YWNrOiBBcnJheTxPYmplY3Q+LFxuICBkZWZhdWx0VmFsdWVzOiBPYmplY3QsXG4pOiBPYmplY3Qge1xuICByZXR1cm4gcHJvcHNTdGFjay5yZWR1Y2UoKHByZXYsIGN1cikgPT4ge1xuICAgIGZvciAoY29uc3QgcHJvcCBpbiBjdXIpIHtcbiAgICAgIGlmIChjdXJbcHJvcF0gIT0gbnVsbCkge1xuICAgICAgICBwcmV2W3Byb3BdID0gY3VyW3Byb3BdO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gcHJldjtcbiAgfSwgT2JqZWN0LmFzc2lnbih7fSwgZGVmYXVsdFZhbHVlcykpO1xufVxuXG4vKipcbiAqIFJldHVybnMgYW4gb2JqZWN0IHRvIGluc2VydCBpbiB0aGUgcHJvcHMgc3RhY2sgZnJvbSB0aGUgcHJvcHNcbiAqIGFuZCB0aGUgdHJhbnNpdGlvbi9hbmltYXRpb24gaW5mby5cbiAqL1xuZnVuY3Rpb24gY3JlYXRlU3RhY2tFbnRyeShwcm9wczogYW55KTogYW55IHtcbiAgcmV0dXJuIHtcbiAgICBiYWNrZ3JvdW5kQ29sb3I6XG4gICAgICBwcm9wcy5iYWNrZ3JvdW5kQ29sb3IgIT0gbnVsbFxuICAgICAgICA/IHtcbiAgICAgICAgICAgIHZhbHVlOiBwcm9wcy5iYWNrZ3JvdW5kQ29sb3IsXG4gICAgICAgICAgICBhbmltYXRlZDogcHJvcHMuYW5pbWF0ZWQsXG4gICAgICAgICAgfVxuICAgICAgICA6IG51bGwsXG4gICAgYmFyU3R5bGU6XG4gICAgICBwcm9wcy5iYXJTdHlsZSAhPSBudWxsXG4gICAgICAgID8ge1xuICAgICAgICAgICAgdmFsdWU6IHByb3BzLmJhclN0eWxlLFxuICAgICAgICAgICAgYW5pbWF0ZWQ6IHByb3BzLmFuaW1hdGVkLFxuICAgICAgICAgIH1cbiAgICAgICAgOiBudWxsLFxuICAgIHRyYW5zbHVjZW50OiBwcm9wcy50cmFuc2x1Y2VudCxcbiAgICBoaWRkZW46XG4gICAgICBwcm9wcy5oaWRkZW4gIT0gbnVsbFxuICAgICAgICA/IHtcbiAgICAgICAgICAgIHZhbHVlOiBwcm9wcy5oaWRkZW4sXG4gICAgICAgICAgICBhbmltYXRlZDogcHJvcHMuYW5pbWF0ZWQsXG4gICAgICAgICAgICB0cmFuc2l0aW9uOiBwcm9wcy5zaG93SGlkZVRyYW5zaXRpb24sXG4gICAgICAgICAgfVxuICAgICAgICA6IG51bGwsXG4gICAgbmV0d29ya0FjdGl2aXR5SW5kaWNhdG9yVmlzaWJsZTogcHJvcHMubmV0d29ya0FjdGl2aXR5SW5kaWNhdG9yVmlzaWJsZSxcbiAgfTtcbn1cblxuLyoqXG4gKiBDb21wb25lbnQgdG8gY29udHJvbCB0aGUgYXBwIHN0YXR1cyBiYXIuXG4gKlxuICogIyMjIFVzYWdlIHdpdGggTmF2aWdhdG9yXG4gKlxuICogSXQgaXMgcG9zc2libGUgdG8gaGF2ZSBtdWx0aXBsZSBgU3RhdHVzQmFyYCBjb21wb25lbnRzIG1vdW50ZWQgYXQgdGhlIHNhbWVcbiAqIHRpbWUuIFRoZSBwcm9wcyB3aWxsIGJlIG1lcmdlZCBpbiB0aGUgb3JkZXIgdGhlIGBTdGF0dXNCYXJgIGNvbXBvbmVudHMgd2VyZVxuICogbW91bnRlZC4gT25lIHVzZSBjYXNlIGlzIHRvIHNwZWNpZnkgc3RhdHVzIGJhciBzdHlsZXMgcGVyIHJvdXRlIHVzaW5nIGBOYXZpZ2F0b3JgLlxuICpcbiAqIGBgYFxuICogIDxWaWV3PlxuICogICAgPFN0YXR1c0JhclxuICogICAgICBiYWNrZ3JvdW5kQ29sb3I9XCJibHVlXCJcbiAqICAgICAgYmFyU3R5bGU9XCJsaWdodC1jb250ZW50XCJcbiAqICAgIC8+XG4gKiAgICA8TmF2aWdhdG9yXG4gKiAgICAgIGluaXRpYWxSb3V0ZT17e3N0YXR1c0JhckhpZGRlbjogdHJ1ZX19XG4gKiAgICAgIHJlbmRlclNjZW5lPXsocm91dGUsIG5hdmlnYXRvcikgPT5cbiAqICAgICAgICA8Vmlldz5cbiAqICAgICAgICAgIDxTdGF0dXNCYXIgaGlkZGVuPXtyb3V0ZS5zdGF0dXNCYXJIaWRkZW59IC8+XG4gKiAgICAgICAgICAuLi5cbiAqICAgICAgICA8L1ZpZXc+XG4gKiAgICAgIH1cbiAqICAgIC8+XG4gKiAgPC9WaWV3PlxuICogYGBgXG4gKlxuICogIyMjIEltcGVyYXRpdmUgQVBJXG4gKlxuICogRm9yIGNhc2VzIHdoZXJlIHVzaW5nIGEgY29tcG9uZW50IGlzIG5vdCBpZGVhbCwgdGhlcmUgaXMgYWxzbyBhbiBpbXBlcmF0aXZlXG4gKiBBUEkgZXhwb3NlZCBhcyBzdGF0aWMgZnVuY3Rpb25zIG9uIHRoZSBjb21wb25lbnQuIEl0IGlzIGhvd2V2ZXIgbm90IHJlY29tbWVuZGVkXG4gKiB0byB1c2UgdGhlIHN0YXRpYyBBUEkgYW5kIHRoZSBjb21wb25lbnQgZm9yIHRoZSBzYW1lIHByb3AgYmVjYXVzZSBhbnkgdmFsdWVcbiAqIHNldCBieSB0aGUgc3RhdGljIEFQSSB3aWxsIGdldCBvdmVycmlkZW4gYnkgdGhlIG9uZSBzZXQgYnkgdGhlIGNvbXBvbmVudCBpblxuICogdGhlIG5leHQgcmVuZGVyLlxuICpcbiAqICMjIyBDb25zdGFudHNcbiAqXG4gKiBgY3VycmVudEhlaWdodGAgKEFuZHJvaWQgb25seSkgVGhlIGhlaWdodCBvZiB0aGUgc3RhdHVzIGJhci5cbiAqL1xuY2xhc3MgU3RhdHVzQmFyIGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50PHtcbiAgaGlkZGVuPzogYm9vbGVhbixcbiAgYW5pbWF0ZWQ/OiBib29sZWFuLFxuICBiYWNrZ3JvdW5kQ29sb3I/OiBzdHJpbmcsXG4gIHRyYW5zbHVjZW50PzogYm9vbGVhbixcbiAgYmFyU3R5bGU/OiAnZGVmYXVsdCcgfCAnbGlnaHQtY29udGVudCcgfCAnZGFyay1jb250ZW50JyxcbiAgbmV0d29ya0FjdGl2aXR5SW5kaWNhdG9yVmlzaWJsZT86IGJvb2xlYW4sXG4gIHNob3dIaWRlVHJhbnNpdGlvbj86ICdmYWRlJyB8ICdzbGlkZScsXG59PiB7XG4gIHN0YXRpYyBfcHJvcHNTdGFjayA9IFtdO1xuXG4gIHN0YXRpYyBfZGVmYXVsdFByb3BzID0gY3JlYXRlU3RhY2tFbnRyeSh7XG4gICAgYW5pbWF0ZWQ6IGZhbHNlLFxuICAgIHNob3dIaWRlVHJhbnNpdGlvbjogJ2ZhZGUnLFxuICAgIGJhY2tncm91bmRDb2xvcjogJ2JsYWNrJyxcbiAgICBiYXJTdHlsZTogJ2RlZmF1bHQnLFxuICAgIHRyYW5zbHVjZW50OiBmYWxzZSxcbiAgICBoaWRkZW46IGZhbHNlLFxuICAgIG5ldHdvcmtBY3Rpdml0eUluZGljYXRvclZpc2libGU6IGZhbHNlLFxuICB9KTtcblxuICAvLyBUaW1lciBmb3IgdXBkYXRpbmcgdGhlIG5hdGl2ZSBtb2R1bGUgdmFsdWVzIGF0IHRoZSBlbmQgb2YgdGhlIGZyYW1lLlxuICBzdGF0aWMgX3VwZGF0ZUltbWVkaWF0ZSA9IG51bGw7XG5cbiAgLy8gVGhlIGN1cnJlbnQgbWVyZ2VkIHZhbHVlcyBmcm9tIHRoZSBwcm9wcyBzdGFjay5cbiAgc3RhdGljIF9jdXJyZW50VmFsdWVzID0gbnVsbDtcblxuICAvLyBUT0RPKGphbmljKTogUHJvdmlkZSBhIHJlYWwgQVBJIHRvIGRlYWwgd2l0aCBzdGF0dXMgYmFyIGhlaWdodC4gU2VlIHRoZVxuICAvLyBkaXNjdXNzaW9uIGluICM2MTk1LlxuICAvKipcbiAgICogVGhlIGN1cnJlbnQgaGVpZ2h0IG9mIHRoZSBzdGF0dXMgYmFyIG9uIHRoZSBkZXZpY2UuXG4gICAqXG4gICAqIEBwbGF0Zm9ybSBhbmRyb2lkXG4gICAqL1xuICBzdGF0aWMgY3VycmVudEhlaWdodCA9IFN0YXR1c0Jhck1hbmFnZXIuSEVJR0hUO1xuXG4gIC8vIFByb3ZpZGUgYW4gaW1wZXJhdGl2ZSBBUEkgYXMgc3RhdGljIGZ1bmN0aW9ucyBvZiB0aGUgY29tcG9uZW50LlxuICAvLyBTZWUgdGhlIGNvcnJlc3BvbmRpbmcgcHJvcCBmb3IgbW9yZSBkZXRhaWwuXG5cbiAgLyoqXG4gICAqIFNob3cgb3IgaGlkZSB0aGUgc3RhdHVzIGJhclxuICAgKiBAcGFyYW0gaGlkZGVuIEhpZGUgdGhlIHN0YXR1cyBiYXIuXG4gICAqIEBwYXJhbSBhbmltYXRpb24gT3B0aW9uYWwgYW5pbWF0aW9uIHdoZW5cbiAgICogICAgY2hhbmdpbmcgdGhlIHN0YXR1cyBiYXIgaGlkZGVuIHByb3BlcnR5LlxuICAgKi9cbiAgc3RhdGljIHNldEhpZGRlbihoaWRkZW46IGJvb2xlYW4sIGFuaW1hdGlvbj86IFN0YXR1c0JhckFuaW1hdGlvbikge1xuICAgIGFuaW1hdGlvbiA9IGFuaW1hdGlvbiB8fCAnbm9uZSc7XG4gICAgU3RhdHVzQmFyLl9kZWZhdWx0UHJvcHMuaGlkZGVuLnZhbHVlID0gaGlkZGVuO1xuICAgIGlmIChQbGF0Zm9ybS5PUyA9PT0gJ2lvcycpIHtcbiAgICAgIFN0YXR1c0Jhck1hbmFnZXIuc2V0SGlkZGVuKGhpZGRlbiwgYW5pbWF0aW9uKTtcbiAgICB9IGVsc2UgaWYgKFBsYXRmb3JtLk9TID09PSAnYW5kcm9pZCcpIHtcbiAgICAgIFN0YXR1c0Jhck1hbmFnZXIuc2V0SGlkZGVuKGhpZGRlbik7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFNldCB0aGUgc3RhdHVzIGJhciBzdHlsZVxuICAgKiBAcGFyYW0gc3R5bGUgU3RhdHVzIGJhciBzdHlsZSB0byBzZXRcbiAgICogQHBhcmFtIGFuaW1hdGVkIEFuaW1hdGUgdGhlIHN0eWxlIGNoYW5nZS5cbiAgICovXG4gIHN0YXRpYyBzZXRCYXJTdHlsZShzdHlsZTogU3RhdHVzQmFyU3R5bGUsIGFuaW1hdGVkPzogYm9vbGVhbikge1xuICAgIGFuaW1hdGVkID0gYW5pbWF0ZWQgfHwgZmFsc2U7XG4gICAgU3RhdHVzQmFyLl9kZWZhdWx0UHJvcHMuYmFyU3R5bGUudmFsdWUgPSBzdHlsZTtcbiAgICBpZiAoUGxhdGZvcm0uT1MgPT09ICdpb3MnKSB7XG4gICAgICBTdGF0dXNCYXJNYW5hZ2VyLnNldFN0eWxlKHN0eWxlLCBhbmltYXRlZCk7XG4gICAgfSBlbHNlIGlmIChQbGF0Zm9ybS5PUyA9PT0gJ2FuZHJvaWQnKSB7XG4gICAgICBTdGF0dXNCYXJNYW5hZ2VyLnNldFN0eWxlKHN0eWxlKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQ29udHJvbCB0aGUgdmlzaWJpbGl0eSBvZiB0aGUgbmV0d29yayBhY3Rpdml0eSBpbmRpY2F0b3JcbiAgICogQHBhcmFtIHZpc2libGUgU2hvdyB0aGUgaW5kaWNhdG9yLlxuICAgKi9cbiAgc3RhdGljIHNldE5ldHdvcmtBY3Rpdml0eUluZGljYXRvclZpc2libGUodmlzaWJsZTogYm9vbGVhbikge1xuICAgIGlmIChQbGF0Zm9ybS5PUyAhPT0gJ2lvcycpIHtcbiAgICAgIGNvbnNvbGUud2FybihcbiAgICAgICAgJ2BzZXROZXR3b3JrQWN0aXZpdHlJbmRpY2F0b3JWaXNpYmxlYCBpcyBvbmx5IGF2YWlsYWJsZSBvbiBpT1MnLFxuICAgICAgKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgU3RhdHVzQmFyLl9kZWZhdWx0UHJvcHMubmV0d29ya0FjdGl2aXR5SW5kaWNhdG9yVmlzaWJsZSA9IHZpc2libGU7XG4gICAgU3RhdHVzQmFyTWFuYWdlci5zZXROZXR3b3JrQWN0aXZpdHlJbmRpY2F0b3JWaXNpYmxlKHZpc2libGUpO1xuICB9XG5cbiAgLyoqXG4gICAqIFNldCB0aGUgYmFja2dyb3VuZCBjb2xvciBmb3IgdGhlIHN0YXR1cyBiYXJcbiAgICogQHBhcmFtIGNvbG9yIEJhY2tncm91bmQgY29sb3IuXG4gICAqIEBwYXJhbSBhbmltYXRlZCBBbmltYXRlIHRoZSBzdHlsZSBjaGFuZ2UuXG4gICAqL1xuICBzdGF0aWMgc2V0QmFja2dyb3VuZENvbG9yKGNvbG9yOiBzdHJpbmcsIGFuaW1hdGVkPzogYm9vbGVhbikge1xuICAgIGlmIChQbGF0Zm9ybS5PUyAhPT0gJ2FuZHJvaWQnKSB7XG4gICAgICBjb25zb2xlLndhcm4oJ2BzZXRCYWNrZ3JvdW5kQ29sb3JgIGlzIG9ubHkgYXZhaWxhYmxlIG9uIEFuZHJvaWQnKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgYW5pbWF0ZWQgPSBhbmltYXRlZCB8fCBmYWxzZTtcbiAgICBTdGF0dXNCYXIuX2RlZmF1bHRQcm9wcy5iYWNrZ3JvdW5kQ29sb3IudmFsdWUgPSBjb2xvcjtcbiAgICBTdGF0dXNCYXJNYW5hZ2VyLnNldENvbG9yKHByb2Nlc3NDb2xvcihjb2xvciksIGFuaW1hdGVkKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDb250cm9sIHRoZSB0cmFuc2x1Y2VuY3kgb2YgdGhlIHN0YXR1cyBiYXJcbiAgICogQHBhcmFtIHRyYW5zbHVjZW50IFNldCBhcyB0cmFuc2x1Y2VudC5cbiAgICovXG4gIHN0YXRpYyBzZXRUcmFuc2x1Y2VudCh0cmFuc2x1Y2VudDogYm9vbGVhbikge1xuICAgIGlmIChQbGF0Zm9ybS5PUyAhPT0gJ2FuZHJvaWQnKSB7XG4gICAgICBjb25zb2xlLndhcm4oJ2BzZXRUcmFuc2x1Y2VudGAgaXMgb25seSBhdmFpbGFibGUgb24gQW5kcm9pZCcpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBTdGF0dXNCYXIuX2RlZmF1bHRQcm9wcy50cmFuc2x1Y2VudCA9IHRyYW5zbHVjZW50O1xuICAgIFN0YXR1c0Jhck1hbmFnZXIuc2V0VHJhbnNsdWNlbnQodHJhbnNsdWNlbnQpO1xuICB9XG5cbiAgc3RhdGljIHByb3BUeXBlcyA9IHtcbiAgICAvKipcbiAgICAgKiBJZiB0aGUgc3RhdHVzIGJhciBpcyBoaWRkZW4uXG4gICAgICovXG4gICAgaGlkZGVuOiBQcm9wVHlwZXMuYm9vbCxcbiAgICAvKipcbiAgICAgKiBJZiB0aGUgdHJhbnNpdGlvbiBiZXR3ZWVuIHN0YXR1cyBiYXIgcHJvcGVydHkgY2hhbmdlcyBzaG91bGQgYmUgYW5pbWF0ZWQuXG4gICAgICogU3VwcG9ydGVkIGZvciBiYWNrZ3JvdW5kQ29sb3IsIGJhclN0eWxlIGFuZCBoaWRkZW4uXG4gICAgICovXG4gICAgYW5pbWF0ZWQ6IFByb3BUeXBlcy5ib29sLFxuICAgIC8qKlxuICAgICAqIFRoZSBiYWNrZ3JvdW5kIGNvbG9yIG9mIHRoZSBzdGF0dXMgYmFyLlxuICAgICAqIEBwbGF0Zm9ybSBhbmRyb2lkXG4gICAgICovXG4gICAgYmFja2dyb3VuZENvbG9yOiBDb2xvclByb3BUeXBlLFxuICAgIC8qKlxuICAgICAqIElmIHRoZSBzdGF0dXMgYmFyIGlzIHRyYW5zbHVjZW50LlxuICAgICAqIFdoZW4gdHJhbnNsdWNlbnQgaXMgc2V0IHRvIHRydWUsIHRoZSBhcHAgd2lsbCBkcmF3IHVuZGVyIHRoZSBzdGF0dXMgYmFyLlxuICAgICAqIFRoaXMgaXMgdXNlZnVsIHdoZW4gdXNpbmcgYSBzZW1pIHRyYW5zcGFyZW50IHN0YXR1cyBiYXIgY29sb3IuXG4gICAgICpcbiAgICAgKiBAcGxhdGZvcm0gYW5kcm9pZFxuICAgICAqL1xuICAgIHRyYW5zbHVjZW50OiBQcm9wVHlwZXMuYm9vbCxcbiAgICAvKipcbiAgICAgKiBTZXRzIHRoZSBjb2xvciBvZiB0aGUgc3RhdHVzIGJhciB0ZXh0LlxuICAgICAqL1xuICAgIGJhclN0eWxlOiBQcm9wVHlwZXMub25lT2YoWydkZWZhdWx0JywgJ2xpZ2h0LWNvbnRlbnQnLCAnZGFyay1jb250ZW50J10pLFxuICAgIC8qKlxuICAgICAqIElmIHRoZSBuZXR3b3JrIGFjdGl2aXR5IGluZGljYXRvciBzaG91bGQgYmUgdmlzaWJsZS5cbiAgICAgKlxuICAgICAqIEBwbGF0Zm9ybSBpb3NcbiAgICAgKi9cbiAgICBuZXR3b3JrQWN0aXZpdHlJbmRpY2F0b3JWaXNpYmxlOiBQcm9wVHlwZXMuYm9vbCxcbiAgICAvKipcbiAgICAgKiBUaGUgdHJhbnNpdGlvbiBlZmZlY3Qgd2hlbiBzaG93aW5nIGFuZCBoaWRpbmcgdGhlIHN0YXR1cyBiYXIgdXNpbmcgdGhlIGBoaWRkZW5gXG4gICAgICogcHJvcC4gRGVmYXVsdHMgdG8gJ2ZhZGUnLlxuICAgICAqXG4gICAgICogQHBsYXRmb3JtIGlvc1xuICAgICAqL1xuICAgIHNob3dIaWRlVHJhbnNpdGlvbjogUHJvcFR5cGVzLm9uZU9mKFsnZmFkZScsICdzbGlkZSddKSxcbiAgfTtcblxuICBzdGF0aWMgZGVmYXVsdFByb3BzID0ge1xuICAgIGFuaW1hdGVkOiBmYWxzZSxcbiAgICBzaG93SGlkZVRyYW5zaXRpb246ICdmYWRlJyxcbiAgfTtcblxuICBfc3RhY2tFbnRyeSA9IG51bGw7XG5cbiAgY29tcG9uZW50RGlkTW91bnQoKSB7XG4gICAgLy8gRXZlcnkgdGltZSBhIFN0YXR1c0JhciBjb21wb25lbnQgaXMgbW91bnRlZCwgd2UgcHVzaCBpdCdzIHByb3AgdG8gYSBzdGFja1xuICAgIC8vIGFuZCBhbHdheXMgdXBkYXRlIHRoZSBuYXRpdmUgc3RhdHVzIGJhciB3aXRoIHRoZSBwcm9wcyBmcm9tIHRoZSB0b3Agb2YgdGhlblxuICAgIC8vIHN0YWNrLiBUaGlzIGFsbG93cyBoYXZpbmcgbXVsdGlwbGUgU3RhdHVzQmFyIGNvbXBvbmVudHMgYW5kIHRoZSBvbmUgdGhhdCBpc1xuICAgIC8vIGFkZGVkIGxhc3Qgb3IgaXMgZGVlcGVyIGluIHRoZSB2aWV3IGhpZXJhcmNoeSB3aWxsIGhhdmUgcHJpb3JpdHkuXG4gICAgdGhpcy5fc3RhY2tFbnRyeSA9IGNyZWF0ZVN0YWNrRW50cnkodGhpcy5wcm9wcyk7XG4gICAgU3RhdHVzQmFyLl9wcm9wc1N0YWNrLnB1c2godGhpcy5fc3RhY2tFbnRyeSk7XG4gICAgdGhpcy5fdXBkYXRlUHJvcHNTdGFjaygpO1xuICB9XG5cbiAgY29tcG9uZW50V2lsbFVubW91bnQoKSB7XG4gICAgLy8gV2hlbiBhIFN0YXR1c0JhciBpcyB1bm1vdW50ZWQsIHJlbW92ZSBpdHNlbGYgZnJvbSB0aGUgc3RhY2sgYW5kIHVwZGF0ZVxuICAgIC8vIHRoZSBuYXRpdmUgYmFyIHdpdGggdGhlIG5leHQgcHJvcHMuXG4gICAgY29uc3QgaW5kZXggPSBTdGF0dXNCYXIuX3Byb3BzU3RhY2suaW5kZXhPZih0aGlzLl9zdGFja0VudHJ5KTtcbiAgICBTdGF0dXNCYXIuX3Byb3BzU3RhY2suc3BsaWNlKGluZGV4LCAxKTtcblxuICAgIHRoaXMuX3VwZGF0ZVByb3BzU3RhY2soKTtcbiAgfVxuXG4gIGNvbXBvbmVudERpZFVwZGF0ZSgpIHtcbiAgICBjb25zdCBpbmRleCA9IFN0YXR1c0Jhci5fcHJvcHNTdGFjay5pbmRleE9mKHRoaXMuX3N0YWNrRW50cnkpO1xuICAgIHRoaXMuX3N0YWNrRW50cnkgPSBjcmVhdGVTdGFja0VudHJ5KHRoaXMucHJvcHMpO1xuICAgIFN0YXR1c0Jhci5fcHJvcHNTdGFja1tpbmRleF0gPSB0aGlzLl9zdGFja0VudHJ5O1xuXG4gICAgdGhpcy5fdXBkYXRlUHJvcHNTdGFjaygpO1xuICB9XG5cbiAgLyoqXG4gICAqIFVwZGF0ZXMgdGhlIG5hdGl2ZSBzdGF0dXMgYmFyIHdpdGggdGhlIHByb3BzIGZyb20gdGhlIHN0YWNrLlxuICAgKi9cbiAgX3VwZGF0ZVByb3BzU3RhY2sgPSAoKSA9PiB7XG4gICAgLy8gU2VuZCB0aGUgdXBkYXRlIHRvIHRoZSBuYXRpdmUgbW9kdWxlIG9ubHkgb25jZSBhdCB0aGUgZW5kIG9mIHRoZSBmcmFtZS5cbiAgICBjbGVhckltbWVkaWF0ZShTdGF0dXNCYXIuX3VwZGF0ZUltbWVkaWF0ZSk7XG4gICAgU3RhdHVzQmFyLl91cGRhdGVJbW1lZGlhdGUgPSBzZXRJbW1lZGlhdGUoKCkgPT4ge1xuICAgICAgY29uc3Qgb2xkUHJvcHMgPSBTdGF0dXNCYXIuX2N1cnJlbnRWYWx1ZXM7XG4gICAgICBjb25zdCBtZXJnZWRQcm9wcyA9IG1lcmdlUHJvcHNTdGFjayhcbiAgICAgICAgU3RhdHVzQmFyLl9wcm9wc1N0YWNrLFxuICAgICAgICBTdGF0dXNCYXIuX2RlZmF1bHRQcm9wcyxcbiAgICAgICk7XG5cbiAgICAgIC8vIFVwZGF0ZSB0aGUgcHJvcHMgdGhhdCBoYXZlIGNoYW5nZWQgdXNpbmcgdGhlIG1lcmdlZCB2YWx1ZXMgZnJvbSB0aGUgcHJvcHMgc3RhY2suXG4gICAgICBpZiAoUGxhdGZvcm0uT1MgPT09ICdpb3MnKSB7XG4gICAgICAgIGlmIChcbiAgICAgICAgICAhb2xkUHJvcHMgfHxcbiAgICAgICAgICBvbGRQcm9wcy5iYXJTdHlsZS52YWx1ZSAhPT0gbWVyZ2VkUHJvcHMuYmFyU3R5bGUudmFsdWVcbiAgICAgICAgKSB7XG4gICAgICAgICAgU3RhdHVzQmFyTWFuYWdlci5zZXRTdHlsZShcbiAgICAgICAgICAgIG1lcmdlZFByb3BzLmJhclN0eWxlLnZhbHVlLFxuICAgICAgICAgICAgbWVyZ2VkUHJvcHMuYmFyU3R5bGUuYW5pbWF0ZWQsXG4gICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIW9sZFByb3BzIHx8IG9sZFByb3BzLmhpZGRlbi52YWx1ZSAhPT0gbWVyZ2VkUHJvcHMuaGlkZGVuLnZhbHVlKSB7XG4gICAgICAgICAgU3RhdHVzQmFyTWFuYWdlci5zZXRIaWRkZW4oXG4gICAgICAgICAgICBtZXJnZWRQcm9wcy5oaWRkZW4udmFsdWUsXG4gICAgICAgICAgICBtZXJnZWRQcm9wcy5oaWRkZW4uYW5pbWF0ZWRcbiAgICAgICAgICAgICAgPyBtZXJnZWRQcm9wcy5oaWRkZW4udHJhbnNpdGlvblxuICAgICAgICAgICAgICA6ICdub25lJyxcbiAgICAgICAgICApO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKFxuICAgICAgICAgICFvbGRQcm9wcyB8fFxuICAgICAgICAgIG9sZFByb3BzLm5ldHdvcmtBY3Rpdml0eUluZGljYXRvclZpc2libGUgIT09XG4gICAgICAgICAgICBtZXJnZWRQcm9wcy5uZXR3b3JrQWN0aXZpdHlJbmRpY2F0b3JWaXNpYmxlXG4gICAgICAgICkge1xuICAgICAgICAgIFN0YXR1c0Jhck1hbmFnZXIuc2V0TmV0d29ya0FjdGl2aXR5SW5kaWNhdG9yVmlzaWJsZShcbiAgICAgICAgICAgIG1lcmdlZFByb3BzLm5ldHdvcmtBY3Rpdml0eUluZGljYXRvclZpc2libGUsXG4gICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIGlmIChQbGF0Zm9ybS5PUyA9PT0gJ2FuZHJvaWQnKSB7XG4gICAgICAgIGlmIChcbiAgICAgICAgICAhb2xkUHJvcHMgfHxcbiAgICAgICAgICBvbGRQcm9wcy5iYXJTdHlsZS52YWx1ZSAhPT0gbWVyZ2VkUHJvcHMuYmFyU3R5bGUudmFsdWVcbiAgICAgICAgKSB7XG4gICAgICAgICAgU3RhdHVzQmFyTWFuYWdlci5zZXRTdHlsZShtZXJnZWRQcm9wcy5iYXJTdHlsZS52YWx1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKFxuICAgICAgICAgICFvbGRQcm9wcyB8fFxuICAgICAgICAgIG9sZFByb3BzLmJhY2tncm91bmRDb2xvci52YWx1ZSAhPT0gbWVyZ2VkUHJvcHMuYmFja2dyb3VuZENvbG9yLnZhbHVlXG4gICAgICAgICkge1xuICAgICAgICAgIFN0YXR1c0Jhck1hbmFnZXIuc2V0Q29sb3IoXG4gICAgICAgICAgICBwcm9jZXNzQ29sb3IobWVyZ2VkUHJvcHMuYmFja2dyb3VuZENvbG9yLnZhbHVlKSxcbiAgICAgICAgICAgIG1lcmdlZFByb3BzLmJhY2tncm91bmRDb2xvci5hbmltYXRlZCxcbiAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgICAgIGlmICghb2xkUHJvcHMgfHwgb2xkUHJvcHMuaGlkZGVuLnZhbHVlICE9PSBtZXJnZWRQcm9wcy5oaWRkZW4udmFsdWUpIHtcbiAgICAgICAgICBTdGF0dXNCYXJNYW5hZ2VyLnNldEhpZGRlbihtZXJnZWRQcm9wcy5oaWRkZW4udmFsdWUpO1xuICAgICAgICB9XG4gICAgICAgIGlmICghb2xkUHJvcHMgfHwgb2xkUHJvcHMudHJhbnNsdWNlbnQgIT09IG1lcmdlZFByb3BzLnRyYW5zbHVjZW50KSB7XG4gICAgICAgICAgU3RhdHVzQmFyTWFuYWdlci5zZXRUcmFuc2x1Y2VudChtZXJnZWRQcm9wcy50cmFuc2x1Y2VudCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIC8vIFVwZGF0ZSB0aGUgY3VycmVudCBwcm9wIHZhbHVlcy5cbiAgICAgIFN0YXR1c0Jhci5fY3VycmVudFZhbHVlcyA9IG1lcmdlZFByb3BzO1xuICAgIH0pO1xuICB9O1xuXG4gIHJlbmRlcigpOiBSZWFjdC5Ob2RlIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxufVxuXG5tb2R1bGUuZXhwb3J0cyA9IFN0YXR1c0JhcjtcbiJdfQ==