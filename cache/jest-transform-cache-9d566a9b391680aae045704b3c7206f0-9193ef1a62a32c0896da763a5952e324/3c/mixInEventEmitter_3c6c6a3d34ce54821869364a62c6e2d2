a16fd6186c978308bb68ec4f50c90ebe










'use strict';var _extends = Object.assign || function (target) {for (var i = 1; i < arguments.length; i++) {var source = arguments[i];for (var key in source) {if (Object.prototype.hasOwnProperty.call(source, key)) {target[key] = source[key];}}}return target;};

var EventEmitter = require('EventEmitter');
var EventEmitterWithHolding = require('EventEmitterWithHolding');
var EventHolder = require('EventHolder');

var invariant = require('fbjs/lib/invariant');



var keyOf = require('fbjs/lib/keyOf');



var TYPES_KEY = keyOf({ __types: true });






















function mixInEventEmitter(cls, types) {
  invariant(types, 'Must supply set of valid event types');



  var target = cls.prototype || cls;

  invariant(!target.__eventEmitter, 'An active emitter is already mixed in');

  var ctor = cls.constructor;
  if (ctor) {
    invariant(
    ctor === Object || ctor === Function,
    'Mix EventEmitter into a class, not an instance');

  }



  if (target.hasOwnProperty(TYPES_KEY)) {
    _extends(target.__types, types);
  } else if (target.__types) {
    target.__types = _extends({}, target.__types, types);
  } else {
    target.__types = types;
  }
  _extends(target, EventEmitterMixin);
}

var EventEmitterMixin = {
  emit: function emit(eventType, a, b, c, d, e, _) {
    return this.__getEventEmitter().emit(eventType, a, b, c, d, e, _);
  },

  emitAndHold: function emitAndHold(eventType, a, b, c, d, e, _) {
    return this.__getEventEmitter().emitAndHold(eventType, a, b, c, d, e, _);
  },

  addListener: function addListener(eventType, listener, context) {
    return this.__getEventEmitter().addListener(eventType, listener, context);
  },

  once: function once(eventType, listener, context) {
    return this.__getEventEmitter().once(eventType, listener, context);
  },

  addRetroactiveListener: function addRetroactiveListener(eventType, listener, context) {
    return this.__getEventEmitter().addRetroactiveListener(
    eventType,
    listener,
    context);

  },

  addListenerMap: function addListenerMap(listenerMap, context) {
    return this.__getEventEmitter().addListenerMap(listenerMap, context);
  },

  addRetroactiveListenerMap: function addRetroactiveListenerMap(listenerMap, context) {
    return this.__getEventEmitter().addListenerMap(listenerMap, context);
  },

  removeAllListeners: function removeAllListeners() {
    this.__getEventEmitter().removeAllListeners();
  },

  removeCurrentListener: function removeCurrentListener() {
    this.__getEventEmitter().removeCurrentListener();
  },

  releaseHeldEventType: function releaseHeldEventType(eventType) {
    this.__getEventEmitter().releaseHeldEventType(eventType);
  },

  __getEventEmitter: function __getEventEmitter() {
    if (!this.__eventEmitter) {
      var emitter = new EventEmitter();
      if (__DEV__) {
        var EventValidator = require('EventValidator');
        emitter = EventValidator.addValidation(emitter, this.__types);
      }

      var holder = new EventHolder();
      this.__eventEmitter = new EventEmitterWithHolding(emitter, holder);
    }
    return this.__eventEmitter;
  } };


module.exports = mixInEventEmitter;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1peEluRXZlbnRFbWl0dGVyLmpzIl0sIm5hbWVzIjpbIkV2ZW50RW1pdHRlciIsInJlcXVpcmUiLCJFdmVudEVtaXR0ZXJXaXRoSG9sZGluZyIsIkV2ZW50SG9sZGVyIiwiaW52YXJpYW50Iiwia2V5T2YiLCJUWVBFU19LRVkiLCJfX3R5cGVzIiwibWl4SW5FdmVudEVtaXR0ZXIiLCJjbHMiLCJ0eXBlcyIsInRhcmdldCIsInByb3RvdHlwZSIsIl9fZXZlbnRFbWl0dGVyIiwiY3RvciIsImNvbnN0cnVjdG9yIiwiT2JqZWN0IiwiRnVuY3Rpb24iLCJoYXNPd25Qcm9wZXJ0eSIsIkV2ZW50RW1pdHRlck1peGluIiwiZW1pdCIsImV2ZW50VHlwZSIsImEiLCJiIiwiYyIsImQiLCJlIiwiXyIsIl9fZ2V0RXZlbnRFbWl0dGVyIiwiZW1pdEFuZEhvbGQiLCJhZGRMaXN0ZW5lciIsImxpc3RlbmVyIiwiY29udGV4dCIsIm9uY2UiLCJhZGRSZXRyb2FjdGl2ZUxpc3RlbmVyIiwiYWRkTGlzdGVuZXJNYXAiLCJsaXN0ZW5lck1hcCIsImFkZFJldHJvYWN0aXZlTGlzdGVuZXJNYXAiLCJyZW1vdmVBbGxMaXN0ZW5lcnMiLCJyZW1vdmVDdXJyZW50TGlzdGVuZXIiLCJyZWxlYXNlSGVsZEV2ZW50VHlwZSIsImVtaXR0ZXIiLCJfX0RFVl9fIiwiRXZlbnRWYWxpZGF0b3IiLCJhZGRWYWxpZGF0aW9uIiwiaG9sZGVyIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7OztBQVVBLGE7O0FBRUEsSUFBTUEsZUFBZUMsUUFBUSxjQUFSLENBQXJCO0FBQ0EsSUFBTUMsMEJBQTBCRCxRQUFRLHlCQUFSLENBQWhDO0FBQ0EsSUFBTUUsY0FBY0YsUUFBUSxhQUFSLENBQXBCOztBQUVBLElBQU1HLFlBQVlILFFBQVEsb0JBQVIsQ0FBbEI7Ozs7QUFJQSxJQUFNSSxRQUFRSixRQUFRLGdCQUFSLENBQWQ7Ozs7QUFJQSxJQUFNSyxZQUFZRCxNQUFNLEVBQUNF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RCxDQUFQO0FBQ0QsR0EvQnVCOztBQWlDeEJNLHNCQUFvQiw4QkFBVztBQUM3QixTQUFLVixpQkFBTCxHQUF5QlUsa0JBQXpCO0FBQ0QsR0FuQ3VCOztBQXFDeEJDLHlCQUF1QixpQ0FBVztBQUNoQyxTQUFLWCxpQkFBTCxHQUF5QlcscUJBQXpCO0FBQ0QsR0F2Q3VCOztBQXlDeEJDLHdCQUFzQiw4QkFBU25CLFNBQVQsRUFBb0I7QUFDeEMsU0FBS08saUJBQUwsR0FBeUJZLG9CQUF6QixDQUE4Q25CLFNBQTlDO0FBQ0QsR0EzQ3VCOztBQTZDeEJPLHFCQUFtQiw2QkFBVztBQUM1QixRQUFJLENBQUMsS0FBS2YsY0FBVixFQUEwQjtBQUN4QixVQUFJNEIsVUFBVSxJQUFJekMsWUFBSixFQUFkO0FBQ0EsVUFBSTBDLE9BQUosRUFBYTtBQUNYLFlBQU1DLGlCQUFpQjFDLFFBQVEsZ0JBQVIsQ0FBdkI7QUFDQXdDLGtCQUFVRSxlQUFlQyxhQUFmLENBQTZCSCxPQUE3QixFQUFzQyxLQUFLbEMsT0FBM0MsQ0FBVjtBQUNEOztBQUVELFVBQU1zQyxTQUFTLElBQUkxQyxXQUFKLEVBQWY7QUFDQSxXQUFLVSxjQUFMLEdBQXNCLElBQUlYLHVCQUFKLENBQTRCdUMsT0FBNUIsRUFBcUNJLE1BQXJDLENBQXRCO0FBQ0Q7QUFDRCxXQUFPLEtBQUtoQyxjQUFaO0FBQ0QsR0F6RHVCLEVBQTFCOzs7QUE0REFpQyxPQUFPQyxPQUFQLEdBQWlCdkMsaUJBQWpCIiwiZmlsZSI6Im1peEluRXZlbnRFbWl0dGVyLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTUtcHJlc2VudCwgRmFjZWJvb2ssIEluYy5cbiAqXG4gKiBUaGlzIHNvdXJjZSBjb2RlIGlzIGxpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZSBmb3VuZCBpbiB0aGVcbiAqIExJQ0VOU0UgZmlsZSBpbiB0aGUgcm9vdCBkaXJlY3Rvcnkgb2YgdGhpcyBzb3VyY2UgdHJlZS5cbiAqXG4gKiBAZm9ybWF0XG4gKiBAZmxvd1xuICovXG5cbid1c2Ugc3RyaWN0JztcblxuY29uc3QgRXZlbnRFbWl0dGVyID0gcmVxdWlyZSgnRXZlbnRFbWl0dGVyJyk7XG5jb25zdCBFdmVudEVtaXR0ZXJXaXRoSG9sZGluZyA9IHJlcXVpcmUoJ0V2ZW50RW1pdHRlcldpdGhIb2xkaW5nJyk7XG5jb25zdCBFdmVudEhvbGRlciA9IHJlcXVpcmUoJ0V2ZW50SG9sZGVyJyk7XG5cbmNvbnN0IGludmFyaWFudCA9IHJlcXVpcmUoJ2ZianMvbGliL2ludmFyaWFudCcpO1xuLyogJEZsb3dGaXhNZSg+PTAuNTQuMCBzaXRlPXJlYWN0X25hdGl2ZV9vc3MpIFRoaXMgY29tbWVudCBzdXBwcmVzc2VzIGFuIGVycm9yXG4gKiBmb3VuZCB3aGVuIEZsb3cgdjAuNTQgd2FzIGRlcGxveWVkLiBUbyBzZWUgdGhlIGVycm9yIGRlbGV0ZSB0aGlzIGNvbW1lbnQgYW5kXG4gKiBydW4gRmxvdy4gKi9cbmNvbnN0IGtleU9mID0gcmVxdWlyZSgnZmJqcy9saWIva2V5T2YnKTtcblxuaW1wb3J0IHR5cGUgRW1pdHRlclN1YnNjcmlwdGlvbiBmcm9tICdFbWl0dGVyU3Vic2NyaXB0aW9uJztcblxuY29uc3QgVFlQRVNfS0VZID0ga2V5T2Yoe19fdHlwZXM6IHRydWV9KTtcblxuLyoqXG4gKiBBUEkgdG8gc2V0dXAgYW4gb2JqZWN0IG9yIGNvbnN0cnVjdG9yIHRvIGJlIGFibGUgdG8gZW1pdCBkYXRhIGV2ZW50cy5cbiAqXG4gKiBAZXhhbXBsZVxuICogZnVuY3Rpb24gRG9nKCkgeyAuLi5kb2cgc3R1ZmYuLi4gfVxuICogbWl4SW5FdmVudEVtaXR0ZXIoRG9nLCB7YmFyazogdHJ1ZX0pO1xuICpcbiAqIHZhciBwdXBweSA9IG5ldyBEb2coKTtcbiAqIHB1cHB5LmFkZExpc3RlbmVyKCdiYXJrJywgZnVuY3Rpb24gKHZvbHVtZSkge1xuICogICBjb25zb2xlLmxvZygnUHVwcHknLCB0aGlzLCAnYmFya2VkIGF0IHZvbHVtZTonLCB2b2x1bWUpO1xuICogfSk7XG4gKiBwdXBweS5lbWl0KCdiYXJrJywgJ3F1aWV0Jyk7XG4gKiAvLyBQdXBweSA8cHVwcHk+IGJhcmtlZCBhdCB2b2x1bWU6IHF1aWV0XG4gKlxuICpcbiAqIC8vIEEgXCJzaW5nbGV0b25cIiBvYmplY3QgbWF5IGFsc28gYmUgY29tbWlzc2lvbmVkOlxuICpcbiAqIHZhciBTaW5nbGV0b24gPSB7fTtcbiAqIG1peEluRXZlbnRFbWl0dGVyKFNpbmdsZXRvbiwge2xvbmVseTogdHJ1ZX0pO1xuICogU2luZ2xldG9uLmVtaXQoJ2xvbmVseScsIHRydWUpO1xuICovXG5mdW5jdGlvbiBtaXhJbkV2ZW50RW1pdHRlcihjbHM6IEZ1bmN0aW9uIHwgT2JqZWN0LCB0eXBlczogT2JqZWN0KSB7XG4gIGludmFyaWFudCh0eXBlcywgJ011c3Qgc3VwcGx5IHNldCBvZiB2YWxpZCBldmVudCB0eXBlcycpO1xuXG4gIC8vIElmIHRoaXMgaXMgYSBjb25zdHJ1Y3Rvciwgd3JpdGUgdG8gdGhlIHByb3RvdHlwZSwgb3RoZXJ3aXNlIHdyaXRlIHRvIHRoZVxuICAvLyBzaW5nbGV0b24gb2JqZWN0LlxuICBjb25zdCB0YXJnZXQgPSBjbHMucHJvdG90eXBlIHx8IGNscztcblxuICBpbnZhcmlhbnQoIXRhcmdldC5fX2V2ZW50RW1pdHRlciwgJ0FuIGFjdGl2ZSBlbWl0dGVyIGlzIGFscmVhZHkgbWl4ZWQgaW4nKTtcblxuICBjb25zdCBjdG9yID0gY2xzLmNvbnN0cnVjdG9yO1xuICBpZiAoY3Rvcikge1xuICAgIGludmFyaWFudChcbiAgICAgIGN0b3IgPT09IE9iamVjdCB8fCBjdG9yID09PSBGdW5jdGlvbixcbiAgICAgICdNaXggRXZlbnRFbWl0dGVyIGludG8gYSBjbGFzcywgbm90IGFuIGluc3RhbmNlJyxcbiAgICApO1xuICB9XG5cbiAgLy8gS2VlcCB0cmFjayBvZiB0aGUgcHJvdmlkZWQgdHlwZXMsIHVuaW9uIHRoZSB0eXBlcyBpZiB0aGV5IGFscmVhZHkgZXhpc3QsXG4gIC8vIHdoaWNoIGFsbG93cyBmb3IgcHJvdG90eXBlIHN1YmNsYXNzZXMgdG8gcHJvdmlkZSBtb3JlIHR5cGVzLlxuICBpZiAodGFyZ2V0Lmhhc093blByb3BlcnR5KFRZUEVTX0tFWSkpIHtcbiAgICBPYmplY3QuYXNzaWduKHRhcmdldC5fX3R5cGVzLCB0eXBlcyk7XG4gIH0gZWxzZSBpZiAodGFyZ2V0Ll9fdHlwZXMpIHtcbiAgICB0YXJnZXQuX190eXBlcyA9IE9iamVjdC5hc3NpZ24oe30sIHRhcmdldC5fX3R5cGVzLCB0eXBlcyk7XG4gIH0gZWxzZSB7XG4gICAgdGFyZ2V0Ll9fdHlwZXMgPSB0eXBlcztcbiAgfVxuICBPYmplY3QuYXNzaWduKHRhcmdldCwgRXZlbnRFbWl0dGVyTWl4aW4pO1xufVxuXG5jb25zdCBFdmVudEVtaXR0ZXJNaXhpbiA9IHtcbiAgZW1pdDogZnVuY3Rpb24oZXZlbnRUeXBlLCBhLCBiLCBjLCBkLCBlLCBfKSB7XG4gICAgcmV0dXJuIHRoaXMuX19nZXRFdmVudEVtaXR0ZXIoKS5lbWl0KGV2ZW50VHlwZSwgYSwgYiwgYywgZCwgZSwgXyk7XG4gIH0sXG5cbiAgZW1pdEFuZEhvbGQ6IGZ1bmN0aW9uKGV2ZW50VHlwZSwgYSwgYiwgYywgZCwgZSwgXykge1xuICAgIHJldHVybiB0aGlzLl9fZ2V0RXZlbnRFbWl0dGVyKCkuZW1pdEFuZEhvbGQoZXZlbnRUeXBlLCBhLCBiLCBjLCBkLCBlLCBfKTtcbiAgfSxcblxuICBhZGRMaXN0ZW5lcjogZnVuY3Rpb24oZXZlbnRUeXBlLCBsaXN0ZW5lciwgY29udGV4dCk6IEVtaXR0ZXJTdWJzY3JpcHRpb24ge1xuICAgIHJldHVybiB0aGlzLl9fZ2V0RXZlbnRFbWl0dGVyKCkuYWRkTGlzdGVuZXIoZXZlbnRUeXBlLCBsaXN0ZW5lciwgY29udGV4dCk7XG4gIH0sXG5cbiAgb25jZTogZnVuY3Rpb24oZXZlbnRUeXBlLCBsaXN0ZW5lciwgY29udGV4dCkge1xuICAgIHJldHVybiB0aGlzLl9fZ2V0RXZlbnRFbWl0dGVyKCkub25jZShldmVudFR5cGUsIGxpc3RlbmVyLCBjb250ZXh0KTtcbiAgfSxcblxuICBhZGRSZXRyb2FjdGl2ZUxpc3RlbmVyOiBmdW5jdGlvbihldmVudFR5cGUsIGxpc3RlbmVyLCBjb250ZXh0KSB7XG4gICAgcmV0dXJuIHRoaXMuX19nZXRFdmVudEVtaXR0ZXIoKS5hZGRSZXRyb2FjdGl2ZUxpc3RlbmVyKFxuICAgICAgZXZlbnRUeXBlLFxuICAgICAgbGlzdGVuZXIsXG4gICAgICBjb250ZXh0LFxuICAgICk7XG4gIH0sXG5cbiAgYWRkTGlzdGVuZXJNYXA6IGZ1bmN0aW9uKGxpc3RlbmVyTWFwLCBjb250ZXh0KSB7XG4gICAgcmV0dXJuIHRoaXMuX19nZXRFdmVudEVtaXR0ZXIoKS5hZGRMaXN0ZW5lck1hcChsaXN0ZW5lck1hcCwgY29udGV4dCk7XG4gIH0sXG5cbiAgYWRkUmV0cm9hY3RpdmVMaXN0ZW5lck1hcDogZnVuY3Rpb24obGlzdGVuZXJNYXAsIGNvbnRleHQpIHtcbiAgICByZXR1cm4gdGhpcy5fX2dldEV2ZW50RW1pdHRlcigpLmFkZExpc3RlbmVyTWFwKGxpc3RlbmVyTWFwLCBjb250ZXh0KTtcbiAgfSxcblxuICByZW1vdmVBbGxMaXN0ZW5lcnM6IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuX19nZXRFdmVudEVtaXR0ZXIoKS5yZW1vdmVBbGxMaXN0ZW5lcnMoKTtcbiAgfSxcblxuICByZW1vdmVDdXJyZW50TGlzdGVuZXI6IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuX19nZXRFdmVudEVtaXR0ZXIoKS5yZW1vdmVDdXJyZW50TGlzdGVuZXIoKTtcbiAgfSxcblxuICByZWxlYXNlSGVsZEV2ZW50VHlwZTogZnVuY3Rpb24oZXZlbnRUeXBlKSB7XG4gICAgdGhpcy5fX2dldEV2ZW50RW1pdHRlcigpLnJlbGVhc2VIZWxkRXZlbnRUeXBlKGV2ZW50VHlwZSk7XG4gIH0sXG5cbiAgX19nZXRFdmVudEVtaXR0ZXI6IGZ1bmN0aW9uKCkge1xuICAgIGlmICghdGhpcy5fX2V2ZW50RW1pdHRlcikge1xuICAgICAgbGV0IGVtaXR0ZXIgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG4gICAgICBpZiAoX19ERVZfXykge1xuICAgICAgICBjb25zdCBFdmVudFZhbGlkYXRvciA9IHJlcXVpcmUoJ0V2ZW50VmFsaWRhdG9yJyk7XG4gICAgICAgIGVtaXR0ZXIgPSBFdmVudFZhbGlkYXRvci5hZGRWYWxpZGF0aW9uKGVtaXR0ZXIsIHRoaXMuX190eXBlcyk7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IGhvbGRlciA9IG5ldyBFdmVudEhvbGRlcigpO1xuICAgICAgdGhpcy5fX2V2ZW50RW1pdHRlciA9IG5ldyBFdmVudEVtaXR0ZXJXaXRoSG9sZGluZyhlbWl0dGVyLCBob2xkZXIpO1xuICAgIH1cbiAgICByZXR1cm4gdGhpcy5fX2V2ZW50RW1pdHRlcjtcbiAgfSxcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gbWl4SW5FdmVudEVtaXR0ZXI7XG4iXX0=