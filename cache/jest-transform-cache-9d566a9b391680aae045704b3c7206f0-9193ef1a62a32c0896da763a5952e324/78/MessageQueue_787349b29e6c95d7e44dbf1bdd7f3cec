9b927d9d4e17fdecc5ad8c35953126e9










'use strict';var _createClass = function () {function defineProperties(target, props) {for (var i = 0; i < props.length; i++) {var descriptor = props[i];descriptor.enumerable = descriptor.enumerable || false;descriptor.configurable = true;if ("value" in descriptor) descriptor.writable = true;Object.defineProperty(target, descriptor.key, descriptor);}}return function (Constructor, protoProps, staticProps) {if (protoProps) defineProperties(Constructor.prototype, protoProps);if (staticProps) defineProperties(Constructor, staticProps);return Constructor;};}();function _toConsumableArray(arr) {if (Array.isArray(arr)) {for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) {arr2[i] = arr[i];}return arr2;} else {return Array.from(arr);}}function _classCallCheck(instance, Constructor) {if (!(instance instanceof Constructor)) {throw new TypeError("Cannot call a class as a function");}}

var ErrorUtils = require('ErrorUtils');
var Systrace = require('Systrace');

var deepFreezeAndThrowOnMutationInDev = require('deepFreezeAndThrowOnMutationInDev');
var invariant = require('fbjs/lib/invariant');
var stringifySafe = require('stringifySafe');








var TO_JS = 0;
var TO_NATIVE = 1;

var MODULE_IDS = 0;
var METHOD_IDS = 1;
var PARAMS = 2;
var MIN_TIME_BETWEEN_FLUSHES_MS = 5;


var TRACE_TAG_REACT_APPS = 1 << 17;

var DEBUG_INFO_LIMIT = 32;var

MessageQueue = function () {















  function MessageQueue() {_classCallCheck(this, MessageQueue);
    this._lazyCallableModules = {};
    this._queue = [[], [], [], 0];
    this._successCallbacks = {};
    this._failureCallbacks = {};
    this._callID = 0;
    this._lastFlush = 0;
    this._eventLoopStartTime = Date.now();
    this._immediatesCallback = null;

    if (__DEV__) {
      this._debugInfo = {};
      this._remoteModuleTable = {};
      this._remoteMethodTable = {};
    }

    this.callFunctionReturnFlushedQueue = this.callFunctionReturnFlushedQueue.bind(
    this);

    this.callFunctionReturnResultAndFlushedQueue = this.callFunctionReturnResultAndFlushedQueue.bind(
    this);

    this.flushedQueue = this.flushedQueue.bind(this);
    this.invokeCallbackAndReturnFlushedQueue = this.invokeCallbackAndReturnFlushedQueue.bind(
    this);

  }_createClass(MessageQueue, [{ key: 'callFunctionReturnFlushedQueue', value: function callFunctionReturnFlushedQueue(





















    module, method, args) {var _this = this;
      this.__guard(function () {
        _this.__callFunction(module, method, args);
      });

      return this.flushedQueue();
    } }, { key: 'callFunctionReturnResultAndFlushedQueue', value: function callFunctionReturnResultAndFlushedQueue(


    module,
    method,
    args)
    {var _this2 = this;
      var result = void 0;
      this.__guard(function () {
        result = _this2.__callFunction(module, method, args);
      });

      return [result, this.flushedQueue()];
    } }, { key: 'invokeCallbackAndReturnFlushedQueue', value: function invokeCallbackAndReturnFlushedQueue(

    cbID, args) {var _this3 = this;
      this.__guard(function () {
        _this3.__invokeCallback(cbID, args);
      });

      return this.flushedQueue();
    } }, { key: 'flushedQueue', value: function flushedQueue()

    {var _this4 = this;
      this.__guard(function () {
        _this4.__callImmediates();
      });

      var queue = this._queue;
      this._queue = [[], [], [], this._callID];
      return queue[0].length ? queue : null;
    } }, { key: 'getEventLoopRunningTime', value: function getEventLoopRunningTime()

    {
      return Date.now() - this._eventLoopStartTime;
    } }, { key: 'registerCallableModule', value: function registerCallableModule(

    name, module) {
      this._lazyCallableModules[name] = function () {return module;};
    } }, { key: 'registerLazyCallableModule', value: function registerLazyCallableModule(

    name, factory) {
      var module = void 0;
      var getValue = factory;
      this._lazyCallableModules[name] = function () {
        if (getValue) {
          module = getValue();
          getValue = null;
        }
        return module;
      };
    } }, { key: 'getCallableModule', value: function getCallableModule(

    name) {
      var getValue = this._lazyCallableModules[name];
      return getValue ? getValue() : null;
    } }, { key: 'enqueueNativeCall', value: function enqueueNativeCall(


    moduleID,
    methodID,
    params,
    onFail,
    onSucc)
    {
      if (onFail || onSucc) {
        if (__DEV__) {
          this._debugInfo[this._callID] = [moduleID, methodID];
          if (this._callID > DEBUG_INFO_LIMIT) {
            delete this._debugInfo[this._callID - DEBUG_INFO_LIMIT];
          }
        }



        onFail && params.push(this._callID << 1);

        onSucc && params.push(this._callID << 1 | 1);
        this._successCallbacks[this._callID] = onSucc;
        this._failureCallbacks[this._callID] = onFail;
      }

      if (__DEV__) {
        global.nativeTraceBeginAsyncFlow &&
        global.nativeTraceBeginAsyncFlow(
        TRACE_TAG_REACT_APPS,
        'native',
        this._callID);

      }
      this._callID++;

      this._queue[MODULE_IDS].push(moduleID);
      this._queue[METHOD_IDS].push(methodID);

      if (__DEV__) {




        var isValidArgument = function isValidArgument(val) {
          var t = typeof val;
          if (
          t === 'undefined' ||
          t === 'null' ||
          t === 'boolean' ||
          t === 'number' ||
          t === 'string')
          {
            return true;
          }
          if (t === 'function' || t !== 'object') {
            return false;
          }
          if (Array.isArray(val)) {
            return val.every(isValidArgument);
          }
          for (var k in val) {
            if (typeof val[k] !== 'function' && !isValidArgument(val[k])) {
              return false;
            }
          }
          return true;
        };

        invariant(
        isValidArgument(params),
        '%s is not usable as a native method argument',
        params);



        deepFreezeAndThrowOnMutationInDev(params);
      }
      this._queue[PARAMS].push(params);

      var now = Date.now();
      if (
      global.nativeFlushQueueImmediate &&
      now - this._lastFlush >= MIN_TIME_BETWEEN_FLUSHES_MS)
      {
        var queue = this._queue;
        this._queue = [[], [], [], this._callID];
        this._lastFlush = now;
        global.nativeFlushQueueImmediate(queue);
      }
      Systrace.counterEvent('pending_js_to_native_queue', this._queue[0].length);
      if (__DEV__ && this.__spy && isFinite(moduleID)) {
        this.__spy({
          type: TO_NATIVE,
          module: this._remoteModuleTable[moduleID],
          method: this._remoteMethodTable[moduleID][methodID],
          args: params });

      } else if (this.__spy) {
        this.__spy({
          type: TO_NATIVE,
          module: moduleID + '',
          method: methodID,
          args: params });

      }
    } }, { key: 'createDebugLookup', value: function createDebugLookup(

    moduleID, name, methods) {
      if (__DEV__) {
        this._remoteModuleTable[moduleID] = name;
        this._remoteMethodTable[moduleID] = methods;
      }
    } }, { key: 'setImmediatesCallback', value: function setImmediatesCallback(




    fn) {
      this._immediatesCallback = fn;
    } }, { key: '__guard', value: function __guard(





    fn) {
      if (this.__shouldPauseOnThrow()) {
        fn();
      } else {
        try {
          fn();
        } catch (error) {
          ErrorUtils.reportFatalError(error);
        }
      }
    } }, { key: '__shouldPauseOnThrow', value: function __shouldPauseOnThrow()






    {
      return (

        typeof DebuggerInternal !== 'undefined' &&
        DebuggerInternal.shouldPauseOnThrow === true);

    } }, { key: '__callImmediates', value: function __callImmediates()

    {
      Systrace.beginEvent('JSTimers.callImmediates()');
      if (this._immediatesCallback != null) {
        this._immediatesCallback();
      }
      Systrace.endEvent();
    } }, { key: '__callFunction', value: function __callFunction(

    module, method, args) {
      this._lastFlush = Date.now();
      this._eventLoopStartTime = this._lastFlush;
      if (__DEV__ || this.__spy) {
        Systrace.beginEvent(module + '.' + method + '(' + stringifySafe(args) + ')');
      } else {
        Systrace.beginEvent(module + '.' + method + '(...)');
      }
      if (this.__spy) {
        this.__spy({ type: TO_JS, module: module, method: method, args: args });
      }
      var moduleMethods = this.getCallableModule(module);
      invariant(
      !!moduleMethods,
      'Module %s is not a registered callable module (calling %s)',
      module,
      method);

      invariant(
      !!moduleMethods[method],
      'Method %s does not exist on module %s',
      method,
      module);

      var result = moduleMethods[method].apply(moduleMethods, args);
      Systrace.endEvent();
      return result;
    } }, { key: '__invokeCallback', value: function __invokeCallback(

    cbID, args) {
      this._lastFlush = Date.now();
      this._eventLoopStartTime = this._lastFlush;



      var callID = cbID >>> 1;

      var isSuccess = cbID & 1;
      var callback = isSuccess ?
      this._successCallbacks[callID] :
      this._failureCallbacks[callID];

      if (__DEV__) {
        var debug = this._debugInfo[callID];
        var _module = debug && this._remoteModuleTable[debug[0]];
        var _method = debug && this._remoteMethodTable[debug[0]][debug[1]];
        if (!callback) {
          var errorMessage = 'Callback with id ' + cbID + ': ' + _module + '.' + _method + '() not found';
          if (_method) {
            errorMessage =
            'The callback ' + _method + '() exists in module ' + _module + ', ' +
            'but only one callback may be registered to a function in a native module.';
          }
          invariant(callback, errorMessage);
        }
        var profileName = debug ?
        '<callback for ' + _module + '.' + _method + '>' :
        cbID;
        if (callback && this.__spy) {
          this.__spy({ type: TO_JS, module: null, method: profileName, args: args });
        }
        Systrace.beginEvent('MessageQueue.invokeCallback(' +
        profileName + ', ' + stringifySafe(args) + ')');

      }

      if (!callback) {
        return;
      }

      delete this._successCallbacks[callID];
      delete this._failureCallbacks[callID];
      callback.apply(undefined, _toConsumableArray(args));

      if (__DEV__) {
        Systrace.endEvent();
      }
    } }], [{ key: 'spy', value: function spy(spyOrToggle) {if (spyOrToggle === true) {MessageQueue.prototype.__spy = function (info) {console.log((info.type === TO_JS ? 'N->JS' : 'JS->N') + ' : ' + ('' + (info.module ? info.module + '.' : '') + info.method) + ('(' + JSON.stringify(info.args) + ')'));};} else if (spyOrToggle === false) {MessageQueue.prototype.__spy = null;} else {MessageQueue.prototype.__spy = spyOrToggle;}} }]);return MessageQueue;}();


module.exports = MessageQueue;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIk1lc3NhZ2VRdWV1ZS5qcyJdLCJuYW1lcyI6WyJFcnJvclV0aWxzIiwicmVxdWlyZSIsIlN5c3RyYWNlIiwiZGVlcEZyZWV6ZUFuZFRocm93T25NdXRhdGlvbkluRGV2IiwiaW52YXJpYW50Iiwic3RyaW5naWZ5U2FmZSIsIlRPX0pTIiwiVE9fTkFUSVZFIiwiTU9EVUxFX0lEUyIsIk1FVEhPRF9JRFMiLCJQQVJBTVMiLCJNSU5fVElNRV9CRVRXRUVOX0ZMVVNIRVNfTVMiLCJUUkFDRV9UQUdfUkVBQ1RfQVBQUyIsIkRFQlVHX0lORk9fTElNSVQiLCJNZXNzYWdlUXVldWUiLCJfbGF6eUNhbGxhYmxlTW9kdWxlcyIsIl9xdWV1ZSIsIl9zdWNjZXNzQ2FsbGJhY2tzIiwiX2ZhaWx1cmVDYWxsYmFja3MiLCJfY2FsbElEIiwiX2xhc3RGbHVzaCIsIl9ldmVudExvb3BTdGFydFRpbWUiLCJEYXRlIiwibm93IiwiX2ltbWVkaWF0ZXNDYWxsYmFjayIsIl9fREVWX18iLCJfZGVidWdJbmZvIiwiX3JlbW90ZU1vZHVsZVRhYmxlIiwiX3JlbW90ZU1ldGhvZFRhYmxlIiwiY2FsbEZ1bmN0aW9uUmV0dXJuRmx1c2hlZFF1ZXVlIiwiYmluZCIsImNhbGxGdW5jdGlvblJldHVyblJlc3VsdEFuZEZsdXNoZWRRdWV1ZSIsImZsdXNoZWRRdWV1ZSIsImludm9rZUNhbGxiYWNrQW5kUmV0dXJuRmx1c2hlZFF1ZXVlIiwibW9kdWxlIiwibWV0aG9kIiwiYXJncyIsIl9fZ3VhcmQiLCJfX2NhbGxGdW5jdGlvbiIsInJlc3VsdCIsImNiSUQiLCJfX2ludm9rZUNhbGxiYWNrIiwiX19jYWxsSW1tZWRpYXRlcyIsInF1ZXVlIiwibGVuZ3RoIiwibmFtZSIsImZhY3RvcnkiLCJnZXRWYWx1ZSIsIm1vZHVsZUlEIiwibWV0aG9kSUQiLCJwYXJhbXMiLCJvbkZhaWwiLCJvblN1Y2MiLCJwdXNoIiwiZ2xvYmFsIiwibmF0aXZlVHJhY2VCZWdpbkFzeW5jRmxvdyIsImlzVmFsaWRBcmd1bWVudCIsInQiLCJ2YWwiLCJBcnJheSIsImlzQXJyYXkiLCJldmVyeSIsImsiLCJuYXRpdmVGbHVzaFF1ZXVlSW1tZWRpYXRlIiwiY291bnRlckV2ZW50IiwiX19zcHkiLCJpc0Zpbml0ZSIsInR5cGUiLCJtZXRob2RzIiwiZm4iLCJfX3Nob3VsZFBhdXNlT25UaHJvdyIsImVycm9yIiwicmVwb3J0RmF0YWxFcnJvciIsIkRlYnVnZ2VySW50ZXJuYWwiLCJzaG91bGRQYXVzZU9uVGhyb3ciLCJiZWdpbkV2ZW50IiwiZW5kRXZlbnQiLCJtb2R1bGVNZXRob2RzIiwiZ2V0Q2FsbGFibGVNb2R1bGUiLCJhcHBseSIsImNhbGxJRCIsImlzU3VjY2VzcyIsImNhbGxiYWNrIiwiZGVidWciLCJlcnJvck1lc3NhZ2UiLCJwcm9maWxlTmFtZSIsInNweU9yVG9nZ2xlIiwicHJvdG90eXBlIiwiY29uc29sZSIsImxvZyIsImluZm8iLCJKU09OIiwic3RyaW5naWZ5IiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7OztBQVVBLGE7O0FBRUEsSUFBTUEsYUFBYUMsUUFBUSxZQUFSLENBQW5CO0FBQ0EsSUFBTUMsV0FBV0QsUUFBUSxVQUFSLENBQWpCOztBQUVBLElBQU1FLG9DQUFvQ0YsUUFBUSxtQ0FBUixDQUExQztBQUNBLElBQU1HLFlBQVlILFFBQVEsb0JBQVIsQ0FBbEI7QUFDQSxJQUFNSSxnQkFBZ0JKLFFBQVEsZUFBUixDQUF0Qjs7Ozs7Ozs7O0FBU0EsSUFBTUssUUFBUSxDQUFkO0FBQ0EsSUFBTUMsWUFBWSxDQUFsQjs7QUFFQSxJQUFNQyxhQUFhLENBQW5CO0FBQ0EsSUFBTUMsYUFBYSxDQUFuQjtBQUNBLElBQU1DLFNBQVMsQ0FBZjtBQUNBLElBQU1DLDhCQUE4QixDQUFwQzs7O0FBR0EsSUFBTUMsdUJBQXVCLEtBQUssRUFBbEM7O0FBRUEsSUFBTUMsbUJBQW1CLEVBQXpCLEM7O0FBRU1DLFk7Ozs7Ozs7Ozs7Ozs7Ozs7QUFnQkosMEJBQWM7QUFDWixTQUFLQyxvQkFBTCxHQUE0QixFQUE1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LFVBQ2lEaEYsY0FBYytCLElBQWQsQ0FEakQ7O0FBR0Q7O0FBRUQsVUFBSSxDQUFDOEMsUUFBTCxFQUFlO0FBQ2I7QUFDRDs7QUFFRCxhQUFPLEtBQUtqRSxpQkFBTCxDQUF1QitELE1BQXZCLENBQVA7QUFDQSxhQUFPLEtBQUs5RCxpQkFBTCxDQUF1QjhELE1BQXZCLENBQVA7QUFDQUUsbURBQVk5QyxJQUFaOztBQUVBLFVBQUlYLE9BQUosRUFBYTtBQUNYdkIsaUJBQVMwRSxRQUFUO0FBQ0Q7QUFDRixLLHdDQTFUVVUsVyxFQUFrRCxDQUMzRCxJQUFJQSxnQkFBZ0IsSUFBcEIsRUFBMEIsQ0FDeEJ4RSxhQUFheUUsU0FBYixDQUF1QnRCLEtBQXZCLEdBQStCLGdCQUFRLENBQ3JDdUIsUUFBUUMsR0FBUixDQUNFLENBQUdDLEtBQUt2QixJQUFMLEtBQWM3RCxLQUFkLEdBQXNCLE9BQXRCLEdBQWdDLE9BQW5DLG1CQUNLb0YsS0FBS3hELE1BQUwsR0FBY3dELEtBQUt4RCxNQUFMLEdBQWMsR0FBNUIsR0FBa0MsRUFEdkMsSUFDNEN3RCxLQUFLdkQsTUFEakQsV0FFTXdELEtBQUtDLFNBQUwsQ0FBZUYsS0FBS3RELElBQXBCLENBRk4sT0FERixFQUtELENBTkQsQ0FPRCxDQVJELE1BUU8sSUFBSWtELGdCQUFnQixLQUFwQixFQUEyQixDQUNoQ3hFLGFBQWF5RSxTQUFiLENBQXVCdEIsS0FBdkIsR0FBK0IsSUFBL0IsQ0FDRCxDQUZNLE1BRUEsQ0FDTG5ELGFBQWF5RSxTQUFiLENBQXVCdEIsS0FBdkIsR0FBK0JxQixXQUEvQixDQUNELENBQ0YsQzs7O0FBK1NIcEQsT0FBTzJELE9BQVAsR0FBaUIvRSxZQUFqQiIsImZpbGUiOiJNZXNzYWdlUXVldWUuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIENvcHlyaWdodCAoYykgMjAxNS1wcmVzZW50LCBGYWNlYm9vaywgSW5jLlxuICpcbiAqIFRoaXMgc291cmNlIGNvZGUgaXMgbGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlIGZvdW5kIGluIHRoZVxuICogTElDRU5TRSBmaWxlIGluIHRoZSByb290IGRpcmVjdG9yeSBvZiB0aGlzIHNvdXJjZSB0cmVlLlxuICpcbiAqIEBmbG93XG4gKiBAZm9ybWF0XG4gKi9cblxuJ3VzZSBzdHJpY3QnO1xuXG5jb25zdCBFcnJvclV0aWxzID0gcmVxdWlyZSgnRXJyb3JVdGlscycpO1xuY29uc3QgU3lzdHJhY2UgPSByZXF1aXJlKCdTeXN0cmFjZScpO1xuXG5jb25zdCBkZWVwRnJlZXplQW5kVGhyb3dPbk11dGF0aW9uSW5EZXYgPSByZXF1aXJlKCdkZWVwRnJlZXplQW5kVGhyb3dPbk11dGF0aW9uSW5EZXYnKTtcbmNvbnN0IGludmFyaWFudCA9IHJlcXVpcmUoJ2ZianMvbGliL2ludmFyaWFudCcpO1xuY29uc3Qgc3RyaW5naWZ5U2FmZSA9IHJlcXVpcmUoJ3N0cmluZ2lmeVNhZmUnKTtcblxuZXhwb3J0IHR5cGUgU3B5RGF0YSA9IHtcbiAgdHlwZTogbnVtYmVyLFxuICBtb2R1bGU6ID9zdHJpbmcsXG4gIG1ldGhvZDogc3RyaW5nIHwgbnVtYmVyLFxuICBhcmdzOiBhbnlbXSxcbn07XG5cbmNvbnN0IFRPX0pTID0gMDtcbmNvbnN0IFRPX05BVElWRSA9IDE7XG5cbmNvbnN0IE1PRFVMRV9JRFMgPSAwO1xuY29uc3QgTUVUSE9EX0lEUyA9IDE7XG5jb25zdCBQQVJBTVMgPSAyO1xuY29uc3QgTUlOX1RJTUVfQkVUV0VFTl9GTFVTSEVTX01TID0gNTtcblxuLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLWJpdHdpc2VcbmNvbnN0IFRSQUNFX1RBR19SRUFDVF9BUFBTID0gMSA8PCAxNztcblxuY29uc3QgREVCVUdfSU5GT19MSU1JVCA9IDMyO1xuXG5jbGFzcyBNZXNzYWdlUXVldWUge1xuICBfbGF6eUNhbGxhYmxlTW9kdWxlczoge1trZXk6IHN0cmluZ106ICh2b2lkKSA9PiBPYmplY3R9O1xuICBfcXVldWU6IFtudW1iZXJbXSwgbnVtYmVyW10sIGFueVtdLCBudW1iZXJdO1xuICBfc3VjY2Vzc0NhbGxiYWNrczoge1trZXk6IG51bWJlcl06ID9GdW5jdGlvbn07XG4gIF9mYWlsdXJlQ2FsbGJhY2tzOiB7W2tleTogbnVtYmVyXTogP0Z1bmN0aW9ufTtcbiAgX2NhbGxJRDogbnVtYmVyO1xuICBfbGFzdEZsdXNoOiBudW1iZXI7XG4gIF9ldmVudExvb3BTdGFydFRpbWU6IG51bWJlcjtcbiAgX2ltbWVkaWF0ZXNDYWxsYmFjazogPygpID0+IHZvaWQ7XG5cbiAgX2RlYnVnSW5mbzoge1tudW1iZXJdOiBbbnVtYmVyLCBudW1iZXJdfTtcbiAgX3JlbW90ZU1vZHVsZVRhYmxlOiB7W251bWJlcl06IHN0cmluZ307XG4gIF9yZW1vdGVNZXRob2RUYWJsZToge1tudW1iZXJdOiBzdHJpbmdbXX07XG5cbiAgX19zcHk6ID8oZGF0YTogU3B5RGF0YSkgPT4gdm9pZDtcblxuICBjb25zdHJ1Y3RvcigpIHtcbiAgICB0aGlzLl9sYXp5Q2FsbGFibGVNb2R1bGVzID0ge307XG4gICAgdGhpcy5fcXVldWUgPSBbW10sIFtdLCBbXSwgMF07XG4gICAgdGhpcy5fc3VjY2Vzc0NhbGxiYWNrcyA9IHt9O1xuICAgIHRoaXMuX2ZhaWx1cmVDYWxsYmFja3MgPSB7fTtcbiAgICB0aGlzLl9jYWxsSUQgPSAwO1xuICAgIHRoaXMuX2xhc3RGbHVzaCA9IDA7XG4gICAgdGhpcy5fZXZlbnRMb29wU3RhcnRUaW1lID0gRGF0ZS5ub3coKTtcbiAgICB0aGlzLl9pbW1lZGlhdGVzQ2FsbGJhY2sgPSBudWxsO1xuXG4gICAgaWYgKF9fREVWX18pIHtcbiAgICAgIHRoaXMuX2RlYnVnSW5mbyA9IHt9O1xuICAgICAgdGhpcy5fcmVtb3RlTW9kdWxlVGFibGUgPSB7fTtcbiAgICAgIHRoaXMuX3JlbW90ZU1ldGhvZFRhYmxlID0ge307XG4gICAgfVxuXG4gICAgKHRoaXM6IGFueSkuY2FsbEZ1bmN0aW9uUmV0dXJuRmx1c2hlZFF1ZXVlID0gdGhpcy5jYWxsRnVuY3Rpb25SZXR1cm5GbHVzaGVkUXVldWUuYmluZChcbiAgICAgIHRoaXMsXG4gICAgKTtcbiAgICAodGhpczogYW55KS5jYWxsRnVuY3Rpb25SZXR1cm5SZXN1bHRBbmRGbHVzaGVkUXVldWUgPSB0aGlzLmNhbGxGdW5jdGlvblJldHVyblJlc3VsdEFuZEZsdXNoZWRRdWV1ZS5iaW5kKFxuICAgICAgdGhpcyxcbiAgICApO1xuICAgICh0aGlzOiBhbnkpLmZsdXNoZWRRdWV1ZSA9IHRoaXMuZmx1c2hlZFF1ZXVlLmJpbmQodGhpcyk7XG4gICAgKHRoaXM6IGFueSkuaW52b2tlQ2FsbGJhY2tBbmRSZXR1cm5GbHVzaGVkUXVldWUgPSB0aGlzLmludm9rZUNhbGxiYWNrQW5kUmV0dXJuRmx1c2hlZFF1ZXVlLmJpbmQoXG4gICAgICB0aGlzLFxuICAgICk7XG4gIH1cblxuICAvKipcbiAgICogUHVibGljIEFQSXNcbiAgICovXG5cbiAgc3RhdGljIHNweShzcHlPclRvZ2dsZTogYm9vbGVhbiB8ICgoZGF0YTogU3B5RGF0YSkgPT4gdm9pZCkpIHtcbiAgICBpZiAoc3B5T3JUb2dnbGUgPT09IHRydWUpIHtcbiAgICAgIE1lc3NhZ2VRdWV1ZS5wcm90b3R5cGUuX19zcHkgPSBpbmZvID0+IHtcbiAgICAgICAgY29uc29sZS5sb2coXG4gICAgICAgICAgYCR7aW5mby50eXBlID09PSBUT19KUyA/ICdOLT5KUycgOiAnSlMtPk4nfSA6IGAgK1xuICAgICAgICAgICAgYCR7aW5mby5tb2R1bGUgPyBpbmZvLm1vZHVsZSArICcuJyA6ICcnfSR7aW5mby5tZXRob2R9YCArXG4gICAgICAgICAgICBgKCR7SlNPTi5zdHJpbmdpZnkoaW5mby5hcmdzKX0pYCxcbiAgICAgICAgKTtcbiAgICAgIH07XG4gICAgfSBlbHNlIGlmIChzcHlPclRvZ2dsZSA9PT0gZmFsc2UpIHtcbiAgICAgIE1lc3NhZ2VRdWV1ZS5wcm90b3R5cGUuX19zcHkgPSBudWxsO1xuICAgIH0gZWxzZSB7XG4gICAgICBNZXNzYWdlUXVldWUucHJvdG90eXBlLl9fc3B5ID0gc3B5T3JUb2dnbGU7XG4gICAgfVxuICB9XG5cbiAgY2FsbEZ1bmN0aW9uUmV0dXJuRmx1c2hlZFF1ZXVlKG1vZHVsZTogc3RyaW5nLCBtZXRob2Q6IHN0cmluZywgYXJnczogYW55W10pIHtcbiAgICB0aGlzLl9fZ3VhcmQoKCkgPT4ge1xuICAgICAgdGhpcy5fX2NhbGxGdW5jdGlvbihtb2R1bGUsIG1ldGhvZCwgYXJncyk7XG4gICAgfSk7XG5cbiAgICByZXR1cm4gdGhpcy5mbHVzaGVkUXVldWUoKTtcbiAgfVxuXG4gIGNhbGxGdW5jdGlvblJldHVyblJlc3VsdEFuZEZsdXNoZWRRdWV1ZShcbiAgICBtb2R1bGU6IHN0cmluZyxcbiAgICBtZXRob2Q6IHN0cmluZyxcbiAgICBhcmdzOiBhbnlbXSxcbiAgKSB7XG4gICAgbGV0IHJlc3VsdDtcbiAgICB0aGlzLl9fZ3VhcmQoKCkgPT4ge1xuICAgICAgcmVzdWx0ID0gdGhpcy5fX2NhbGxGdW5jdGlvbihtb2R1bGUsIG1ldGhvZCwgYXJncyk7XG4gICAgfSk7XG5cbiAgICByZXR1cm4gW3Jlc3VsdCwgdGhpcy5mbHVzaGVkUXVldWUoKV07XG4gIH1cblxuICBpbnZva2VDYWxsYmFja0FuZFJldHVybkZsdXNoZWRRdWV1ZShjYklEOiBudW1iZXIsIGFyZ3M6IGFueVtdKSB7XG4gICAgdGhpcy5fX2d1YXJkKCgpID0+IHtcbiAgICAgIHRoaXMuX19pbnZva2VDYWxsYmFjayhjYklELCBhcmdzKTtcbiAgICB9KTtcblxuICAgIHJldHVybiB0aGlzLmZsdXNoZWRRdWV1ZSgpO1xuICB9XG5cbiAgZmx1c2hlZFF1ZXVlKCkge1xuICAgIHRoaXMuX19ndWFyZCgoKSA9PiB7XG4gICAgICB0aGlzLl9fY2FsbEltbWVkaWF0ZXMoKTtcbiAgICB9KTtcblxuICAgIGNvbnN0IHF1ZXVlID0gdGhpcy5fcXVldWU7XG4gICAgdGhpcy5fcXVldWUgPSBbW10sIFtdLCBbXSwgdGhpcy5fY2FsbElEXTtcbiAgICByZXR1cm4gcXVldWVbMF0ubGVuZ3RoID8gcXVldWUgOiBudWxsO1xuICB9XG5cbiAgZ2V0RXZlbnRMb29wUnVubmluZ1RpbWUoKSB7XG4gICAgcmV0dXJuIERhdGUubm93KCkgLSB0aGlzLl9ldmVudExvb3BTdGFydFRpbWU7XG4gIH1cblxuICByZWdpc3RlckNhbGxhYmxlTW9kdWxlKG5hbWU6IHN0cmluZywgbW9kdWxlOiBPYmplY3QpIHtcbiAgICB0aGlzLl9sYXp5Q2FsbGFibGVNb2R1bGVzW25hbWVdID0gKCkgPT4gbW9kdWxlO1xuICB9XG5cbiAgcmVnaXN0ZXJMYXp5Q2FsbGFibGVNb2R1bGUobmFtZTogc3RyaW5nLCBmYWN0b3J5OiB2b2lkID0+IE9iamVjdCkge1xuICAgIGxldCBtb2R1bGU6IE9iamVjdDtcbiAgICBsZXQgZ2V0VmFsdWU6ID8odm9pZCkgPT4gT2JqZWN0ID0gZmFjdG9yeTtcbiAgICB0aGlzLl9sYXp5Q2FsbGFibGVNb2R1bGVzW25hbWVdID0gKCkgPT4ge1xuICAgICAgaWYgKGdldFZhbHVlKSB7XG4gICAgICAgIG1vZHVsZSA9IGdldFZhbHVlKCk7XG4gICAgICAgIGdldFZhbHVlID0gbnVsbDtcbiAgICAgIH1cbiAgICAgIHJldHVybiBtb2R1bGU7XG4gICAgfTtcbiAgfVxuXG4gIGdldENhbGxhYmxlTW9kdWxlKG5hbWU6IHN0cmluZykge1xuICAgIGNvbnN0IGdldFZhbHVlID0gdGhpcy5fbGF6eUNhbGxhYmxlTW9kdWxlc1tuYW1lXTtcbiAgICByZXR1cm4gZ2V0VmFsdWUgPyBnZXRWYWx1ZSgpIDogbnVsbDtcbiAgfVxuXG4gIGVucXVldWVOYXRpdmVDYWxsKFxuICAgIG1vZHVsZUlEOiBudW1iZXIsXG4gICAgbWV0aG9kSUQ6IG51bWJlcixcbiAgICBwYXJhbXM6IGFueVtdLFxuICAgIG9uRmFpbDogP0Z1bmN0aW9uLFxuICAgIG9uU3VjYzogP0Z1bmN0aW9uLFxuICApIHtcbiAgICBpZiAob25GYWlsIHx8IG9uU3VjYykge1xuICAgICAgaWYgKF9fREVWX18pIHtcbiAgICAgICAgdGhpcy5fZGVidWdJbmZvW3RoaXMuX2NhbGxJRF0gPSBbbW9kdWxlSUQsIG1ldGhvZElEXTtcbiAgICAgICAgaWYgKHRoaXMuX2NhbGxJRCA+IERFQlVHX0lORk9fTElNSVQpIHtcbiAgICAgICAgICBkZWxldGUgdGhpcy5fZGVidWdJbmZvW3RoaXMuX2NhbGxJRCAtIERFQlVHX0lORk9fTElNSVRdO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICAvLyBFbmNvZGUgY2FsbElEcyBpbnRvIHBhaXJzIG9mIGNhbGxiYWNrIGlkZW50aWZpZXJzIGJ5IHNoaWZ0aW5nIGxlZnQgYW5kIHVzaW5nIHRoZSByaWdodG1vc3QgYml0XG4gICAgICAvLyB0byBpbmRpY2F0ZSBmYWlsICgwKSBvciBzdWNjZXNzICgxKVxuICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLWJpdHdpc2VcbiAgICAgIG9uRmFpbCAmJiBwYXJhbXMucHVzaCh0aGlzLl9jYWxsSUQgPDwgMSk7XG4gICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tYml0d2lzZVxuICAgICAgb25TdWNjICYmIHBhcmFtcy5wdXNoKCh0aGlzLl9jYWxsSUQgPDwgMSkgfCAxKTtcbiAgICAgIHRoaXMuX3N1Y2Nlc3NDYWxsYmFja3NbdGhpcy5fY2FsbElEXSA9IG9uU3VjYztcbiAgICAgIHRoaXMuX2ZhaWx1cmVDYWxsYmFja3NbdGhpcy5fY2FsbElEXSA9IG9uRmFpbDtcbiAgICB9XG5cbiAgICBpZiAoX19ERVZfXykge1xuICAgICAgZ2xvYmFsLm5hdGl2ZVRyYWNlQmVnaW5Bc3luY0Zsb3cgJiZcbiAgICAgICAgZ2xvYmFsLm5hdGl2ZVRyYWNlQmVnaW5Bc3luY0Zsb3coXG4gICAgICAgICAgVFJBQ0VfVEFHX1JFQUNUX0FQUFMsXG4gICAgICAgICAgJ25hdGl2ZScsXG4gICAgICAgICAgdGhpcy5fY2FsbElELFxuICAgICAgICApO1xuICAgIH1cbiAgICB0aGlzLl9jYWxsSUQrKztcblxuICAgIHRoaXMuX3F1ZXVlW01PRFVMRV9JRFNdLnB1c2gobW9kdWxlSUQpO1xuICAgIHRoaXMuX3F1ZXVlW01FVEhPRF9JRFNdLnB1c2gobWV0aG9kSUQpO1xuXG4gICAgaWYgKF9fREVWX18pIHtcbiAgICAgIC8vIFZhbGlkYXRlIHRoYXQgcGFyYW1ldGVycyBwYXNzZWQgb3ZlciB0aGUgYnJpZGdlIGFyZVxuICAgICAgLy8gZm9sbHktY29udmVydGlibGUuICBBcyBhIHNwZWNpYWwgY2FzZSwgaWYgYSBwcm9wIHZhbHVlIGlzIGFcbiAgICAgIC8vIGZ1bmN0aW9uIGl0IGlzIHBlcm1pdHRlZCBoZXJlLCBhbmQgc3BlY2lhbC1jYXNlZCBpbiB0aGVcbiAgICAgIC8vIGNvbnZlcnNpb24uXG4gICAgICBjb25zdCBpc1ZhbGlkQXJndW1lbnQgPSB2YWwgPT4ge1xuICAgICAgICBjb25zdCB0ID0gdHlwZW9mIHZhbDtcbiAgICAgICAgaWYgKFxuICAgICAgICAgIHQgPT09ICd1bmRlZmluZWQnIHx8XG4gICAgICAgICAgdCA9PT0gJ251bGwnIHx8XG4gICAgICAgICAgdCA9PT0gJ2Jvb2xlYW4nIHx8XG4gICAgICAgICAgdCA9PT0gJ251bWJlcicgfHxcbiAgICAgICAgICB0ID09PSAnc3RyaW5nJ1xuICAgICAgICApIHtcbiAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodCA9PT0gJ2Z1bmN0aW9uJyB8fCB0ICE9PSAnb2JqZWN0Jykge1xuICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoQXJyYXkuaXNBcnJheSh2YWwpKSB7XG4gICAgICAgICAgcmV0dXJuIHZhbC5ldmVyeShpc1ZhbGlkQXJndW1lbnQpO1xuICAgICAgICB9XG4gICAgICAgIGZvciAoY29uc3QgayBpbiB2YWwpIHtcbiAgICAgICAgICBpZiAodHlwZW9mIHZhbFtrXSAhPT0gJ2Z1bmN0aW9uJyAmJiAhaXNWYWxpZEFyZ3VtZW50KHZhbFtrXSkpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9O1xuXG4gICAgICBpbnZhcmlhbnQoXG4gICAgICAgIGlzVmFsaWRBcmd1bWVudChwYXJhbXMpLFxuICAgICAgICAnJXMgaXMgbm90IHVzYWJsZSBhcyBhIG5hdGl2ZSBtZXRob2QgYXJndW1lbnQnLFxuICAgICAgICBwYXJhbXMsXG4gICAgICApO1xuXG4gICAgICAvLyBUaGUgcGFyYW1zIG9iamVjdCBzaG91bGQgbm90IGJlIG11dGF0ZWQgYWZ0ZXIgYmVpbmcgcXVldWVkXG4gICAgICBkZWVwRnJlZXplQW5kVGhyb3dPbk11dGF0aW9uSW5EZXYoKHBhcmFtczogYW55KSk7XG4gICAgfVxuICAgIHRoaXMuX3F1ZXVlW1BBUkFNU10ucHVzaChwYXJhbXMpO1xuXG4gICAgY29uc3Qgbm93ID0gRGF0ZS5ub3coKTtcbiAgICBpZiAoXG4gICAgICBnbG9iYWwubmF0aXZlRmx1c2hRdWV1ZUltbWVkaWF0ZSAmJlxuICAgICAgbm93IC0gdGhpcy5fbGFzdEZsdXNoID49IE1JTl9USU1FX0JFVFdFRU5fRkxVU0hFU19NU1xuICAgICkge1xuICAgICAgY29uc3QgcXVldWUgPSB0aGlzLl9xdWV1ZTtcbiAgICAgIHRoaXMuX3F1ZXVlID0gW1tdLCBbXSwgW10sIHRoaXMuX2NhbGxJRF07XG4gICAgICB0aGlzLl9sYXN0Rmx1c2ggPSBub3c7XG4gICAgICBnbG9iYWwubmF0aXZlRmx1c2hRdWV1ZUltbWVkaWF0ZShxdWV1ZSk7XG4gICAgfVxuICAgIFN5c3RyYWNlLmNvdW50ZXJFdmVudCgncGVuZGluZ19qc190b19uYXRpdmVfcXVldWUnLCB0aGlzLl9xdWV1ZVswXS5sZW5ndGgpO1xuICAgIGlmIChfX0RFVl9fICYmIHRoaXMuX19zcHkgJiYgaXNGaW5pdGUobW9kdWxlSUQpKSB7XG4gICAgICB0aGlzLl9fc3B5KHtcbiAgICAgICAgdHlwZTogVE9fTkFUSVZFLFxuICAgICAgICBtb2R1bGU6IHRoaXMuX3JlbW90ZU1vZHVsZVRhYmxlW21vZHVsZUlEXSxcbiAgICAgICAgbWV0aG9kOiB0aGlzLl9yZW1vdGVNZXRob2RUYWJsZVttb2R1bGVJRF1bbWV0aG9kSURdLFxuICAgICAgICBhcmdzOiBwYXJhbXMsXG4gICAgICB9KTtcbiAgICB9IGVsc2UgaWYgKHRoaXMuX19zcHkpIHtcbiAgICAgIHRoaXMuX19zcHkoe1xuICAgICAgICB0eXBlOiBUT19OQVRJVkUsXG4gICAgICAgIG1vZHVsZTogbW9kdWxlSUQgKyAnJyxcbiAgICAgICAgbWV0aG9kOiBtZXRob2RJRCxcbiAgICAgICAgYXJnczogcGFyYW1zLFxuICAgICAgfSk7XG4gICAgfVxuICB9XG5cbiAgY3JlYXRlRGVidWdMb29rdXAobW9kdWxlSUQ6IG51bWJlciwgbmFtZTogc3RyaW5nLCBtZXRob2RzOiBzdHJpbmdbXSkge1xuICAgIGlmIChfX0RFVl9fKSB7XG4gICAgICB0aGlzLl9yZW1vdGVNb2R1bGVUYWJsZVttb2R1bGVJRF0gPSBuYW1lO1xuICAgICAgdGhpcy5fcmVtb3RlTWV0aG9kVGFibGVbbW9kdWxlSURdID0gbWV0aG9kcztcbiAgICB9XG4gIH1cblxuICAvLyBGb3IgSlNUaW1lcnMgdG8gcmVnaXN0ZXIgaXRzIGNhbGxiYWNrLiBPdGhlcndpc2UgYSBjaXJjdWxhciBkZXBlbmRlbmN5XG4gIC8vIGJldHdlZW4gbW9kdWxlcyBpcyBpbnRyb2R1Y2VkLiBOb3RlIHRoYXQgb25seSBvbmUgY2FsbGJhY2sgbWF5IGJlXG4gIC8vIHJlZ2lzdGVyZWQgYXQgYSB0aW1lLlxuICBzZXRJbW1lZGlhdGVzQ2FsbGJhY2soZm46ICgpID0+IHZvaWQpIHtcbiAgICB0aGlzLl9pbW1lZGlhdGVzQ2FsbGJhY2sgPSBmbjtcbiAgfVxuXG4gIC8qKlxuICAgKiBQcml2YXRlIG1ldGhvZHNcbiAgICovXG5cbiAgX19ndWFyZChmbjogKCkgPT4gdm9pZCkge1xuICAgIGlmICh0aGlzLl9fc2hvdWxkUGF1c2VPblRocm93KCkpIHtcbiAgICAgIGZuKCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIGZuKCk7XG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBFcnJvclV0aWxzLnJlcG9ydEZhdGFsRXJyb3IoZXJyb3IpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8vIE1lc3NhZ2VRdWV1ZSBpbnN0YWxscyBhIGdsb2JhbCBoYW5kbGVyIHRvIGNhdGNoIGFsbCBleGNlcHRpb25zIHdoZXJlIEpTIHVzZXJzIGNhbiByZWdpc3RlciB0aGVpciBvd24gYmVoYXZpb3JcbiAgLy8gVGhpcyBoYW5kbGVyIG1ha2VzIGFsbCBleGNlcHRpb25zIHRvIGJlIHByb3BhZ2F0ZWQgZnJvbSBpbnNpZGUgTWVzc2FnZVF1ZXVlIHJhdGhlciB0aGFuIGJ5IHRoZSBWTSBhdCB0aGVpciBvcmlnaW5cbiAgLy8gVGhpcyBtYWtlcyBzdGFja3RyYWNlcyB0byBiZSBwbGFjZWQgYXQgTWVzc2FnZVF1ZXVlIHJhdGhlciB0aGFuIGF0IHdoZXJlIHRoZXkgd2VyZSBsYXVuY2hlZFxuICAvLyBUaGUgcGFyYW1ldGVyIERlYnVnZ2VySW50ZXJuYWwuc2hvdWxkUGF1c2VPblRocm93IGlzIHVzZWQgdG8gY2hlY2sgYmVmb3JlIGNhdGNoaW5nIGFsbCBleGNlcHRpb25zIGFuZFxuICAvLyBjYW4gYmUgY29uZmlndXJlZCBieSB0aGUgVk0gb3IgYW55IEluc3BlY3RvclxuICBfX3Nob3VsZFBhdXNlT25UaHJvdygpIHtcbiAgICByZXR1cm4gKFxuICAgICAgLy8gJEZsb3dGaXhNZVxuICAgICAgdHlwZW9mIERlYnVnZ2VySW50ZXJuYWwgIT09ICd1bmRlZmluZWQnICYmXG4gICAgICBEZWJ1Z2dlckludGVybmFsLnNob3VsZFBhdXNlT25UaHJvdyA9PT0gdHJ1ZSAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLXVuZGVmXG4gICAgKTtcbiAgfVxuXG4gIF9fY2FsbEltbWVkaWF0ZXMoKSB7XG4gICAgU3lzdHJhY2UuYmVnaW5FdmVudCgnSlNUaW1lcnMuY2FsbEltbWVkaWF0ZXMoKScpO1xuICAgIGlmICh0aGlzLl9pbW1lZGlhdGVzQ2FsbGJhY2sgIT0gbnVsbCkge1xuICAgICAgdGhpcy5faW1tZWRpYXRlc0NhbGxiYWNrKCk7XG4gICAgfVxuICAgIFN5c3RyYWNlLmVuZEV2ZW50KCk7XG4gIH1cblxuICBfX2NhbGxGdW5jdGlvbihtb2R1bGU6IHN0cmluZywgbWV0aG9kOiBzdHJpbmcsIGFyZ3M6IGFueVtdKTogYW55IHtcbiAgICB0aGlzLl9sYXN0Rmx1c2ggPSBEYXRlLm5vdygpO1xuICAgIHRoaXMuX2V2ZW50TG9vcFN0YXJ0VGltZSA9IHRoaXMuX2xhc3RGbHVzaDtcbiAgICBpZiAoX19ERVZfXyB8fCB0aGlzLl9fc3B5KSB7XG4gICAgICBTeXN0cmFjZS5iZWdpbkV2ZW50KGAke21vZHVsZX0uJHttZXRob2R9KCR7c3RyaW5naWZ5U2FmZShhcmdzKX0pYCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIFN5c3RyYWNlLmJlZ2luRXZlbnQoYCR7bW9kdWxlfS4ke21ldGhvZH0oLi4uKWApO1xuICAgIH1cbiAgICBpZiAodGhpcy5fX3NweSkge1xuICAgICAgdGhpcy5fX3NweSh7dHlwZTogVE9fSlMsIG1vZHVsZSwgbWV0aG9kLCBhcmdzfSk7XG4gICAgfVxuICAgIGNvbnN0IG1vZHVsZU1ldGhvZHMgPSB0aGlzLmdldENhbGxhYmxlTW9kdWxlKG1vZHVsZSk7XG4gICAgaW52YXJpYW50KFxuICAgICAgISFtb2R1bGVNZXRob2RzLFxuICAgICAgJ01vZHVsZSAlcyBpcyBub3QgYSByZWdpc3RlcmVkIGNhbGxhYmxlIG1vZHVsZSAoY2FsbGluZyAlcyknLFxuICAgICAgbW9kdWxlLFxuICAgICAgbWV0aG9kLFxuICAgICk7XG4gICAgaW52YXJpYW50KFxuICAgICAgISFtb2R1bGVNZXRob2RzW21ldGhvZF0sXG4gICAgICAnTWV0aG9kICVzIGRvZXMgbm90IGV4aXN0IG9uIG1vZHVsZSAlcycsXG4gICAgICBtZXRob2QsXG4gICAgICBtb2R1bGUsXG4gICAgKTtcbiAgICBjb25zdCByZXN1bHQgPSBtb2R1bGVNZXRob2RzW21ldGhvZF0uYXBwbHkobW9kdWxlTWV0aG9kcywgYXJncyk7XG4gICAgU3lzdHJhY2UuZW5kRXZlbnQoKTtcbiAgICByZXR1cm4gcmVzdWx0O1xuICB9XG5cbiAgX19pbnZva2VDYWxsYmFjayhjYklEOiBudW1iZXIsIGFyZ3M6IGFueVtdKSB7XG4gICAgdGhpcy5fbGFzdEZsdXNoID0gRGF0ZS5ub3coKTtcbiAgICB0aGlzLl9ldmVudExvb3BTdGFydFRpbWUgPSB0aGlzLl9sYXN0Rmx1c2g7XG5cbiAgICAvLyBUaGUgcmlnaHRtb3N0IGJpdCBvZiBjYklEIGluZGljYXRlcyBmYWlsICgwKSBvciBzdWNjZXNzICgxKSwgdGhlIG90aGVyIGJpdHMgYXJlIHRoZSBjYWxsSUQgc2hpZnRlZCBsZWZ0LlxuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1iaXR3aXNlXG4gICAgY29uc3QgY2FsbElEID0gY2JJRCA+Pj4gMTtcbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tYml0d2lzZVxuICAgIGNvbnN0IGlzU3VjY2VzcyA9IGNiSUQgJiAxO1xuICAgIGNvbnN0IGNhbGxiYWNrID0gaXNTdWNjZXNzXG4gICAgICA/IHRoaXMuX3N1Y2Nlc3NDYWxsYmFja3NbY2FsbElEXVxuICAgICAgOiB0aGlzLl9mYWlsdXJlQ2FsbGJhY2tzW2NhbGxJRF07XG5cbiAgICBpZiAoX19ERVZfXykge1xuICAgICAgY29uc3QgZGVidWcgPSB0aGlzLl9kZWJ1Z0luZm9bY2FsbElEXTtcbiAgICAgIGNvbnN0IG1vZHVsZSA9IGRlYnVnICYmIHRoaXMuX3JlbW90ZU1vZHVsZVRhYmxlW2RlYnVnWzBdXTtcbiAgICAgIGNvbnN0IG1ldGhvZCA9IGRlYnVnICYmIHRoaXMuX3JlbW90ZU1ldGhvZFRhYmxlW2RlYnVnWzBdXVtkZWJ1Z1sxXV07XG4gICAgICBpZiAoIWNhbGxiYWNrKSB7XG4gICAgICAgIGxldCBlcnJvck1lc3NhZ2UgPSBgQ2FsbGJhY2sgd2l0aCBpZCAke2NiSUR9OiAke21vZHVsZX0uJHttZXRob2R9KCkgbm90IGZvdW5kYDtcbiAgICAgICAgaWYgKG1ldGhvZCkge1xuICAgICAgICAgIGVycm9yTWVzc2FnZSA9XG4gICAgICAgICAgICBgVGhlIGNhbGxiYWNrICR7bWV0aG9kfSgpIGV4aXN0cyBpbiBtb2R1bGUgJHttb2R1bGV9LCBgICtcbiAgICAgICAgICAgICdidXQgb25seSBvbmUgY2FsbGJhY2sgbWF5IGJlIHJlZ2lzdGVyZWQgdG8gYSBmdW5jdGlvbiBpbiBhIG5hdGl2ZSBtb2R1bGUuJztcbiAgICAgICAgfVxuICAgICAgICBpbnZhcmlhbnQoY2FsbGJhY2ssIGVycm9yTWVzc2FnZSk7XG4gICAgICB9XG4gICAgICBjb25zdCBwcm9maWxlTmFtZSA9IGRlYnVnXG4gICAgICAgID8gJzxjYWxsYmFjayBmb3IgJyArIG1vZHVsZSArICcuJyArIG1ldGhvZCArICc+J1xuICAgICAgICA6IGNiSUQ7XG4gICAgICBpZiAoY2FsbGJhY2sgJiYgdGhpcy5fX3NweSkge1xuICAgICAgICB0aGlzLl9fc3B5KHt0eXBlOiBUT19KUywgbW9kdWxlOiBudWxsLCBtZXRob2Q6IHByb2ZpbGVOYW1lLCBhcmdzfSk7XG4gICAgICB9XG4gICAgICBTeXN0cmFjZS5iZWdpbkV2ZW50KFxuICAgICAgICBgTWVzc2FnZVF1ZXVlLmludm9rZUNhbGxiYWNrKCR7cHJvZmlsZU5hbWV9LCAke3N0cmluZ2lmeVNhZmUoYXJncyl9KWAsXG4gICAgICApO1xuICAgIH1cblxuICAgIGlmICghY2FsbGJhY2spIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBkZWxldGUgdGhpcy5fc3VjY2Vzc0NhbGxiYWNrc1tjYWxsSURdO1xuICAgIGRlbGV0ZSB0aGlzLl9mYWlsdXJlQ2FsbGJhY2tzW2NhbGxJRF07XG4gICAgY2FsbGJhY2soLi4uYXJncyk7XG5cbiAgICBpZiAoX19ERVZfXykge1xuICAgICAgU3lzdHJhY2UuZW5kRXZlbnQoKTtcbiAgICB9XG4gIH1cbn1cblxubW9kdWxlLmV4cG9ydHMgPSBNZXNzYWdlUXVldWU7XG4iXX0=