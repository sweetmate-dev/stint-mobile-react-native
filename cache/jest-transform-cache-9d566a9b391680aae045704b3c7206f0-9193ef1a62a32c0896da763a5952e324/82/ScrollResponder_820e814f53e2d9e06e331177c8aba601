f255a6ccbb75ebe0bb0fca5557cdc8da










'use strict';

var Dimensions = require('Dimensions');
var FrameRateLogger = require('FrameRateLogger');
var Keyboard = require('Keyboard');
var ReactNative = require('ReactNative');
var Subscribable = require('Subscribable');
var TextInputState = require('TextInputState');
var UIManager = require('UIManager');

var invariant = require('fbjs/lib/invariant');
var nullthrows = require('fbjs/lib/nullthrows');
var performanceNow = require('fbjs/lib/performanceNow');
var warning = require('fbjs/lib/warning');var _require =

require('NativeModules'),ScrollViewManager = _require.ScrollViewManager;















































































var IS_ANIMATING_TOUCH_START_THRESHOLD_MS = 16;










var ScrollResponderMixin = {
  mixins: [Subscribable.Mixin],
  scrollResponderMixinGetInitialState: function scrollResponderMixinGetInitialState() {
    return {
      isTouching: false,
      lastMomentumScrollBeginTime: 0,
      lastMomentumScrollEndTime: 0,






      observedScrollSinceBecomingResponder: false,
      becameResponderWhileAnimating: false };

  },




  scrollResponderHandleScrollShouldSetResponder: function scrollResponderHandleScrollShouldSetResponder() {
    return this.state.isTouching;
  },


























  scrollResponderHandleStartShouldSetResponder: function scrollResponderHandleStartShouldSetResponder(e) {
    var currentlyFocusedTextInput = TextInputState.currentlyFocusedField();

    if (
    this.props.keyboardShouldPersistTaps === 'handled' &&
    currentlyFocusedTextInput != null &&
    e.target !== currentlyFocusedTextInput)
    {
      return true;
    }
    return false;
  },












  scrollResponderHandleStartShouldSetResponderCapture: function scrollResponderHandleStartShouldSetResponderCapture(
  e)
  {


    if (this.scrollResponderIsAnimating()) {
      return true;
    }





    var currentlyFocusedTextInput = TextInputState.currentlyFocusedField();var
    keyboardShouldPersistTaps = this.props.keyboardShouldPersistTaps;
    var keyboardNeverPersistTaps =
    !keyboardShouldPersistTaps || keyboardShouldPersistTaps === 'never';
    if (
    keyboardNeverPersistTaps &&
    currentlyFocusedTextInput != null &&
    !TextInputState.isTextInput(e.target))
    {
      return true;
    }

    return false;
  },











  scrollResponderHandleResponderReject: function scrollResponderHandleResponderReject() {},
















  scrollResponderHandleTerminationRequest: function scrollResponderHandleTerminationRequest() {
    return !this.state.observedScrollSinceBecomingResponder;
  },






  scrollResponderHandleTouchEnd: function scrollResponderHandleTouchEnd(e) {
    var nativeEvent = e.nativeEvent;
    this.state.isTouching = nativeEvent.touches.length !== 0;
    this.props.onTouchEnd && this.props.onTouchEnd(e);
  },






  scrollResponderHandleTouchCancel: function scrollResponderHandleTouchCancel(e) {
    this.state.isTouching = false;
    this.props.onTouchCancel && this.props.onTouchCancel(e);
  },




  scrollResponderHandleResponderRelease: function scrollResponderHandleResponderRelease(e) {
    this.props.onResponderRelease && this.props.onResponderRelease(e);



    var currentlyFocusedTextInput = TextInputState.currentlyFocusedField();
    if (
    this.props.keyboardShouldPersistTaps !== true &&
    this.props.keyboardShouldPersistTaps !== 'always' &&
    currentlyFocusedTextInput != null &&
    e.target !== currentlyFocusedTextInput &&
    !this.state.observedScrollSinceBecomingResponder &&
    !this.state.becameResponderWhileAnimating)
    {
      this.props.onScrollResponderKeyboardDismissed &&
      this.props.onScrollResponderKeyboardDismissed(e);
      TextInputState.blurTextInput(currentlyFocusedTextInput);
    }
  },

  scrollResponderHandleScroll: function scrollResponderHandleScroll(e) {
    this.state.observedScrollSinceBecomingResponder = true;
    this.props.onScroll && this.props.onScroll(e);
  },




  scrollResponderHandleResponderGrant: function scrollResponderHandleResponderGrant(e) {
    this.state.observedScrollSinceBecomingResponder = false;
    this.props.onResponderGrant && this.props.onResponderGrant(e);
    this.state.becameResponderWhileAnimating = this.scrollResponderIsAnimating();
  },








  scrollResponderHandleScrollBeginDrag: function scrollResponderHandleScrollBeginDrag(e) {
    FrameRateLogger.beginScroll();
    this.props.onScrollBeginDrag && this.props.onScrollBeginDrag(e);
  },




  scrollResponderHandleScrollEndDrag: function scrollResponderHandleScrollEndDrag(e) {var
    velocity = e.nativeEvent.velocity;





    if (
    !this.scrollResponderIsAnimating() && (
    !velocity || velocity.x === 0 && velocity.y === 0))
    {
      FrameRateLogger.endScroll();
    }
    this.props.onScrollEndDrag && this.props.onScrollEndDrag(e);
  },




  scrollResponderHandleMomentumScrollBegin: function scrollResponderHandleMomentumScrollBegin(e) {
    this.state.lastMomentumScrollBeginTime = performanceNow();
    this.props.onMomentumScrollBegin && this.props.onMomentumScrollBegin(e);
  },




  scrollResponderHandleMomentumScrollEnd: function scrollResponderHandleMomentumScrollEnd(e) {
    FrameRateLogger.endScroll();
    this.state.lastMomentumScrollEndTime = performanceNow();
    this.props.onMomentumScrollEnd && this.props.onMomentumScrollEnd(e);
  },












  scrollResponderHandleTouchStart: function scrollResponderHandleTouchStart(e) {
    this.state.isTouching = true;
    this.props.onTouchStart && this.props.onTouchStart(e);
  },












  scrollResponderHandleTouchMove: function scrollResponderHandleTouchMove(e) {
    this.props.onTouchMove && this.props.onTouchMove(e);
  },






  scrollResponderIsAnimating: function scrollResponderIsAnimating() {
    var now = performanceNow();
    var timeSinceLastMomentumScrollEnd =
    now - this.state.lastMomentumScrollEndTime;
    var isAnimating =
    timeSinceLastMomentumScrollEnd < IS_ANIMATING_TOUCH_START_THRESHOLD_MS ||
    this.state.lastMomentumScrollEndTime <
    this.state.lastMomentumScrollBeginTime;
    return isAnimating;
  },






  scrollResponderGetScrollableNode: function scrollResponderGetScrollableNode() {
    return this.getScrollableNode ?
    this.getScrollableNode() :
    ReactNative.findNodeHandle(this);
  },












  scrollResponderScrollTo: function scrollResponderScrollTo(
  x,
  y,
  animated)
  {
    if (typeof x === 'number') {
      console.warn(
      '`scrollResponderScrollTo(x, y, animated)` is deprecated. Use `scrollResponderScrollTo({x: 5, y: 5, animated: true})` instead.');

    } else {var _ref =
      x || {};x = _ref.x;y = _ref.y;animated = _ref.animated;
    }
    UIManager.dispatchViewManagerCommand(
    nullthrows(this.scrollResponderGetScrollableNode()),
    UIManager.RCTScrollView.Commands.scrollTo,
    [x || 0, y || 0, animated !== false]);

  },









  scrollResponderScrollToEnd: function scrollResponderScrollToEnd(options) {

    var animated = (options && options.animated) !== false;
    UIManager.dispatchViewManagerCommand(
    this.scrollResponderGetScrollableNode(),
    UIManager.RCTScrollView.Commands.scrollToEnd,
    [animated]);

  },




  scrollResponderScrollWithoutAnimationTo: function scrollResponderScrollWithoutAnimationTo(
  offsetX,
  offsetY)
  {
    console.warn(
    '`scrollResponderScrollWithoutAnimationTo` is deprecated. Use `scrollResponderScrollTo` instead');

    this.scrollResponderScrollTo({ x: offsetX, y: offsetY, animated: false });
  },







  scrollResponderZoomTo: function scrollResponderZoomTo(
  rect,






  animated)
  {
    invariant(
    ScrollViewManager && ScrollViewManager.zoomToRect,
    'zoomToRect is not implemented');

    if ('animated' in rect) {
      animated = rect.animated;
      delete rect.animated;
    } else if (typeof animated !== 'undefined') {
      console.warn(
      '`scrollResponderZoomTo` `animated` argument is deprecated. Use `options.animated` instead');

    }
    ScrollViewManager.zoomToRect(
    this.scrollResponderGetScrollableNode(),
    rect,
    animated !== false);

  },




  scrollResponderFlashScrollIndicators: function scrollResponderFlashScrollIndicators() {
    UIManager.dispatchViewManagerCommand(
    this.scrollResponderGetScrollableNode(),
    UIManager.RCTScrollView.Commands.flashScrollIndicators,
    []);

  },











  scrollResponderScrollNativeHandleToKeyboard: function scrollResponderScrollNativeHandleToKeyboard(
  nodeHandle,
  additionalOffset,
  preventNegativeScrollOffset)
  {
    this.additionalScrollOffset = additionalOffset || 0;
    this.preventNegativeScrollOffset = !!preventNegativeScrollOffset;
    UIManager.measureLayout(
    nodeHandle,
    ReactNative.findNodeHandle(this.getInnerViewNode()),
    this.scrollResponderTextInputFocusError,
    this.scrollResponderInputMeasureAndScrollToKeyboard);

  },











  scrollResponderInputMeasureAndScrollToKeyboard: function scrollResponderInputMeasureAndScrollToKeyboard(
  left,
  top,
  width,
  height)
  {
    var keyboardScreenY = Dimensions.get('window').height;
    if (this.keyboardWillOpenTo) {
      keyboardScreenY = this.keyboardWillOpenTo.endCoordinates.screenY;
    }
    var scrollOffsetY =
    top - keyboardScreenY + height + this.additionalScrollOffset;





    if (this.preventNegativeScrollOffset) {
      scrollOffsetY = Math.max(0, scrollOffsetY);
    }
    this.scrollResponderScrollTo({ x: 0, y: scrollOffsetY, animated: true });

    this.additionalOffset = 0;
    this.preventNegativeScrollOffset = false;
  },

  scrollResponderTextInputFocusError: function scrollResponderTextInputFocusError(e) {
    console.error('Error measuring text field: ', e);
  },







  UNSAFE_componentWillMount: function UNSAFE_componentWillMount() {var
    keyboardShouldPersistTaps = this.props.keyboardShouldPersistTaps;
    warning(
    typeof keyboardShouldPersistTaps !== 'boolean',
    '\'keyboardShouldPersistTaps={' + keyboardShouldPersistTaps + '}\' is deprecated. ' + ('Use \'keyboardShouldPersistTaps="' + (

    keyboardShouldPersistTaps ? 'always' : 'never') + '"\' instead'));



    this.keyboardWillOpenTo = null;
    this.additionalScrollOffset = 0;
    this.addListenerOn(
    Keyboard,
    'keyboardWillShow',
    this.scrollResponderKeyboardWillShow);

    this.addListenerOn(
    Keyboard,
    'keyboardWillHide',
    this.scrollResponderKeyboardWillHide);

    this.addListenerOn(
    Keyboard,
    'keyboardDidShow',
    this.scrollResponderKeyboardDidShow);

    this.addListenerOn(
    Keyboard,
    'keyboardDidHide',
    this.scrollResponderKeyboardDidHide);

  },





























  scrollResponderKeyboardWillShow: function scrollResponderKeyboardWillShow(e) {
    this.keyboardWillOpenTo = e;
    this.props.onKeyboardWillShow && this.props.onKeyboardWillShow(e);
  },

  scrollResponderKeyboardWillHide: function scrollResponderKeyboardWillHide(e) {
    this.keyboardWillOpenTo = null;
    this.props.onKeyboardWillHide && this.props.onKeyboardWillHide(e);
  },

  scrollResponderKeyboardDidShow: function scrollResponderKeyboardDidShow(e) {


    if (e) {
      this.keyboardWillOpenTo = e;
    }
    this.props.onKeyboardDidShow && this.props.onKeyboardDidShow(e);
  },

  scrollResponderKeyboardDidHide: function scrollResponderKeyboardDidHide(e) {
    this.keyboardWillOpenTo = null;
    this.props.onKeyboardDidHide && this.props.onKeyboardDidHide(e);
  } };


var ScrollResponder = {
  Mixin: ScrollResponderMixin };


module.exports = ScrollResponder;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlNjcm9sbFJlc3BvbmRlci5qcyJdLCJuYW1lcyI6WyJEaW1lbnNpb25zIiwicmVxdWlyZSIsIkZyYW1lUmF0ZUxvZ2dlciIsIktleWJvYXJkIiwiUmVhY3ROYXRpdmUiLCJTdWJzY3JpYmFibGUiLCJUZXh0SW5wdXRTdGF0ZSIsIlVJTWFuYWdlciIsImludmFyaWFudCIsIm51bGx0aHJvd3MiLCJwZXJmb3JtYW5jZU5vdyIsIndhcm5pbmciLCJTY3JvbGxWaWV3TWFuYWdlciIsIklTX0FOSU1BVElOR19UT1VDSF9TVEFSVF9USFJFU0hPTERfTVMiLCJTY3JvbGxSZXNwb25kZXJNaXhpbiIsIm1peGlucyIsIk1peGluIiwic2Nyb2xsUmVzcG9uZGVyTWl4aW5HZXRJbml0aWFsU3RhdGUiLCJpc1RvdWNoaW5nIiwibGFzdE1vbWVudHVtU2Nyb2xsQmVnaW5UaW1lIiwibGFzdE1vbWVudHVtU2Nyb2xsRW5kVGltZSIsIm9ic2VydmVkU2Nyb2xsU2luY2VCZWNvbWluZ1Jlc3BvbmRlciIsImJlY2FtZVJlc3BvbmRlcldoaWxlQW5pbWF0aW5nIiwic2Nyb2xsUmVzcG9uZGVySGFuZGxlU2Nyb2xsU2hvdWxkU2V0UmVzcG9uZGVyIiwic3RhdGUiLCJzY3JvbGxSZXNwb25kZXJIYW5kbGVTdGFydFNob3VsZFNldFJlc3BvbmRlciIsImUiLCJjdXJyZW50bHlGb2N1c2VkVGV4dElucHV0IiwiY3VycmVudGx5Rm9jdXNlZEZpZWxkIiwicHJvcHMiLCJrZXlib2FyZFNob3VsZFBlcnNpc3RUYXBzIiwidGFyZ2V0Iiwic2Nyb2xsUmVzcG9uZGVySGFuZGxlU3RhcnRTaG91bGRTZXRSZXNwb25kZXJDYXB0dXJlIiwic2Nyb2xsUmVzcG9uZGVySXNBbmltYXRpbmciLCJrZXlib2FyZE5ldmVyUGVyc2lzdFRhcHMiLCJpc1RleHRJbnB1dCIsInNjcm9sbFJlc3BvbmRlckhhbmRsZVJlc3BvbmRlclJlamVjdCIsInNjcm9sbFJlc3BvbmRlckhhbmRsZVRlcm1pbmF0aW9uUmVxdWVzdCIsInNjcm9sbFJlc3BvbmRlckhhbmRsZVRvdWNoRW5kIiwibmF0aXZlRXZlbnQiLCJ0b3VjaGVzIiwibGVuZ3RoIiwib25Ub3VjaEVuZCIsInNjcm9sbFJlc3BvbmRlckhhbmRsZVRvdWNoQ2FuY2VsIiwib25Ub3VjaENhbmNlbCIsInNjcm9sbFJlc3BvbmRlckhhbmRsZVJlc3BvbmRlclJlbGVhc2UiLCJvblJlc3BvbmRlclJlbGVhc2UiLCJvblNjcm9sbFJlc3BvbmRlcktleWJvYXJkRGlzbWlzc2VkIiwiYmx1clRleHRJbnB1dCIsInNjcm9sbFJlc3BvbmRlckhhbmRsZVNjcm9sbCIsIm9uU2Nyb2xsIiwic2Nyb2xsUmVzcG9uZGVySGFuZGxlUmVzcG9uZGVyR3JhbnQiLCJvblJlc3BvbmRlckdyYW50Iiwic2Nyb2xsUmVzcG9uZGVySGFuZGxlU2Nyb2xsQmVnaW5EcmFnIiwiYmVnaW5TY3JvbGwiLCJvblNjcm9sbEJlZ2luRHJhZyIsInNjcm9sbFJlc3BvbmRlckhhbmRsZVNjcm9sbEVuZERyYWciLCJ2ZWxvY2l0eSIsIngiLCJ5IiwiZW5kU2Nyb2xsIiwib25TY3JvbGxFbmREcmFnIiwic2Nyb2xsUmVzcG9uZGVySGFuZGxlTW9tZW50dW1TY3JvbGxCZWdpbiIsIm9uTW9tZW50dW1TY3JvbGxCZWdpbiIsInNjcm9sbFJlc3BvbmRlckhhbmRsZU1vbWVudHVtU2Nyb2xsRW5kIiwib25Nb21lbnR1bVNjcm9sbEVuZCIsInNjcm9sbFJlc3BvbmRlckhhbmRsZVRvdWNoU3RhcnQiLCJvblRvdWNoU3RhcnQiLCJzY3JvbGxSZXNwb25kZXJIYW5kbGVUb3VjaE1vdmUiLCJvblRvdWNoTW92ZSIsIm5vdyIsInRpbWVTaW5jZUxhc3RNb21lbnR1bVNjcm9sbEVuZCIsImlzQW5pbWF0aW5nIiwic2Nyb2xsUmVzcG9uZGVyR2V0U2Nyb2xsYWJsZU5vZGUiLCJnZXRTY3JvbGxhYmxlTm9kZSIsImZpbmROb2RlSGFuZGxlIiwic2Nyb2xsUmVzcG9uZGVyU2Nyb2xsVG8iLCJhbmltYXRlZCIsImNvbnNvbGUiLCJ3YXJuIiwiZGlzcGF0Y2hWaWV3TWFuYWdlckNvbW1hbmQiLCJSQ1RTY3JvbGxWaWV3IiwiQ29tbWFuZHMiLCJzY3JvbGxUbyIsInNjcm9sbFJlc3BvbmRlclNjcm9sbFRvRW5kIiwib3B0aW9ucyIsInNjcm9sbFRvRW5kIiwic2Nyb2xsUmVzcG9uZGVyU2Nyb2xsV2l0aG91dEFuaW1hdGlvblRvIiwib2Zmc2V0WCIsIm9mZnNldFkiLCJzY3JvbGxSZXNwb25kZXJab29tVG8iLCJyZWN0Iiwiem9vbVRvUmVjdCIsInNjcm9sbFJlc3BvbmRlckZsYXNoU2Nyb2xsSW5kaWNhdG9ycyIsImZsYXNoU2Nyb2xsSW5kaWNhdG9ycyIsInNjcm9sbFJlc3BvbmRlclNjcm9sbE5hdGl2ZUhhbmRsZVRvS2V5Ym9hcmQiLCJub2RlSGFuZGxlIiwiYWRkaXRpb25hbE9mZnNldCIsInByZXZlbnROZWdhdGl2ZVNjcm9sbE9mZnNldCIsImFkZGl0aW9uYWxTY3JvbGxPZmZzZXQiLCJtZWFzdXJlTGF5b3V0IiwiZ2V0SW5uZXJWaWV3Tm9kZSIsInNjcm9sbFJlc3BvbmRlclRleHRJbnB1dEZvY3VzRXJyb3IiLCJzY3JvbGxSZXNwb25kZXJJbnB1dE1lYXN1cmVBbmRTY3JvbGxUb0tleWJvYXJkIiwibGVmdCIsInRvcCIsIndpZHRoIiwiaGVpZ2h0Iiwia2V5Ym9hcmRTY3JlZW5ZIiwiZ2V0Iiwia2V5Ym9hcmRXaWxsT3BlblRvIiwiZW5kQ29vcmRpbmF0ZXMiLCJzY3JlZW5ZIiwic2Nyb2xsT2Zmc2V0WSIsIk1hdGgiLCJtYXgiLCJlcnJvciIsIlVOU0FGRV9jb21wb25lbnRXaWxsTW91bnQiLCJhZGRMaXN0ZW5lck9uIiwic2Nyb2xsUmVzcG9uZGVyS2V5Ym9hcmRXaWxsU2hvdyIsInNjcm9sbFJlc3BvbmRlcktleWJvYXJkV2lsbEhpZGUiLCJzY3JvbGxSZXNwb25kZXJLZXlib2FyZERpZFNob3ciLCJzY3JvbGxSZXNwb25kZXJLZXlib2FyZERpZEhpZGUiLCJvbktleWJvYXJkV2lsbFNob3ciLCJvbktleWJvYXJkV2lsbEhpZGUiLCJvbktleWJvYXJkRGlkU2hvdyIsIm9uS2V5Ym9hcmREaWRIaWRlIiwiU2Nyb2xsUmVzcG9uZGVyIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7OztBQVVBOztBQUVBLElBQU1BLGFBQWFDLFFBQVEsWUFBUixDQUFuQjtBQUNBLElBQU1DLGtCQUFrQkQsUUFBUSxpQkFBUixDQUF4QjtBQUNBLElBQU1FLFdBQVdGLFFBQVEsVUFBUixDQUFqQjtBQUNBLElBQU1HLGNBQWNILFFBQVEsYUFBUixDQUFwQjtBQUNBLElBQU1JLGVBQWVKLFFBQVEsY0FBUixDQUFyQjtBQUNBLElBQU1LLGlCQUFpQkwsUUFBUSxnQkFBUixDQUF2QjtBQUNBLElBQU1NLFlBQVlOLFFBQVEsV0FBUixDQUFsQjs7QUFFQSxJQUFNTyxZQUFZUCxRQUFRLG9CQUFSLENBQWxCO0FBQ0EsSUFBTVEsYUFBYVIsUUFBUSxxQkFBUixDQUFuQjtBQUNBLElBQU1TLGlCQUFpQlQsUUFBUSx5QkFBUixDQUF2QjtBQUNBLElBQU1VLFVBQVVWLFFBQVEsa0JBQVIsQ0FBaEIsQzs7QUFFNEJBLFFBQVEsZUFBUixDLENBQXJCVyxpQixZQUFBQSxpQjs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFnRlAsSUFBTUMsd0NBQXdDLEVBQTlDOzs7Ozs7Ozs7OztBQVdBLElBQU1DLHVCQUF1QjtBQUMzQkMsVUFBUSxDQUFDVixhQUFhVyxLQUFkLENBRG1CO0FBRTNCQyx1Q0FBcUMsK0NBQWtCO0FBQ3JELFdBQU87QUFDTEMsa0JBQVksS0FEUDtBQUVMQyxtQ0FBNkIsQ0FGeEI7QUFHTEMsaUNBQTJCLENBSHRCOzs7Ozs7O0FBVUxDLDRDQUFzQyxLQVZqQztBQVdMQyxxQ0FBK0IsS0FYMUIsRUFBUDs7QUFhRCxHQWhCMEI7Ozs7O0FBcUIzQkMsaURBQStDLHlEQUFvQjtBQUNqRSxXQUFPLEtBQUtDLEtBQUws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QkgsbUNBQWlDLHlDQUFTN0YsQ0FBVCxFQUFtQjtBQUNsRCxTQUFLb0Ysa0JBQUwsR0FBMEJwRixDQUExQjtBQUNBLFNBQUtHLEtBQUwsQ0FBVzhGLGtCQUFYLElBQWlDLEtBQUs5RixLQUFMLENBQVc4RixrQkFBWCxDQUE4QmpHLENBQTlCLENBQWpDO0FBQ0QsR0E1aEIwQjs7QUE4aEIzQjhGLG1DQUFpQyx5Q0FBUzlGLENBQVQsRUFBbUI7QUFDbEQsU0FBS29GLGtCQUFMLEdBQTBCLElBQTFCO0FBQ0EsU0FBS2pGLEtBQUwsQ0FBVytGLGtCQUFYLElBQWlDLEtBQUsvRixLQUFMLENBQVcrRixrQkFBWCxDQUE4QmxHLENBQTlCLENBQWpDO0FBQ0QsR0FqaUIwQjs7QUFtaUIzQitGLGtDQUFnQyx3Q0FBUy9GLENBQVQsRUFBbUI7OztBQUdqRCxRQUFJQSxDQUFKLEVBQU87QUFDTCxXQUFLb0Ysa0JBQUwsR0FBMEJwRixDQUExQjtBQUNEO0FBQ0QsU0FBS0csS0FBTCxDQUFXZ0csaUJBQVgsSUFBZ0MsS0FBS2hHLEtBQUwsQ0FBV2dHLGlCQUFYLENBQTZCbkcsQ0FBN0IsQ0FBaEM7QUFDRCxHQTFpQjBCOztBQTRpQjNCZ0csa0NBQWdDLHdDQUFTaEcsQ0FBVCxFQUFtQjtBQUNqRCxTQUFLb0Ysa0JBQUwsR0FBMEIsSUFBMUI7QUFDQSxTQUFLakYsS0FBTCxDQUFXaUcsaUJBQVgsSUFBZ0MsS0FBS2pHLEtBQUwsQ0FBV2lHLGlCQUFYLENBQTZCcEcsQ0FBN0IsQ0FBaEM7QUFDRCxHQS9pQjBCLEVBQTdCOzs7QUFrakJBLElBQU1xRyxrQkFBa0I7QUFDdEIvRyxTQUFPRixvQkFEZSxFQUF4Qjs7O0FBSUFrSCxPQUFPQyxPQUFQLEdBQWlCRixlQUFqQiIsImZpbGUiOiJTY3JvbGxSZXNwb25kZXIuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIENvcHlyaWdodCAoYykgMjAxNS1wcmVzZW50LCBGYWNlYm9vaywgSW5jLlxuICpcbiAqIFRoaXMgc291cmNlIGNvZGUgaXMgbGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlIGZvdW5kIGluIHRoZVxuICogTElDRU5TRSBmaWxlIGluIHRoZSByb290IGRpcmVjdG9yeSBvZiB0aGlzIHNvdXJjZSB0cmVlLlxuICpcbiAqIEBmb3JtYXRcbiAqIEBmbG93XG4gKi9cblxuJ3VzZSBzdHJpY3QnO1xuXG5jb25zdCBEaW1lbnNpb25zID0gcmVxdWlyZSgnRGltZW5zaW9ucycpO1xuY29uc3QgRnJhbWVSYXRlTG9nZ2VyID0gcmVxdWlyZSgnRnJhbWVSYXRlTG9nZ2VyJyk7XG5jb25zdCBLZXlib2FyZCA9IHJlcXVpcmUoJ0tleWJvYXJkJyk7XG5jb25zdCBSZWFjdE5hdGl2ZSA9IHJlcXVpcmUoJ1JlYWN0TmF0aXZlJyk7XG5jb25zdCBTdWJzY3JpYmFibGUgPSByZXF1aXJlKCdTdWJzY3JpYmFibGUnKTtcbmNvbnN0IFRleHRJbnB1dFN0YXRlID0gcmVxdWlyZSgnVGV4dElucHV0U3RhdGUnKTtcbmNvbnN0IFVJTWFuYWdlciA9IHJlcXVpcmUoJ1VJTWFuYWdlcicpO1xuXG5jb25zdCBpbnZhcmlhbnQgPSByZXF1aXJlKCdmYmpzL2xpYi9pbnZhcmlhbnQnKTtcbmNvbnN0IG51bGx0aHJvd3MgPSByZXF1aXJlKCdmYmpzL2xpYi9udWxsdGhyb3dzJyk7XG5jb25zdCBwZXJmb3JtYW5jZU5vdyA9IHJlcXVpcmUoJ2ZianMvbGliL3BlcmZvcm1hbmNlTm93Jyk7XG5jb25zdCB3YXJuaW5nID0gcmVxdWlyZSgnZmJqcy9saWIvd2FybmluZycpO1xuXG5jb25zdCB7U2Nyb2xsVmlld01hbmFnZXJ9ID0gcmVxdWlyZSgnTmF0aXZlTW9kdWxlcycpO1xuXG4vKipcbiAqIE1peGluIHRoYXQgY2FuIGJlIGludGVncmF0ZWQgaW4gb3JkZXIgdG8gaGFuZGxlIHNjcm9sbGluZyB0aGF0IHBsYXlzIHdlbGxcbiAqIHdpdGggYFJlc3BvbmRlckV2ZW50UGx1Z2luYC4gSW50ZWdyYXRlIHdpdGggeW91ciBwbGF0Zm9ybSBzcGVjaWZpYyBzY3JvbGxcbiAqIHZpZXdzLCBvciBldmVuIHlvdXIgY3VzdG9tIGJ1aWx0IChldmVyeS1mcmFtZSBhbmltYXRpbmcpIHNjcm9sbCB2aWV3cyBzbyB0aGF0XG4gKiBhbGwgb2YgdGhlc2Ugc3lzdGVtcyBwbGF5IHdlbGwgd2l0aCB0aGUgYFJlc3BvbmRlckV2ZW50UGx1Z2luYC5cbiAqXG4gKiBpT1Mgc2Nyb2xsIGV2ZW50IHRpbWluZyBudWFuY2VzOlxuICogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICpcbiAqXG4gKiBTY3JvbGxpbmcgd2l0aG91dCBib3VuY2luZywgaWYgeW91IHRvdWNoIGRvd246XG4gKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gKlxuICogMS4gYG9uTW9tZW50dW1TY3JvbGxCZWdpbmAgKHdoZW4gYW5pbWF0aW9uIGJlZ2lucyBhZnRlciBsZXR0aW5nIHVwKVxuICogICAgLi4uIHBoeXNpY2FsIHRvdWNoIHN0YXJ0cyAuLi5cbiAqIDIuIGBvblRvdWNoU3RhcnRDYXB0dXJlYCAgICh3aGVuIHlvdSBwcmVzcyBkb3duIHRvIHN0b3AgdGhlIHNjcm9sbClcbiAqIDMuIGBvblRvdWNoU3RhcnRgICAgICAgICAgIChzYW1lLCBidXQgYnViYmxlIHBoYXNlKVxuICogNC4gYG9uUmVzcG9uZGVyUmVsZWFzZWAgICAgKHdoZW4gbGlmdGluZyB1cCAtIHlvdSBjb3VsZCBwYXVzZSBmb3JldmVyIGJlZm9yZSAqIGxpZnRpbmcpXG4gKiA1LiBgb25Nb21lbnR1bVNjcm9sbEVuZGBcbiAqXG4gKlxuICogU2Nyb2xsaW5nIHdpdGggYm91bmNpbmcsIGlmIHlvdSB0b3VjaCBkb3duOlxuICogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICpcbiAqIDEuIGBvbk1vbWVudHVtU2Nyb2xsQmVnaW5gICh3aGVuIGFuaW1hdGlvbiBiZWdpbnMgYWZ0ZXIgbGV0dGluZyB1cClcbiAqICAgIC4uLiBib3VuY2UgYmVnaW5zIC4uLlxuICogICAgLi4uIHNvbWUgdGltZSBlbGFwc2VzIC4uLlxuICogICAgLi4uIHBoeXNpY2FsIHRvdWNoIGR1cmluZyBib3VuY2UgLi4uXG4gKiAyLiBgb25Nb21lbnR1bVNjcm9sbEVuZGAgICAoTWFrZXMgbm8gc2Vuc2Ugd2h5IHRoaXMgb2NjdXJzIGZpcnN0IGR1cmluZyBib3VuY2UpXG4gKiAzLiBgb25Ub3VjaFN0YXJ0Q2FwdHVyZWAgICAoaW1tZWRpYXRlbHkgYWZ0ZXIgYG9uTW9tZW50dW1TY3JvbGxFbmRgKVxuICogNC4gYG9uVG91Y2hTdGFydGAgICAgICAgICAgKHNhbWUsIGJ1dCBidWJibGUgcGhhc2UpXG4gKiA1LiBgb25Ub3VjaEVuZGAgICAgICAgICAgICAoWW91IGNvdWxkIGhvbGQgdGhlIHRvdWNoIHN0YXJ0IGZvciBhIGxvbmcgdGltZSlcbiAqIDYuIGBvbk1vbWVudHVtU2Nyb2xsQmVnaW5gIChXaGVuIHJlbGVhc2luZyB0aGUgdmlldyBzdGFydHMgYm91bmNpbmcgYmFjaylcbiAqXG4gKiBTbyB3aGVuIHdlIHJlY2VpdmUgYW4gYG9uVG91Y2hTdGFydGAsIGhvdyBjYW4gd2UgdGVsbCBpZiB3ZSBhcmUgdG91Y2hpbmdcbiAqICpkdXJpbmcqIGFuIGFuaW1hdGlvbiAod2hpY2ggdGhlbiBjYXVzZXMgdGhlIGFuaW1hdGlvbiB0byBzdG9wKT8gVGhlIG9ubHkgd2F5XG4gKiB0byB0ZWxsIGlzIGlmIHRoZSBgdG91Y2hTdGFydGAgb2NjdXJyZWQgaW1tZWRpYXRlbHkgYWZ0ZXIgdGhlXG4gKiBgb25Nb21lbnR1bVNjcm9sbEVuZGAuXG4gKlxuICogVGhpcyBpcyBhYnN0cmFjdGVkIG91dCBmb3IgeW91LCBzbyB5b3UgY2FuIGp1c3QgY2FsbCB0aGlzLnNjcm9sbFJlc3BvbmRlcklzQW5pbWF0aW5nKCkgaWZcbiAqIG5lY2Vzc2FyeVxuICpcbiAqIGBTY3JvbGxSZXNwb25kZXJgIGFsc28gaW5jbHVkZXMgbG9naWMgZm9yIGJsdXJyaW5nIGEgY3VycmVudGx5IGZvY3VzZWQgaW5wdXRcbiAqIGlmIG9uZSBpcyBmb2N1c2VkIHdoaWxlIHNjcm9sbGluZy4gVGhlIGBTY3JvbGxSZXNwb25kZXJgIGlzIGEgbmF0dXJhbCBwbGFjZVxuICogdG8gcHV0IHRoaXMgbG9naWMgc2luY2UgaXQgY2FuIHN1cHBvcnQgbm90IGRpc21pc3NpbmcgdGhlIGtleWJvYXJkIHdoaWxlXG4gKiBzY3JvbGxpbmcsIHVubGVzcyBhIHJlY29nbml6ZWQgXCJ0YXBcIi1saWtlIGdlc3R1cmUgaGFzIG9jY3VycmVkLlxuICpcbiAqIFRoZSBwdWJsaWMgbGlmZWN5Y2xlIEFQSSBpbmNsdWRlcyBldmVudHMgZm9yIGtleWJvYXJkIGludGVyYWN0aW9uLCByZXNwb25kZXJcbiAqIGludGVyYWN0aW9uLCBhbmQgc2Nyb2xsaW5nIChhbW9uZyBvdGhlcnMpLiBUaGUga2V5Ym9hcmQgY2FsbGJhY2tzXG4gKiBgb25LZXlib2FyZFdpbGwvRGlkLypgIGFyZSAqZ2xvYmFsKiBldmVudHMsIGJ1dCBhcmUgaW52b2tlZCBvbiBzY3JvbGxcbiAqIHJlc3BvbmRlcidzIHByb3BzIHNvIHRoYXQgeW91IGNhbiBndWFyYW50ZWUgdGhhdCB0aGUgc2Nyb2xsIHJlc3BvbmRlcidzXG4gKiBpbnRlcm5hbCBzdGF0ZSBoYXMgYmVlbiB1cGRhdGVkIGFjY29yZGluZ2x5IChhbmQgZGV0ZXJtaW5pc3RpY2FsbHkpIGJ5XG4gKiB0aGUgdGltZSB0aGUgcHJvcHMgY2FsbGJhY2tzIGFyZSBpbnZva2UuIE90aGVyd2lzZSwgeW91IHdvdWxkIGFsd2F5cyB3b25kZXJcbiAqIGlmIHRoZSBzY3JvbGwgcmVzcG9uZGVyIGlzIGN1cnJlbnRseSBpbiBhIHN0YXRlIHdoZXJlIGl0IHJlY29nbml6ZXMgbmV3XG4gKiBrZXlib2FyZCBwb3NpdGlvbnMgZXRjLiBJZiBjb29yZGluYXRpbmcgc2Nyb2xsaW5nIHdpdGgga2V5Ym9hcmQgbW92ZW1lbnQsXG4gKiAqYWx3YXlzKiB1c2UgdGhlc2UgaG9va3MgaW5zdGVhZCBvZiBsaXN0ZW5pbmcgdG8geW91ciBvd24gZ2xvYmFsIGtleWJvYXJkXG4gKiBldmVudHMuXG4gKlxuICogUHVibGljIGtleWJvYXJkIGxpZmVjeWNsZSBBUEk6IChwcm9wcyBjYWxsYmFja3MpXG4gKlxuICogU3RhbmRhcmQgS2V5Ym9hcmQgQXBwZWFyYW5jZSBTZXF1ZW5jZTpcbiAqXG4gKiAgIHRoaXMucHJvcHMub25LZXlib2FyZFdpbGxTaG93XG4gKiAgIHRoaXMucHJvcHMub25LZXlib2FyZERpZFNob3dcbiAqXG4gKiBgb25TY3JvbGxSZXNwb25kZXJLZXlib2FyZERpc21pc3NlZGAgd2lsbCBiZSBpbnZva2VkIGlmIGFuIGFwcHJvcHJpYXRlXG4gKiB0YXAgaW5zaWRlIHRoZSBzY3JvbGwgcmVzcG9uZGVyJ3Mgc2Nyb2xsYWJsZSByZWdpb24gd2FzIHJlc3BvbnNpYmxlXG4gKiBmb3IgdGhlIGRpc21pc3NhbCBvZiB0aGUga2V5Ym9hcmQuIFRoZXJlIGFyZSBvdGhlciByZWFzb25zIHdoeSB0aGVcbiAqIGtleWJvYXJkIGNvdWxkIGJlIGRpc21pc3NlZC5cbiAqXG4gKiAgIHRoaXMucHJvcHMub25TY3JvbGxSZXNwb25kZXJLZXlib2FyZERpc21pc3NlZFxuICpcbiAqIFN0YW5kYXJkIEtleWJvYXJkIEhpZGUgU2VxdWVuY2U6XG4gKlxuICogICB0aGlzLnByb3BzLm9uS2V5Ym9hcmRXaWxsSGlkZVxuICogICB0aGlzLnByb3BzLm9uS2V5Ym9hcmREaWRIaWRlXG4gKi9cblxuY29uc3QgSVNfQU5JTUFUSU5HX1RPVUNIX1NUQVJUX1RIUkVTSE9MRF9NUyA9IDE2O1xuXG50eXBlIFN0YXRlID0ge1xuICBpc1RvdWNoaW5nOiBib29sZWFuLFxuICBsYXN0TW9tZW50dW1TY3JvbGxCZWdpblRpbWU6IG51bWJlcixcbiAgbGFzdE1vbWVudHVtU2Nyb2xsRW5kVGltZTogbnVtYmVyLFxuICBvYnNlcnZlZFNjcm9sbFNpbmNlQmVjb21pbmdSZXNwb25kZXI6IGJvb2xlYW4sXG4gIGJlY2FtZVJlc3BvbmRlcldoaWxlQW5pbWF0aW5nOiBib29sZWFuLFxufTtcbnR5cGUgRXZlbnQgPSBPYmplY3Q7XG5cbmNvbnN0IFNjcm9sbFJlc3BvbmRlck1peGluID0ge1xuICBtaXhpbnM6IFtTdWJzY3JpYmFibGUuTWl4aW5dLFxuICBzY3JvbGxSZXNwb25kZXJNaXhpbkdldEluaXRpYWxTdGF0ZTogZnVuY3Rpb24oKTogU3RhdGUge1xuICAgIHJldHVybiB7XG4gICAgICBpc1RvdWNoaW5nOiBmYWxzZSxcbiAgICAgIGxhc3RNb21lbnR1bVNjcm9sbEJlZ2luVGltZTogMCxcbiAgICAgIGxhc3RNb21lbnR1bVNjcm9sbEVuZFRpbWU6IDAsXG5cbiAgICAgIC8vIFJlc2V0IHRvIGZhbHNlIGV2ZXJ5IHRpbWUgYmVjb21lcyByZXNwb25kZXIuIFRoaXMgaXMgdXNlZCB0bzpcbiAgICAgIC8vIC0gRGV0ZXJtaW5lIGlmIHRoZSBzY3JvbGwgdmlldyBoYXMgYmVlbiBzY3JvbGxlZCBhbmQgdGhlcmVmb3JlIHNob3VsZFxuICAgICAgLy8gcmVmdXNlIHRvIGdpdmUgdXAgaXRzIHJlc3BvbmRlciBsb2NrLlxuICAgICAgLy8gLSBEZXRlcm1pbmUgaWYgcmVsZWFzaW5nIHNob3VsZCBkaXNtaXNzIHRoZSBrZXlib2FyZCB3aGVuIHdlIGFyZSBpblxuICAgICAgLy8gdGFwLXRvLWRpc21pc3MgbW9kZSAodGhpcy5wcm9wcy5rZXlib2FyZFNob3VsZFBlcnNpc3RUYXBzICE9PSAnYWx3YXlzJykuXG4gICAgICBvYnNlcnZlZFNjcm9sbFNpbmNlQmVjb21pbmdSZXNwb25kZXI6IGZhbHNlLFxuICAgICAgYmVjYW1lUmVzcG9uZGVyV2hpbGVBbmltYXRpbmc6IGZhbHNlLFxuICAgIH07XG4gIH0sXG5cbiAgLyoqXG4gICAqIEludm9rZSB0aGlzIGZyb20gYW4gYG9uU2Nyb2xsYCBldmVudC5cbiAgICovXG4gIHNjcm9sbFJlc3BvbmRlckhhbmRsZVNjcm9sbFNob3VsZFNldFJlc3BvbmRlcjogZnVuY3Rpb24oKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMuc3RhdGUuaXNUb3VjaGluZztcbiAgfSxcblxuICAvKipcbiAgICogTWVyZWx5IHRvdWNoIHN0YXJ0aW5nIGlzIG5vdCBzdWZmaWNpZW50IGZvciBhIHNjcm9sbCB2aWV3IHRvIGJlY29tZSB0aGVcbiAgICogcmVzcG9uZGVyLiBCZWluZyB0aGUgXCJyZXNwb25kZXJcIiBtZWFucyB0aGF0IHRoZSB2ZXJ5IG5leHQgdG91Y2ggbW92ZS9lbmRcbiAgICogZXZlbnQgd2lsbCByZXN1bHQgaW4gYW4gYWN0aW9uL21vdmVtZW50LlxuICAgKlxuICAgKiBJbnZva2UgdGhpcyBmcm9tIGFuIGBvblN0YXJ0U2hvdWxkU2V0UmVzcG9uZGVyYCBldmVudC5cbiAgICpcbiAgICogYG9uU3RhcnRTaG91bGRTZXRSZXNwb25kZXJgIGlzIHVzZWQgd2hlbiB0aGUgbmV4dCBtb3ZlL2VuZCB3aWxsIHRyaWdnZXJcbiAgICogc29tZSBVSSBtb3ZlbWVudC9hY3Rpb24sIGJ1dCB3aGVuIHlvdSB3YW50IHRvIHlpZWxkIHByaW9yaXR5IHRvIHZpZXdzXG4gICAqIG5lc3RlZCBpbnNpZGUgb2YgdGhlIHZpZXcuXG4gICAqXG4gICAqIFRoZXJlIG1heSBiZSBzb21lIGNhc2VzIHdoZXJlIHNjcm9sbCB2aWV3cyBhY3R1YWxseSBzaG91bGQgcmV0dXJuIGB0cnVlYFxuICAgKiBmcm9tIGBvblN0YXJ0U2hvdWxkU2V0UmVzcG9uZGVyYDogQW55IHRpbWUgd2UgYXJlIGRldGVjdGluZyBhIHN0YW5kYXJkIHRhcFxuICAgKiB0aGF0IGdpdmVzIHByaW9yaXR5IHRvIG5lc3RlZCB2aWV3cy5cbiAgICpcbiAgICogLSBJZiBhIHNpbmdsZSB0YXAgb24gdGhlIHNjcm9sbCB2aWV3IHRyaWdnZXJzIGFuIGFjdGlvbiBzdWNoIGFzXG4gICAqICAgcmVjZW50ZXJpbmcgYSBtYXAgc3R5bGUgdmlldyB5ZXQgd2FudHMgdG8gZ2l2ZSBwcmlvcml0eSB0byBpbnRlcmFjdGlvblxuICAgKiAgIHZpZXdzIGluc2lkZSAoc3VjaCBhcyBkcm9wcGVkIHBpbnMgb3IgbGFiZWxzKSwgdGhlbiB3ZSB3b3VsZCByZXR1cm4gdHJ1ZVxuICAgKiAgIGZyb20gdGhpcyBtZXRob2Qgd2hlbiB0aGVyZSBpcyBhIHNpbmdsZSB0b3VjaC5cbiAgICpcbiAgICogLSBTaW1pbGFyIHRvIHRoZSBwcmV2aW91cyBjYXNlLCBpZiBhIHR3byBmaW5nZXIgXCJ0YXBcIiBzaG91bGQgdHJpZ2dlciBhXG4gICAqICAgem9vbSwgd2Ugd291bGQgY2hlY2sgdGhlIGB0b3VjaGVzYCBjb3VudCwgYW5kIGlmIGA+PSAyYCwgd2Ugd291bGQgcmV0dXJuXG4gICAqICAgdHJ1ZS5cbiAgICpcbiAgICovXG4gIHNjcm9sbFJlc3BvbmRlckhhbmRsZVN0YXJ0U2hvdWxkU2V0UmVzcG9uZGVyOiBmdW5jdGlvbihlOiBFdmVudCk6IGJvb2xlYW4ge1xuICAgIGNvbnN0IGN1cnJlbnRseUZvY3VzZWRUZXh0SW5wdXQgPSBUZXh0SW5wdXRTdGF0ZS5jdXJyZW50bHlGb2N1c2VkRmllbGQoKTtcblxuICAgIGlmIChcbiAgICAgIHRoaXMucHJvcHMua2V5Ym9hcmRTaG91bGRQZXJzaXN0VGFwcyA9PT0gJ2hhbmRsZWQnICYmXG4gICAgICBjdXJyZW50bHlGb2N1c2VkVGV4dElucHV0ICE9IG51bGwgJiZcbiAgICAgIGUudGFyZ2V0ICE9PSBjdXJyZW50bHlGb2N1c2VkVGV4dElucHV0XG4gICAgKSB7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9LFxuXG4gIC8qKlxuICAgKiBUaGVyZSBhcmUgdGltZXMgd2hlbiB0aGUgc2Nyb2xsIHZpZXcgd2FudHMgdG8gYmVjb21lIHRoZSByZXNwb25kZXJcbiAgICogKG1lYW5pbmcgcmVzcG9uZCB0byB0aGUgbmV4dCBpbW1lZGlhdGUgYHRvdWNoU3RhcnQvdG91Y2hFbmRgKSwgaW4gYSB3YXlcbiAgICogdGhhdCAqZG9lc24ndCogZ2l2ZSBwcmlvcml0eSB0byBuZXN0ZWQgdmlld3MgKGhlbmNlIHRoZSBjYXB0dXJlIHBoYXNlKTpcbiAgICpcbiAgICogLSBDdXJyZW50bHkgYW5pbWF0aW5nLlxuICAgKiAtIFRhcHBpbmcgYW55d2hlcmUgdGhhdCBpcyBub3QgYSB0ZXh0IGlucHV0LCB3aGlsZSB0aGUga2V5Ym9hcmQgaXNcbiAgICogICB1cCAod2hpY2ggc2hvdWxkIGRpc21pc3MgdGhlIGtleWJvYXJkKS5cbiAgICpcbiAgICogSW52b2tlIHRoaXMgZnJvbSBhbiBgb25TdGFydFNob3VsZFNldFJlc3BvbmRlckNhcHR1cmVgIGV2ZW50LlxuICAgKi9cbiAgc2Nyb2xsUmVzcG9uZGVySGFuZGxlU3RhcnRTaG91bGRTZXRSZXNwb25kZXJDYXB0dXJlOiBmdW5jdGlvbihcbiAgICBlOiBFdmVudCxcbiAgKTogYm9vbGVhbiB7XG4gICAgLy8gVGhlIHNjcm9sbCB2aWV3IHNob3VsZCByZWNlaXZlIHRhcHMgaW5zdGVhZCBvZiBpdHMgZGVzY2VuZGFudHMgaWY6XG4gICAgLy8gKiBpdCBpcyBhbHJlYWR5IGFuaW1hdGluZy9kZWNlbGVyYXRpbmdcbiAgICBpZiAodGhpcy5zY3JvbGxSZXNwb25kZXJJc0FuaW1hdGluZygpKSB7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG5cbiAgICAvLyAqIHRoZSBrZXlib2FyZCBpcyB1cCwga2V5Ym9hcmRTaG91bGRQZXJzaXN0VGFwcyBpcyAnbmV2ZXInICh0aGUgZGVmYXVsdCksXG4gICAgLy8gYW5kIGEgbmV3IHRvdWNoIHN0YXJ0cyB3aXRoIGEgbm9uLXRleHRpbnB1dCB0YXJnZXQgKGluIHdoaWNoIGNhc2UgdGhlXG4gICAgLy8gZmlyc3QgdGFwIHNob3VsZCBiZSBzZW50IHRvIHRoZSBzY3JvbGwgdmlldyBhbmQgZGlzbWlzcyB0aGUga2V5Ym9hcmQsXG4gICAgLy8gdGhlbiB0aGUgc2Vjb25kIHRhcCBnb2VzIHRvIHRoZSBhY3R1YWwgaW50ZXJpb3IgdmlldylcbiAgICBjb25zdCBjdXJyZW50bHlGb2N1c2VkVGV4dElucHV0ID0gVGV4dElucHV0U3RhdGUuY3VycmVudGx5Rm9jdXNlZEZpZWxkKCk7XG4gICAgY29uc3Qge2tleWJvYXJkU2hvdWxkUGVyc2lzdFRhcHN9ID0gdGhpcy5wcm9wcztcbiAgICBjb25zdCBrZXlib2FyZE5ldmVyUGVyc2lzdFRhcHMgPVxuICAgICAgIWtleWJvYXJkU2hvdWxkUGVyc2lzdFRhcHMgfHwga2V5Ym9hcmRTaG91bGRQZXJzaXN0VGFwcyA9PT0gJ25ldmVyJztcbiAgICBpZiAoXG4gICAgICBrZXlib2FyZE5ldmVyUGVyc2lzdFRhcHMgJiZcbiAgICAgIGN1cnJlbnRseUZvY3VzZWRUZXh0SW5wdXQgIT0gbnVsbCAmJlxuICAgICAgIVRleHRJbnB1dFN0YXRlLmlzVGV4dElucHV0KGUudGFyZ2V0KVxuICAgICkge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuXG4gICAgcmV0dXJuIGZhbHNlO1xuICB9LFxuXG4gIC8qKlxuICAgKiBJbnZva2UgdGhpcyBmcm9tIGFuIGBvblJlc3BvbmRlclJlamVjdGAgZXZlbnQuXG4gICAqXG4gICAqIFNvbWUgb3RoZXIgZWxlbWVudCBpcyBub3QgeWllbGRpbmcgaXRzIHJvbGUgYXMgcmVzcG9uZGVyLiBOb3JtYWxseSwgd2UnZFxuICAgKiBqdXN0IGRpc2FibGUgdGhlIGBVSVNjcm9sbFZpZXdgLCBidXQgYSB0b3VjaCBoYXMgYWxyZWFkeSBiZWdhbiBvbiBpdCwgdGhlXG4gICAqIGBVSVNjcm9sbFZpZXdgIHdpbGwgbm90IGFjY2VwdCBiZWluZyBkaXNhYmxlZCBhZnRlciB0aGF0LiBUaGUgZWFzaWVzdFxuICAgKiBzb2x1dGlvbiBmb3Igbm93IGlzIHRvIGFjY2VwdCB0aGUgbGltaXRhdGlvbiBvZiBkaXNhbGxvd2luZyB0aGlzXG4gICAqIGFsdG9nZXRoZXIuIFRvIGltcHJvdmUgdGhpcywgZmluZCBhIHdheSB0byBkaXNhYmxlIHRoZSBgVUlTY3JvbGxWaWV3YCBhZnRlclxuICAgKiBhIHRvdWNoIGhhcyBhbHJlYWR5IHN0YXJ0ZWQuXG4gICAqL1xuICBzY3JvbGxSZXNwb25kZXJIYW5kbGVSZXNwb25kZXJSZWplY3Q6IGZ1bmN0aW9uKCkge30sXG5cbiAgLyoqXG4gICAqIFdlIHdpbGwgYWxsb3cgdGhlIHNjcm9sbCB2aWV3IHRvIGdpdmUgdXAgaXRzIGxvY2sgaWZmIGl0IGFjcXVpcmVkIHRoZSBsb2NrXG4gICAqIGR1cmluZyBhbiBhbmltYXRpb24uIFRoaXMgaXMgYSB2ZXJ5IHVzZWZ1bCBkZWZhdWx0IHRoYXQgaGFwcGVucyB0byBzYXRpc2Z5XG4gICAqIG1hbnkgY29tbW9uIHVzZXIgZXhwZXJpZW5jZXMuXG4gICAqXG4gICAqIC0gU3RvcCBhIHNjcm9sbCBvbiB0aGUgbGVmdCBlZGdlLCB0aGVuIHR1cm4gdGhhdCBpbnRvIGFuIG91dGVyIHZpZXcnc1xuICAgKiAgIGJhY2tzd2lwZS5cbiAgICogLSBTdG9wIGEgc2Nyb2xsIG1pZC1ib3VuY2UgYXQgdGhlIHRvcCwgY29udGludWUgcHVsbGluZyB0byBoYXZlIHRoZSBvdXRlclxuICAgKiAgIHZpZXcgZGlzbWlzcy5cbiAgICogLSBIb3dldmVyLCB3aXRob3V0IGNhdGNoaW5nIHRoZSBzY3JvbGwgdmlldyBtaWQtYm91bmNlICh3aGlsZSBpdCBpc1xuICAgKiAgIG1vdGlvbmxlc3MpLCBpZiB5b3UgZHJhZyBmYXIgZW5vdWdoIGZvciB0aGUgc2Nyb2xsIHZpZXcgdG8gYmVjb21lXG4gICAqICAgcmVzcG9uZGVyIChhbmQgdGhlcmVmb3JlIGRyYWcgdGhlIHNjcm9sbCB2aWV3IGEgYml0KSwgYW55IGJhY2tzd2lwZVxuICAgKiAgIG5hdmlnYXRpb24gb2YgYSBzd2lwZSBnZXN0dXJlIGhpZ2hlciBpbiB0aGUgdmlldyBoaWVyYXJjaHksIHNob3VsZCBiZVxuICAgKiAgIHJlamVjdGVkLlxuICAgKi9cbiAgc2Nyb2xsUmVzcG9uZGVySGFuZGxlVGVybWluYXRpb25SZXF1ZXN0OiBmdW5jdGlvbigpOiBib29sZWFuIHtcbiAgICByZXR1cm4gIXRoaXMuc3RhdGUub2JzZXJ2ZWRTY3JvbGxTaW5jZUJlY29taW5nUmVzcG9uZGVyO1xuICB9LFxuXG4gIC8qKlxuICAgKiBJbnZva2UgdGhpcyBmcm9tIGFuIGBvblRvdWNoRW5kYCBldmVudC5cbiAgICpcbiAgICogQHBhcmFtIHtTeW50aGV0aWNFdmVudH0gZSBFdmVudC5cbiAgICovXG4gIHNjcm9sbFJlc3BvbmRlckhhbmRsZVRvdWNoRW5kOiBmdW5jdGlvbihlOiBFdmVudCkge1xuICAgIGNvbnN0IG5hdGl2ZUV2ZW50ID0gZS5uYXRpdmVFdmVudDtcbiAgICB0aGlzLnN0YXRlLmlzVG91Y2hpbmcgPSBuYXRpdmVFdmVudC50b3VjaGVzLmxlbmd0aCAhPT0gMDtcbiAgICB0aGlzLnByb3BzLm9uVG91Y2hFbmQgJiYgdGhpcy5wcm9wcy5vblRvdWNoRW5kKGUpO1xuICB9LFxuXG4gIC8qKlxuICAgKiBJbnZva2UgdGhpcyBmcm9tIGFuIGBvblRvdWNoQ2FuY2VsYCBldmVudC5cbiAgICpcbiAgICogQHBhcmFtIHtTeW50aGV0aWNFdmVudH0gZSBFdmVudC5cbiAgICovXG4gIHNjcm9sbFJlc3BvbmRlckhhbmRsZVRvdWNoQ2FuY2VsOiBmdW5jdGlvbihlOiBFdmVudCkge1xuICAgIHRoaXMuc3RhdGUuaXNUb3VjaGluZyA9IGZhbHNlO1xuICAgIHRoaXMucHJvcHMub25Ub3VjaENhbmNlbCAmJiB0aGlzLnByb3BzLm9uVG91Y2hDYW5jZWwoZSk7XG4gIH0sXG5cbiAgLyoqXG4gICAqIEludm9rZSB0aGlzIGZyb20gYW4gYG9uUmVzcG9uZGVyUmVsZWFzZWAgZXZlbnQuXG4gICAqL1xuICBzY3JvbGxSZXNwb25kZXJIYW5kbGVSZXNwb25kZXJSZWxlYXNlOiBmdW5jdGlvbihlOiBFdmVudCkge1xuICAgIHRoaXMucHJvcHMub25SZXNwb25kZXJSZWxlYXNlICYmIHRoaXMucHJvcHMub25SZXNwb25kZXJSZWxlYXNlKGUpO1xuXG4gICAgLy8gQnkgZGVmYXVsdCBzY3JvbGwgdmlld3Mgd2lsbCB1bmZvY3VzIGEgdGV4dEZpZWxkXG4gICAgLy8gaWYgYW5vdGhlciB0b3VjaCBvY2N1cnMgb3V0c2lkZSBvZiBpdFxuICAgIGNvbnN0IGN1cnJlbnRseUZvY3VzZWRUZXh0SW5wdXQgPSBUZXh0SW5wdXRTdGF0ZS5jdXJyZW50bHlGb2N1c2VkRmllbGQoKTtcbiAgICBpZiAoXG4gICAgICB0aGlzLnByb3BzLmtleWJvYXJkU2hvdWxkUGVyc2lzdFRhcHMgIT09IHRydWUgJiZcbiAgICAgIHRoaXMucHJvcHMua2V5Ym9hcmRTaG91bGRQZXJzaXN0VGFwcyAhPT0gJ2Fsd2F5cycgJiZcbiAgICAgIGN1cnJlbnRseUZvY3VzZWRUZXh0SW5wdXQgIT0gbnVsbCAmJlxuICAgICAgZS50YXJnZXQgIT09IGN1cnJlbnRseUZvY3VzZWRUZXh0SW5wdXQgJiZcbiAgICAgICF0aGlzLnN0YXRlLm9ic2VydmVkU2Nyb2xsU2luY2VCZWNvbWluZ1Jlc3BvbmRlciAmJlxuICAgICAgIXRoaXMuc3RhdGUuYmVjYW1lUmVzcG9uZGVyV2hpbGVBbmltYXRpbmdcbiAgICApIHtcbiAgICAgIHRoaXMucHJvcHMub25TY3JvbGxSZXNwb25kZXJLZXlib2FyZERpc21pc3NlZCAmJlxuICAgICAgICB0aGlzLnByb3BzLm9uU2Nyb2xsUmVzcG9uZGVyS2V5Ym9hcmREaXNtaXNzZWQoZSk7XG4gICAgICBUZXh0SW5wdXRTdGF0ZS5ibHVyVGV4dElucHV0KGN1cnJlbnRseUZvY3VzZWRUZXh0SW5wdXQpO1xuICAgIH1cbiAgfSxcblxuICBzY3JvbGxSZXNwb25kZXJIYW5kbGVTY3JvbGw6IGZ1bmN0aW9uKGU6IEV2ZW50KSB7XG4gICAgdGhpcy5zdGF0ZS5vYnNlcnZlZFNjcm9sbFNpbmNlQmVjb21pbmdSZXNwb25kZXIgPSB0cnVlO1xuICAgIHRoaXMucHJvcHMub25TY3JvbGwgJiYgdGhpcy5wcm9wcy5vblNjcm9sbChlKTtcbiAgfSxcblxuICAvKipcbiAgICogSW52b2tlIHRoaXMgZnJvbSBhbiBgb25SZXNwb25kZXJHcmFudGAgZXZlbnQuXG4gICAqL1xuICBzY3JvbGxSZXNwb25kZXJIYW5kbGVSZXNwb25kZXJHcmFudDogZnVuY3Rpb24oZTogRXZlbnQpIHtcbiAgICB0aGlzLnN0YXRlLm9ic2VydmVkU2Nyb2xsU2luY2VCZWNvbWluZ1Jlc3BvbmRlciA9IGZhbHNlO1xuICAgIHRoaXMucHJvcHMub25SZXNwb25kZXJHcmFudCAmJiB0aGlzLnByb3BzLm9uUmVzcG9uZGVyR3JhbnQoZSk7XG4gICAgdGhpcy5zdGF0ZS5iZWNhbWVSZXNwb25kZXJXaGlsZUFuaW1hdGluZyA9IHRoaXMuc2Nyb2xsUmVzcG9uZGVySXNBbmltYXRpbmcoKTtcbiAgfSxcblxuICAvKipcbiAgICogVW5mb3J0dW5hdGVseSwgYG9uU2Nyb2xsQmVnaW5EcmFnYCBhbHNvIGZpcmVzIHdoZW4gKnN0b3BwaW5nKiB0aGUgc2Nyb2xsXG4gICAqIGFuaW1hdGlvbiwgYW5kIHRoZXJlJ3Mgbm90IGFuIGVhc3kgd2F5IHRvIGRpc3Rpbmd1aXNoIGEgZHJhZyB2cy4gc3RvcHBpbmdcbiAgICogbW9tZW50dW0uXG4gICAqXG4gICAqIEludm9rZSB0aGlzIGZyb20gYW4gYG9uU2Nyb2xsQmVnaW5EcmFnYCBldmVudC5cbiAgICovXG4gIHNjcm9sbFJlc3BvbmRlckhhbmRsZVNjcm9sbEJlZ2luRHJhZzogZnVuY3Rpb24oZTogRXZlbnQpIHtcbiAgICBGcmFtZVJhdGVMb2dnZXIuYmVnaW5TY3JvbGwoKTsgLy8gVE9ETzogdHJhY2sgYWxsIHNjcm9sbHMgYWZ0ZXIgaW1wbGVtZW50aW5nIG9uU2Nyb2xsRW5kQW5pbWF0aW9uXG4gICAgdGhpcy5wcm9wcy5vblNjcm9sbEJlZ2luRHJhZyAmJiB0aGlzLnByb3BzLm9uU2Nyb2xsQmVnaW5EcmFnKGUpO1xuICB9LFxuXG4gIC8qKlxuICAgKiBJbnZva2UgdGhpcyBmcm9tIGFuIGBvblNjcm9sbEVuZERyYWdgIGV2ZW50LlxuICAgKi9cbiAgc2Nyb2xsUmVzcG9uZGVySGFuZGxlU2Nyb2xsRW5kRHJhZzogZnVuY3Rpb24oZTogRXZlbnQpIHtcbiAgICBjb25zdCB7dmVsb2NpdHl9ID0gZS5uYXRpdmVFdmVudDtcbiAgICAvLyAtIElmIHdlIGFyZSBhbmltYXRpbmcsIHRoZW4gdGhpcyBpcyBhIFwiZHJhZ1wiIHRoYXQgaXMgc3RvcHBpbmcgdGhlIHNjcm9sbHZpZXcgYW5kIG1vbWVudHVtIGVuZFxuICAgIC8vICAgd2lsbCBmaXJlLlxuICAgIC8vIC0gSWYgdmVsb2NpdHkgaXMgbm9uLXplcm8sIHRoZW4gdGhlIGludGVyYWN0aW9uIHdpbGwgc3RvcCB3aGVuIG1vbWVudHVtIHNjcm9sbCBlbmRzIG9yXG4gICAgLy8gICBhbm90aGVyIGRyYWcgc3RhcnRzIGFuZCBlbmRzLlxuICAgIC8vIC0gSWYgd2UgZG9uJ3QgZ2V0IHZlbG9jaXR5LCBiZXR0ZXIgdG8gc3RvcCB0aGUgaW50ZXJhY3Rpb24gdHdpY2UgdGhhbiBub3Qgc3RvcCBpdC5cbiAgICBpZiAoXG4gICAgICAhdGhpcy5zY3JvbGxSZXNwb25kZXJJc0FuaW1hdGluZygpICYmXG4gICAgICAoIXZlbG9jaXR5IHx8ICh2ZWxvY2l0eS54ID09PSAwICYmIHZlbG9jaXR5LnkgPT09IDApKVxuICAgICkge1xuICAgICAgRnJhbWVSYXRlTG9nZ2VyLmVuZFNjcm9sbCgpO1xuICAgIH1cbiAgICB0aGlzLnByb3BzLm9uU2Nyb2xsRW5kRHJhZyAmJiB0aGlzLnByb3BzLm9uU2Nyb2xsRW5kRHJhZyhlKTtcbiAgfSxcblxuICAvKipcbiAgICogSW52b2tlIHRoaXMgZnJvbSBhbiBgb25Nb21lbnR1bVNjcm9sbEJlZ2luYCBldmVudC5cbiAgICovXG4gIHNjcm9sbFJlc3BvbmRlckhhbmRsZU1vbWVudHVtU2Nyb2xsQmVnaW46IGZ1bmN0aW9uKGU6IEV2ZW50KSB7XG4gICAgdGhpcy5zdGF0ZS5sYXN0TW9tZW50dW1TY3JvbGxCZWdpblRpbWUgPSBwZXJmb3JtYW5jZU5vdygpO1xuICAgIHRoaXMucHJvcHMub25Nb21lbnR1bVNjcm9sbEJlZ2luICYmIHRoaXMucHJvcHMub25Nb21lbnR1bVNjcm9sbEJlZ2luKGUpO1xuICB9LFxuXG4gIC8qKlxuICAgKiBJbnZva2UgdGhpcyBmcm9tIGFuIGBvbk1vbWVudHVtU2Nyb2xsRW5kYCBldmVudC5cbiAgICovXG4gIHNjcm9sbFJlc3BvbmRlckhhbmRsZU1vbWVudHVtU2Nyb2xsRW5kOiBmdW5jdGlvbihlOiBFdmVudCkge1xuICAgIEZyYW1lUmF0ZUxvZ2dlci5lbmRTY3JvbGwoKTtcbiAgICB0aGlzLnN0YXRlLmxhc3RNb21lbnR1bVNjcm9sbEVuZFRpbWUgPSBwZXJmb3JtYW5jZU5vdygpO1xuICAgIHRoaXMucHJvcHMub25Nb21lbnR1bVNjcm9sbEVuZCAmJiB0aGlzLnByb3BzLm9uTW9tZW50dW1TY3JvbGxFbmQoZSk7XG4gIH0sXG5cbiAgLyoqXG4gICAqIEludm9rZSB0aGlzIGZyb20gYW4gYG9uVG91Y2hTdGFydGAgZXZlbnQuXG4gICAqXG4gICAqIFNpbmNlIHdlIGtub3cgdGhhdCB0aGUgYFNpbXBsZUV2ZW50UGx1Z2luYCBvY2N1cnMgbGF0ZXIgaW4gdGhlIHBsdWdpblxuICAgKiBvcmRlciwgYWZ0ZXIgYFJlc3BvbmRlckV2ZW50UGx1Z2luYCwgd2UgY2FuIGRldGVjdCB0aGF0IHdlIHdlcmUgKm5vdCpcbiAgICogcGVybWl0dGVkIHRvIGJlIHRoZSByZXNwb25kZXIgKHByZXN1bWFibHkgYmVjYXVzZSBhIGNvbnRhaW5lZCB2aWV3IGJlY2FtZVxuICAgKiByZXNwb25kZXIpLiBUaGUgYG9uUmVzcG9uZGVyUmVqZWN0YCB3b24ndCBmaXJlIGluIHRoYXQgY2FzZSAtIGl0IG9ubHlcbiAgICogZmlyZXMgd2hlbiBhICpjdXJyZW50KiByZXNwb25kZXIgcmVqZWN0cyBvdXIgcmVxdWVzdC5cbiAgICpcbiAgICogQHBhcmFtIHtTeW50aGV0aWNFdmVudH0gZSBUb3VjaCBTdGFydCBldmVudC5cbiAgICovXG4gIHNjcm9sbFJlc3BvbmRlckhhbmRsZVRvdWNoU3RhcnQ6IGZ1bmN0aW9uKGU6IEV2ZW50KSB7XG4gICAgdGhpcy5zdGF0ZS5pc1RvdWNoaW5nID0gdHJ1ZTtcbiAgICB0aGlzLnByb3BzLm9uVG91Y2hTdGFydCAmJiB0aGlzLnByb3BzLm9uVG91Y2hTdGFydChlKTtcbiAgfSxcblxuICAvKipcbiAgICogSW52b2tlIHRoaXMgZnJvbSBhbiBgb25Ub3VjaE1vdmVgIGV2ZW50LlxuICAgKlxuICAgKiBTaW5jZSB3ZSBrbm93IHRoYXQgdGhlIGBTaW1wbGVFdmVudFBsdWdpbmAgb2NjdXJzIGxhdGVyIGluIHRoZSBwbHVnaW5cbiAgICogb3JkZXIsIGFmdGVyIGBSZXNwb25kZXJFdmVudFBsdWdpbmAsIHdlIGNhbiBkZXRlY3QgdGhhdCB3ZSB3ZXJlICpub3QqXG4gICAqIHBlcm1pdHRlZCB0byBiZSB0aGUgcmVzcG9uZGVyIChwcmVzdW1hYmx5IGJlY2F1c2UgYSBjb250YWluZWQgdmlldyBiZWNhbWVcbiAgICogcmVzcG9uZGVyKS4gVGhlIGBvblJlc3BvbmRlclJlamVjdGAgd29uJ3QgZmlyZSBpbiB0aGF0IGNhc2UgLSBpdCBvbmx5XG4gICAqIGZpcmVzIHdoZW4gYSAqY3VycmVudCogcmVzcG9uZGVyIHJlamVjdHMgb3VyIHJlcXVlc3QuXG4gICAqXG4gICAqIEBwYXJhbSB7U3ludGhldGljRXZlbnR9IGUgVG91Y2ggU3RhcnQgZXZlbnQuXG4gICAqL1xuICBzY3JvbGxSZXNwb25kZXJIYW5kbGVUb3VjaE1vdmU6IGZ1bmN0aW9uKGU6IEV2ZW50KSB7XG4gICAgdGhpcy5wcm9wcy5vblRvdWNoTW92ZSAmJiB0aGlzLnByb3BzLm9uVG91Y2hNb3ZlKGUpO1xuICB9LFxuXG4gIC8qKlxuICAgKiBBIGhlbHBlciBmdW5jdGlvbiBmb3IgdGhpcyBjbGFzcyB0aGF0IGxldHMgdXMgcXVpY2tseSBkZXRlcm1pbmUgaWYgdGhlXG4gICAqIHZpZXcgaXMgY3VycmVudGx5IGFuaW1hdGluZy4gVGhpcyBpcyBwYXJ0aWN1bGFybHkgdXNlZnVsIHRvIGtub3cgd2hlblxuICAgKiBhIHRvdWNoIGhhcyBqdXN0IHN0YXJ0ZWQgb3IgZW5kZWQuXG4gICAqL1xuICBzY3JvbGxSZXNwb25kZXJJc0FuaW1hdGluZzogZnVuY3Rpb24oKTogYm9vbGVhbiB7XG4gICAgY29uc3Qgbm93ID0gcGVyZm9ybWFuY2VOb3coKTtcbiAgICBjb25zdCB0aW1lU2luY2VMYXN0TW9tZW50dW1TY3JvbGxFbmQgPVxuICAgICAgbm93IC0gdGhpcy5zdGF0ZS5sYXN0TW9tZW50dW1TY3JvbGxFbmRUaW1lO1xuICAgIGNvbnN0IGlzQW5pbWF0aW5nID1cbiAgICAgIHRpbWVTaW5jZUxhc3RNb21lbnR1bVNjcm9sbEVuZCA8IElTX0FOSU1BVElOR19UT1VDSF9TVEFSVF9USFJFU0hPTERfTVMgfHxcbiAgICAgIHRoaXMuc3RhdGUubGFzdE1vbWVudHVtU2Nyb2xsRW5kVGltZSA8XG4gICAgICAgIHRoaXMuc3RhdGUubGFzdE1vbWVudHVtU2Nyb2xsQmVnaW5UaW1lO1xuICAgIHJldHVybiBpc0FuaW1hdGluZztcbiAgfSxcblxuICAvKipcbiAgICogUmV0dXJucyB0aGUgbm9kZSB0aGF0IHJlcHJlc2VudHMgbmF0aXZlIHZpZXcgdGhhdCBjYW4gYmUgc2Nyb2xsZWQuXG4gICAqIENvbXBvbmVudHMgY2FuIHBhc3Mgd2hhdCBub2RlIHRvIHVzZSBieSBkZWZpbmluZyBhIGBnZXRTY3JvbGxhYmxlTm9kZWBcbiAgICogZnVuY3Rpb24gb3RoZXJ3aXNlIGB0aGlzYCBpcyB1c2VkLlxuICAgKi9cbiAgc2Nyb2xsUmVzcG9uZGVyR2V0U2Nyb2xsYWJsZU5vZGU6IGZ1bmN0aW9uKCk6IGFueSB7XG4gICAgcmV0dXJuIHRoaXMuZ2V0U2Nyb2xsYWJsZU5vZGVcbiAgICAgID8gdGhpcy5nZXRTY3JvbGxhYmxlTm9kZSgpXG4gICAgICA6IFJlYWN0TmF0aXZlLmZpbmROb2RlSGFuZGxlKHRoaXMpO1xuICB9LFxuXG4gIC8qKlxuICAgKiBBIGhlbHBlciBmdW5jdGlvbiB0byBzY3JvbGwgdG8gYSBzcGVjaWZpYyBwb2ludCBpbiB0aGUgU2Nyb2xsVmlldy5cbiAgICogVGhpcyBpcyBjdXJyZW50bHkgdXNlZCB0byBoZWxwIGZvY3VzIGNoaWxkIFRleHRWaWV3cywgYnV0IGNhbiBhbHNvXG4gICAqIGJlIHVzZWQgdG8gcXVpY2tseSBzY3JvbGwgdG8gYW55IGVsZW1lbnQgd2Ugd2FudCB0byBmb2N1cy4gU3ludGF4OlxuICAgKlxuICAgKiBgc2Nyb2xsUmVzcG9uZGVyU2Nyb2xsVG8ob3B0aW9uczoge3g6IG51bWJlciA9IDA7IHk6IG51bWJlciA9IDA7IGFuaW1hdGVkOiBib29sZWFuID0gdHJ1ZX0pYFxuICAgKlxuICAgKiBOb3RlOiBUaGUgd2VpcmQgYXJndW1lbnQgc2lnbmF0dXJlIGlzIGR1ZSB0byB0aGUgZmFjdCB0aGF0LCBmb3IgaGlzdG9yaWNhbCByZWFzb25zLFxuICAgKiB0aGUgZnVuY3Rpb24gYWxzbyBhY2NlcHRzIHNlcGFyYXRlIGFyZ3VtZW50cyBhcyBhcyBhbHRlcm5hdGl2ZSB0byB0aGUgb3B0aW9ucyBvYmplY3QuXG4gICAqIFRoaXMgaXMgZGVwcmVjYXRlZCBkdWUgdG8gYW1iaWd1aXR5ICh5IGJlZm9yZSB4KSwgYW5kIFNIT1VMRCBOT1QgQkUgVVNFRC5cbiAgICovXG4gIHNjcm9sbFJlc3BvbmRlclNjcm9sbFRvOiBmdW5jdGlvbihcbiAgICB4PzogbnVtYmVyIHwge3g/OiBudW1iZXIsIHk/OiBudW1iZXIsIGFuaW1hdGVkPzogYm9vbGVhbn0sXG4gICAgeT86IG51bWJlcixcbiAgICBhbmltYXRlZD86IGJvb2xlYW4sXG4gICkge1xuICAgIGlmICh0eXBlb2YgeCA9PT0gJ251bWJlcicpIHtcbiAgICAgIGNvbnNvbGUud2FybihcbiAgICAgICAgJ2BzY3JvbGxSZXNwb25kZXJTY3JvbGxUbyh4LCB5LCBhbmltYXRlZClgIGlzIGRlcHJlY2F0ZWQuIFVzZSBgc2Nyb2xsUmVzcG9uZGVyU2Nyb2xsVG8oe3g6IDUsIHk6IDUsIGFuaW1hdGVkOiB0cnVlfSlgIGluc3RlYWQuJyxcbiAgICAgICk7XG4gICAgfSBlbHNlIHtcbiAgICAgICh7eCwgeSwgYW5pbWF0ZWR9ID0geCB8fCB7fSk7XG4gICAgfVxuICAgIFVJTWFuYWdlci5kaXNwYXRjaFZpZXdNYW5hZ2VyQ29tbWFuZChcbiAgICAgIG51bGx0aHJvd3ModGhpcy5zY3JvbGxSZXNwb25kZXJHZXRTY3JvbGxhYmxlTm9kZSgpKSxcbiAgICAgIFVJTWFuYWdlci5SQ1RTY3JvbGxWaWV3LkNvbW1hbmRzLnNjcm9sbFRvLFxuICAgICAgW3ggfHwgMCwgeSB8fCAwLCBhbmltYXRlZCAhPT0gZmFsc2VdLFxuICAgICk7XG4gIH0sXG5cbiAgLyoqXG4gICAqIFNjcm9sbHMgdG8gdGhlIGVuZCBvZiB0aGUgU2Nyb2xsVmlldywgZWl0aGVyIGltbWVkaWF0ZWx5IG9yIHdpdGggYSBzbW9vdGhcbiAgICogYW5pbWF0aW9uLlxuICAgKlxuICAgKiBFeGFtcGxlOlxuICAgKlxuICAgKiBgc2Nyb2xsUmVzcG9uZGVyU2Nyb2xsVG9FbmQoe2FuaW1hdGVkOiB0cnVlfSlgXG4gICAqL1xuICBzY3JvbGxSZXNwb25kZXJTY3JvbGxUb0VuZDogZnVuY3Rpb24ob3B0aW9ucz86IHthbmltYXRlZD86IGJvb2xlYW59KSB7XG4gICAgLy8gRGVmYXVsdCB0byB0cnVlXG4gICAgY29uc3QgYW5pbWF0ZWQgPSAob3B0aW9ucyAmJiBvcHRpb25zLmFuaW1hdGVkKSAhPT0gZmFsc2U7XG4gICAgVUlNYW5hZ2VyLmRpc3BhdGNoVmlld01hbmFnZXJDb21tYW5kKFxuICAgICAgdGhpcy5zY3JvbGxSZXNwb25kZXJHZXRTY3JvbGxhYmxlTm9kZSgpLFxuICAgICAgVUlNYW5hZ2VyLlJDVFNjcm9sbFZpZXcuQ29tbWFuZHMuc2Nyb2xsVG9FbmQsXG4gICAgICBbYW5pbWF0ZWRdLFxuICAgICk7XG4gIH0sXG5cbiAgLyoqXG4gICAqIERlcHJlY2F0ZWQsIGRvIG5vdCB1c2UuXG4gICAqL1xuICBzY3JvbGxSZXNwb25kZXJTY3JvbGxXaXRob3V0QW5pbWF0aW9uVG86IGZ1bmN0aW9uKFxuICAgIG9mZnNldFg6IG51bWJlcixcbiAgICBvZmZzZXRZOiBudW1iZXIsXG4gICkge1xuICAgIGNvbnNvbGUud2FybihcbiAgICAgICdgc2Nyb2xsUmVzcG9uZGVyU2Nyb2xsV2l0aG91dEFuaW1hdGlvblRvYCBpcyBkZXByZWNhdGVkLiBVc2UgYHNjcm9sbFJlc3BvbmRlclNjcm9sbFRvYCBpbnN0ZWFkJyxcbiAgICApO1xuICAgIHRoaXMuc2Nyb2xsUmVzcG9uZGVyU2Nyb2xsVG8oe3g6IG9mZnNldFgsIHk6IG9mZnNldFksIGFuaW1hdGVkOiBmYWxzZX0pO1xuICB9LFxuXG4gIC8qKlxuICAgKiBBIGhlbHBlciBmdW5jdGlvbiB0byB6b29tIHRvIGEgc3BlY2lmaWMgcmVjdCBpbiB0aGUgc2Nyb2xsdmlldy4gVGhlIGFyZ3VtZW50IGhhcyB0aGUgc2hhcGVcbiAgICoge3g6IG51bWJlcjsgeTogbnVtYmVyOyB3aWR0aDogbnVtYmVyOyBoZWlnaHQ6IG51bWJlcjsgYW5pbWF0ZWQ6IGJvb2xlYW4gPSB0cnVlfVxuICAgKlxuICAgKiBAcGxhdGZvcm0gaW9zXG4gICAqL1xuICBzY3JvbGxSZXNwb25kZXJab29tVG86IGZ1bmN0aW9uKFxuICAgIHJlY3Q6IHt8XG4gICAgICB4OiBudW1iZXIsXG4gICAgICB5OiBudW1iZXIsXG4gICAgICB3aWR0aDogbnVtYmVyLFxuICAgICAgaGVpZ2h0OiBudW1iZXIsXG4gICAgICBhbmltYXRlZD86IGJvb2xlYW4sXG4gICAgfH0sXG4gICAgYW5pbWF0ZWQ/OiBib29sZWFuLCAvLyBkZXByZWNhdGVkLCBwdXQgdGhpcyBpbnNpZGUgdGhlIHJlY3QgYXJndW1lbnQgaW5zdGVhZFxuICApIHtcbiAgICBpbnZhcmlhbnQoXG4gICAgICBTY3JvbGxWaWV3TWFuYWdlciAmJiBTY3JvbGxWaWV3TWFuYWdlci56b29tVG9SZWN0LFxuICAgICAgJ3pvb21Ub1JlY3QgaXMgbm90IGltcGxlbWVudGVkJyxcbiAgICApO1xuICAgIGlmICgnYW5pbWF0ZWQnIGluIHJlY3QpIHtcbiAgICAgIGFuaW1hdGVkID0gcmVjdC5hbmltYXRlZDtcbiAgICAgIGRlbGV0ZSByZWN0LmFuaW1hdGVkO1xuICAgIH0gZWxzZSBpZiAodHlwZW9mIGFuaW1hdGVkICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgY29uc29sZS53YXJuKFxuICAgICAgICAnYHNjcm9sbFJlc3BvbmRlclpvb21Ub2AgYGFuaW1hdGVkYCBhcmd1bWVudCBpcyBkZXByZWNhdGVkLiBVc2UgYG9wdGlvbnMuYW5pbWF0ZWRgIGluc3RlYWQnLFxuICAgICAgKTtcbiAgICB9XG4gICAgU2Nyb2xsVmlld01hbmFnZXIuem9vbVRvUmVjdChcbiAgICAgIHRoaXMuc2Nyb2xsUmVzcG9uZGVyR2V0U2Nyb2xsYWJsZU5vZGUoKSxcbiAgICAgIHJlY3QsXG4gICAgICBhbmltYXRlZCAhPT0gZmFsc2UsXG4gICAgKTtcbiAgfSxcblxuICAvKipcbiAgICogRGlzcGxheXMgdGhlIHNjcm9sbCBpbmRpY2F0b3JzIG1vbWVudGFyaWx5LlxuICAgKi9cbiAgc2Nyb2xsUmVzcG9uZGVyRmxhc2hTY3JvbGxJbmRpY2F0b3JzOiBmdW5jdGlvbigpIHtcbiAgICBVSU1hbmFnZXIuZGlzcGF0Y2hWaWV3TWFuYWdlckNvbW1hbmQoXG4gICAgICB0aGlzLnNjcm9sbFJlc3BvbmRlckdldFNjcm9sbGFibGVOb2RlKCksXG4gICAgICBVSU1hbmFnZXIuUkNUU2Nyb2xsVmlldy5Db21tYW5kcy5mbGFzaFNjcm9sbEluZGljYXRvcnMsXG4gICAgICBbXSxcbiAgICApO1xuICB9LFxuXG4gIC8qKlxuICAgKiBUaGlzIG1ldGhvZCBzaG91bGQgYmUgdXNlZCBhcyB0aGUgY2FsbGJhY2sgdG8gb25Gb2N1cyBpbiBhIFRleHRJbnB1dHMnXG4gICAqIHBhcmVudCB2aWV3LiBOb3RlIHRoYXQgYW55IG1vZHVsZSB1c2luZyB0aGlzIG1peGluIG5lZWRzIHRvIHJldHVyblxuICAgKiB0aGUgcGFyZW50IHZpZXcncyByZWYgaW4gZ2V0U2Nyb2xsVmlld1JlZigpIGluIG9yZGVyIHRvIHVzZSB0aGlzIG1ldGhvZC5cbiAgICogQHBhcmFtIHthbnl9IG5vZGVIYW5kbGUgVGhlIFRleHRJbnB1dCBub2RlIGhhbmRsZVxuICAgKiBAcGFyYW0ge251bWJlcn0gYWRkaXRpb25hbE9mZnNldCBUaGUgc2Nyb2xsIHZpZXcncyBib3R0b20gXCJjb250ZW50SW5zZXRcIi5cbiAgICogICAgICAgIERlZmF1bHQgaXMgMC5cbiAgICogQHBhcmFtIHtib29sfSBwcmV2ZW50TmVnYXRpdmVTY3JvbGxpbmcgV2hldGhlciB0byBhbGxvdyBwdWxsaW5nIHRoZSBjb250ZW50XG4gICAqICAgICAgICBkb3duIHRvIG1ha2UgaXQgbWVldCB0aGUga2V5Ym9hcmQncyB0b3AuIERlZmF1bHQgaXMgZmFsc2UuXG4gICAqL1xuICBzY3JvbGxSZXNwb25kZXJTY3JvbGxOYXRpdmVIYW5kbGVUb0tleWJvYXJkOiBmdW5jdGlvbihcbiAgICBub2RlSGFuZGxlOiBhbnksXG4gICAgYWRkaXRpb25hbE9mZnNldD86IG51bWJlcixcbiAgICBwcmV2ZW50TmVnYXRpdmVTY3JvbGxPZmZzZXQ/OiBib29sZWFuLFxuICApIHtcbiAgICB0aGlzLmFkZGl0aW9uYWxTY3JvbGxPZmZzZXQgPSBhZGRpdGlvbmFsT2Zmc2V0IHx8IDA7XG4gICAgdGhpcy5wcmV2ZW50TmVnYXRpdmVTY3JvbGxPZmZzZXQgPSAhIXByZXZlbnROZWdhdGl2ZVNjcm9sbE9mZnNldDtcbiAgICBVSU1hbmFnZXIubWVhc3VyZUxheW91dChcbiAgICAgIG5vZGVIYW5kbGUsXG4gICAgICBSZWFjdE5hdGl2ZS5maW5kTm9kZUhhbmRsZSh0aGlzLmdldElubmVyVmlld05vZGUoKSksXG4gICAgICB0aGlzLnNjcm9sbFJlc3BvbmRlclRleHRJbnB1dEZvY3VzRXJyb3IsXG4gICAgICB0aGlzLnNjcm9sbFJlc3BvbmRlcklucHV0TWVhc3VyZUFuZFNjcm9sbFRvS2V5Ym9hcmQsXG4gICAgKTtcbiAgfSxcblxuICAvKipcbiAgICogVGhlIGNhbGN1bGF0aW9ucyBwZXJmb3JtZWQgaGVyZSBhc3N1bWUgdGhlIHNjcm9sbCB2aWV3IHRha2VzIHVwIHRoZSBlbnRpcmVcbiAgICogc2NyZWVuIC0gZXZlbiBpZiBoYXMgc29tZSBjb250ZW50IGluc2V0LiBXZSB0aGVuIG1lYXN1cmUgdGhlIG9mZnNldHMgb2YgdGhlXG4gICAqIGtleWJvYXJkLCBhbmQgY29tcGVuc2F0ZSBib3RoIGZvciB0aGUgc2Nyb2xsIHZpZXcncyBcImNvbnRlbnRJbnNldFwiLlxuICAgKlxuICAgKiBAcGFyYW0ge251bWJlcn0gbGVmdCBQb3NpdGlvbiBvZiBpbnB1dCB3LnIudC4gdGFibGUgdmlldy5cbiAgICogQHBhcmFtIHtudW1iZXJ9IHRvcCBQb3NpdGlvbiBvZiBpbnB1dCB3LnIudC4gdGFibGUgdmlldy5cbiAgICogQHBhcmFtIHtudW1iZXJ9IHdpZHRoIFdpZHRoIG9mIHRoZSB0ZXh0IGlucHV0LlxuICAgKiBAcGFyYW0ge251bWJlcn0gaGVpZ2h0IEhlaWdodCBvZiB0aGUgdGV4dCBpbnB1dC5cbiAgICovXG4gIHNjcm9sbFJlc3BvbmRlcklucHV0TWVhc3VyZUFuZFNjcm9sbFRvS2V5Ym9hcmQ6IGZ1bmN0aW9uKFxuICAgIGxlZnQ6IG51bWJlcixcbiAgICB0b3A6IG51bWJlcixcbiAgICB3aWR0aDogbnVtYmVyLFxuICAgIGhlaWdodDogbnVtYmVyLFxuICApIHtcbiAgICBsZXQga2V5Ym9hcmRTY3JlZW5ZID0gRGltZW5zaW9ucy5nZXQoJ3dpbmRvdycpLmhlaWdodDtcbiAgICBpZiAodGhpcy5rZXlib2FyZFdpbGxPcGVuVG8pIHtcbiAgICAgIGtleWJvYXJkU2NyZWVuWSA9IHRoaXMua2V5Ym9hcmRXaWxsT3BlblRvLmVuZENvb3JkaW5hdGVzLnNjcmVlblk7XG4gICAgfVxuICAgIGxldCBzY3JvbGxPZmZzZXRZID1cbiAgICAgIHRvcCAtIGtleWJvYXJkU2NyZWVuWSArIGhlaWdodCArIHRoaXMuYWRkaXRpb25hbFNjcm9sbE9mZnNldDtcblxuICAgIC8vIEJ5IGRlZmF1bHQsIHRoaXMgY2FuIHNjcm9sbCB3aXRoIG5lZ2F0aXZlIG9mZnNldCwgcHVsbGluZyB0aGUgY29udGVudFxuICAgIC8vIGRvd24gc28gdGhhdCB0aGUgdGFyZ2V0IGNvbXBvbmVudCdzIGJvdHRvbSBtZWV0cyB0aGUga2V5Ym9hcmQncyB0b3AuXG4gICAgLy8gSWYgcmVxdWVzdGVkIG90aGVyd2lzZSwgY2FwIHRoZSBvZmZzZXQgYXQgMCBtaW5pbXVtIHRvIGF2b2lkIGNvbnRlbnRcbiAgICAvLyBzaGlmdGluZyBkb3duLlxuICAgIGlmICh0aGlzLnByZXZlbnROZWdhdGl2ZVNjcm9sbE9mZnNldCkge1xuICAgICAgc2Nyb2xsT2Zmc2V0WSA9IE1hdGgubWF4KDAsIHNjcm9sbE9mZnNldFkpO1xuICAgIH1cbiAgICB0aGlzLnNjcm9sbFJlc3BvbmRlclNjcm9sbFRvKHt4OiAwLCB5OiBzY3JvbGxPZmZzZXRZLCBhbmltYXRlZDogdHJ1ZX0pO1xuXG4gICAgdGhpcy5hZGRpdGlvbmFsT2Zmc2V0ID0gMDtcbiAgICB0aGlzLnByZXZlbnROZWdhdGl2ZVNjcm9sbE9mZnNldCA9IGZhbHNlO1xuICB9LFxuXG4gIHNjcm9sbFJlc3BvbmRlclRleHRJbnB1dEZvY3VzRXJyb3I6IGZ1bmN0aW9uKGU6IEV2ZW50KSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgbWVhc3VyaW5nIHRleHQgZmllbGQ6ICcsIGUpO1xuICB9LFxuXG4gIC8qKlxuICAgKiBgY29tcG9uZW50V2lsbE1vdW50YCBpcyB0aGUgY2xvc2VzdCB0aGluZyB0byBhICBzdGFuZGFyZCBcImNvbnN0cnVjdG9yXCIgZm9yXG4gICAqIFJlYWN0IGNvbXBvbmVudHMuXG4gICAqXG4gICAqIFRoZSBga2V5Ym9hcmRXaWxsU2hvd2AgaXMgY2FsbGVkIGJlZm9yZSBpbnB1dCBmb2N1cy5cbiAgICovXG4gIFVOU0FGRV9jb21wb25lbnRXaWxsTW91bnQ6IGZ1bmN0aW9uKCkge1xuICAgIGNvbnN0IHtrZXlib2FyZFNob3VsZFBlcnNpc3RUYXBzfSA9IHRoaXMucHJvcHM7XG4gICAgd2FybmluZyhcbiAgICAgIHR5cGVvZiBrZXlib2FyZFNob3VsZFBlcnNpc3RUYXBzICE9PSAnYm9vbGVhbicsXG4gICAgICBgJ2tleWJvYXJkU2hvdWxkUGVyc2lzdFRhcHM9eyR7a2V5Ym9hcmRTaG91bGRQZXJzaXN0VGFwc319JyBpcyBkZXByZWNhdGVkLiBgICtcbiAgICAgICAgYFVzZSAna2V5Ym9hcmRTaG91bGRQZXJzaXN0VGFwcz1cIiR7XG4gICAgICAgICAga2V5Ym9hcmRTaG91bGRQZXJzaXN0VGFwcyA/ICdhbHdheXMnIDogJ25ldmVyJ1xuICAgICAgICB9XCInIGluc3RlYWRgLFxuICAgICk7XG5cbiAgICB0aGlzLmtleWJvYXJkV2lsbE9wZW5UbyA9IG51bGw7XG4gICAgdGhpcy5hZGRpdGlvbmFsU2Nyb2xsT2Zmc2V0ID0gMDtcbiAgICB0aGlzLmFkZExpc3RlbmVyT24oXG4gICAgICBLZXlib2FyZCxcbiAgICAgICdrZXlib2FyZFdpbGxTaG93JyxcbiAgICAgIHRoaXMuc2Nyb2xsUmVzcG9uZGVyS2V5Ym9hcmRXaWxsU2hvdyxcbiAgICApO1xuICAgIHRoaXMuYWRkTGlzdGVuZXJPbihcbiAgICAgIEtleWJvYXJkLFxuICAgICAgJ2tleWJvYXJkV2lsbEhpZGUnLFxuICAgICAgdGhpcy5zY3JvbGxSZXNwb25kZXJLZXlib2FyZFdpbGxIaWRlLFxuICAgICk7XG4gICAgdGhpcy5hZGRMaXN0ZW5lck9uKFxuICAgICAgS2V5Ym9hcmQsXG4gICAgICAna2V5Ym9hcmREaWRTaG93JyxcbiAgICAgIHRoaXMuc2Nyb2xsUmVzcG9uZGVyS2V5Ym9hcmREaWRTaG93LFxuICAgICk7XG4gICAgdGhpcy5hZGRMaXN0ZW5lck9uKFxuICAgICAgS2V5Ym9hcmQsXG4gICAgICAna2V5Ym9hcmREaWRIaWRlJyxcbiAgICAgIHRoaXMuc2Nyb2xsUmVzcG9uZGVyS2V5Ym9hcmREaWRIaWRlLFxuICAgICk7XG4gIH0sXG5cbiAgLyoqXG4gICAqIFdhcm5pbmcsIHRoaXMgbWF5IGJlIGNhbGxlZCBzZXZlcmFsIHRpbWVzIGZvciBhIHNpbmdsZSBrZXlib2FyZCBvcGVuaW5nLlxuICAgKiBJdCdzIGJlc3QgdG8gc3RvcmUgdGhlIGluZm9ybWF0aW9uIGluIHRoaXMgbWV0aG9kIGFuZCB0aGVuIHRha2UgYW55IGFjdGlvblxuICAgKiBhdCBhIGxhdGVyIHBvaW50IChlaXRoZXIgaW4gYGtleWJvYXJkRGlkU2hvd2Agb3Igb3RoZXIpLlxuICAgKlxuICAgKiBIZXJlJ3MgdGhlIG9yZGVyIHRoYXQgZXZlbnRzIG9jY3VyIGluOlxuICAgKiAtIGZvY3VzXG4gICAqIC0gd2lsbFNob3cge3N0YXJ0Q29vcmRpbmF0ZXMsIGVuZENvb3JkaW5hdGVzfSBzZXZlcmFsIHRpbWVzXG4gICAqIC0gZGlkU2hvdyBzZXZlcmFsIHRpbWVzXG4gICAqIC0gYmx1clxuICAgKiAtIHdpbGxIaWRlIHtzdGFydENvb3JkaW5hdGVzLCBlbmRDb29yZGluYXRlc30gc2V2ZXJhbCB0aW1lc1xuICAgKiAtIGRpZEhpZGUgc2V2ZXJhbCB0aW1lc1xuICAgKlxuICAgKiBUaGUgYFNjcm9sbFJlc3BvbmRlcmAgbW9kdWxlIGNhbGxiYWNrcyBmb3IgZWFjaCBvZiB0aGVzZSBldmVudHMuXG4gICAqIEV2ZW4gdGhvdWdoIGFueSB1c2VyIGNvdWxkIGhhdmUgZWFzaWx5IGxpc3RlbmVkIHRvIGtleWJvYXJkIGV2ZW50c1xuICAgKiB0aGVtc2VsdmVzLCB1c2luZyB0aGVzZSBgcHJvcHNgIGNhbGxiYWNrcyBlbnN1cmVzIHRoYXQgb3JkZXJpbmcgb2YgZXZlbnRzXG4gICAqIGlzIGNvbnNpc3RlbnQgLSBhbmQgbm90IGRlcGVuZGVudCBvbiB0aGUgb3JkZXIgdGhhdCB0aGUga2V5Ym9hcmQgZXZlbnRzIGFyZVxuICAgKiBzdWJzY3JpYmVkIHRvLiBUaGlzIG1hdHRlcnMgd2hlbiB0ZWxsaW5nIHRoZSBzY3JvbGwgdmlldyB0byBzY3JvbGwgdG8gd2hlcmVcbiAgICogdGhlIGtleWJvYXJkIGlzIGhlYWRlZCAtIHRoZSBzY3JvbGwgcmVzcG9uZGVyIGJldHRlciBoYXZlIGJlZW4gbm90aWZpZWQgb2ZcbiAgICogdGhlIGtleWJvYXJkIGRlc3RpbmF0aW9uIGJlZm9yZSBiZWluZyBpbnN0cnVjdGVkIHRvIHNjcm9sbCB0byB3aGVyZSB0aGVcbiAgICoga2V5Ym9hcmQgd2lsbCBiZS4gU3RpY2sgdG8gdGhlIGBTY3JvbGxSZXNwb25kZXJgIGNhbGxiYWNrcywgYW5kIGV2ZXJ5dGhpbmdcbiAgICogd2lsbCB3b3JrLlxuICAgKlxuICAgKiBXQVJOSU5HOiBUaGVzZSBjYWxsYmFja3Mgd2lsbCBmaXJlIGV2ZW4gaWYgYSBrZXlib2FyZCBpcyBkaXNwbGF5ZWQgaW4gYVxuICAgKiBkaWZmZXJlbnQgbmF2aWdhdGlvbiBwYW5lLiBGaWx0ZXIgb3V0IHRoZSBldmVudHMgdG8gZGV0ZXJtaW5lIGlmIHRoZXkgYXJlXG4gICAqIHJlbGV2YW50IHRvIHlvdS4gKEZvciBleGFtcGxlLCBvbmx5IGlmIHlvdSByZWNlaXZlIHRoZXNlIGNhbGxiYWNrcyBhZnRlclxuICAgKiB5b3UgaGFkIGV4cGxpY2l0bHkgZm9jdXNlZCBhIG5vZGUgZXRjKS5cbiAgICovXG4gIHNjcm9sbFJlc3BvbmRlcktleWJvYXJkV2lsbFNob3c6IGZ1bmN0aW9uKGU6IEV2ZW50KSB7XG4gICAgdGhpcy5rZXlib2FyZFdpbGxPcGVuVG8gPSBlO1xuICAgIHRoaXMucHJvcHMub25LZXlib2FyZFdpbGxTaG93ICYmIHRoaXMucHJvcHMub25LZXlib2FyZFdpbGxTaG93KGUpO1xuICB9LFxuXG4gIHNjcm9sbFJlc3BvbmRlcktleWJvYXJkV2lsbEhpZGU6IGZ1bmN0aW9uKGU6IEV2ZW50KSB7XG4gICAgdGhpcy5rZXlib2FyZFdpbGxPcGVuVG8gPSBudWxsO1xuICAgIHRoaXMucHJvcHMub25LZXlib2FyZFdpbGxIaWRlICYmIHRoaXMucHJvcHMub25LZXlib2FyZFdpbGxIaWRlKGUpO1xuICB9LFxuXG4gIHNjcm9sbFJlc3BvbmRlcktleWJvYXJkRGlkU2hvdzogZnVuY3Rpb24oZTogRXZlbnQpIHtcbiAgICAvLyBUT0RPKDc2OTM5NjEpOiBUaGUgZXZlbnQgZm9yIERpZFNob3cgaXMgbm90IGF2YWlsYWJsZSBvbiBpT1MgeWV0LlxuICAgIC8vIFVzZSB0aGUgb25lIGZyb20gV2lsbFNob3cgYW5kIGRvIG5vdCBhc3NpZ24uXG4gICAgaWYgKGUpIHtcbiAgICAgIHRoaXMua2V5Ym9hcmRXaWxsT3BlblRvID0gZTtcbiAgICB9XG4gICAgdGhpcy5wcm9wcy5vbktleWJvYXJkRGlkU2hvdyAmJiB0aGlzLnByb3BzLm9uS2V5Ym9hcmREaWRTaG93KGUpO1xuICB9LFxuXG4gIHNjcm9sbFJlc3BvbmRlcktleWJvYXJkRGlkSGlkZTogZnVuY3Rpb24oZTogRXZlbnQpIHtcbiAgICB0aGlzLmtleWJvYXJkV2lsbE9wZW5UbyA9IG51bGw7XG4gICAgdGhpcy5wcm9wcy5vbktleWJvYXJkRGlkSGlkZSAmJiB0aGlzLnByb3BzLm9uS2V5Ym9hcmREaWRIaWRlKGUpO1xuICB9LFxufTtcblxuY29uc3QgU2Nyb2xsUmVzcG9uZGVyID0ge1xuICBNaXhpbjogU2Nyb2xsUmVzcG9uZGVyTWl4aW4sXG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IFNjcm9sbFJlc3BvbmRlcjtcbiJdfQ==