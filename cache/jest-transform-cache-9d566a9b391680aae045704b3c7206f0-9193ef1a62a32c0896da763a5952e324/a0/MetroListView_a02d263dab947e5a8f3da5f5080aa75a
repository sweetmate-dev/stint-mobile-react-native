168cfc951b31a484fa5a26ac33f41c8b









'use strict';var _extends = Object.assign || function (target) {for (var i = 1; i < arguments.length; i++) {var source = arguments[i];for (var key in source) {if (Object.prototype.hasOwnProperty.call(source, key)) {target[key] = source[key];}}}return target;};var _createClass = function () {function defineProperties(target, props) {for (var i = 0; i < props.length; i++) {var descriptor = props[i];descriptor.enumerable = descriptor.enumerable || false;descriptor.configurable = true;if ("value" in descriptor) descriptor.writable = true;Object.defineProperty(target, descriptor.key, descriptor);}}return function (Constructor, protoProps, staticProps) {if (protoProps) defineProperties(Constructor.prototype, protoProps);if (staticProps) defineProperties(Constructor, staticProps);return Constructor;};}();function _classCallCheck(instance, Constructor) {if (!(instance instanceof Constructor)) {throw new TypeError("Cannot call a class as a function");}}function _possibleConstructorReturn(self, call) {if (!self) {throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call && (typeof call === "object" || typeof call === "function") ? call : self;}function _inherits(subClass, superClass) {if (typeof superClass !== "function" && superClass !== null) {throw new TypeError("Super expression must either be null or a function, not " + typeof superClass);}subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } });if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;}

var ListView = require('ListView');
var React = require('React');
var RefreshControl = require('RefreshControl');
var ScrollView = require('ScrollView');

var invariant = require('fbjs/lib/invariant');var









































MetroListView = function (_React$Component) {_inherits(MetroListView, _React$Component);function MetroListView() {var _ref,_this2 = this;var _temp, _this, _ret;_classCallCheck(this, MetroListView);for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {args[_key] = arguments[_key];}return _ret = (_temp = (_this = _possibleConstructorReturn(this, (_ref = MetroListView.__proto__ || Object.getPrototypeOf(MetroListView)).call.apply(_ref, [this].concat(args))), _this), _this.



































































    state = _this._computeState(_this.props, {
      ds: new ListView.DataSource({
        rowHasChanged: function rowHasChanged(itemA, itemB) {return true;},
        sectionHeaderHasChanged: function sectionHeaderHasChanged() {return true;},
        getSectionHeaderData: function getSectionHeaderData(dataBlob, sectionID) {return (
            _this.state.sectionHeaderData[sectionID]);} }),

      sectionHeaderData: {} }), _this.



















    _captureRef = function (ref) {
      _this._listRef = ref;
    }, _this.


























    _renderFooter = function () {return React.createElement(_this2.props.FooterComponent, { key: '$footer' });}, _this.
    _renderRow = function (item, sectionID, rowID, highlightRow) {
      return _this.props.renderItem({ item: item, index: rowID });
    }, _this.
    _renderSectionHeader = function (section, sectionID) {var
      renderSectionHeader = _this.props.renderSectionHeader;
      invariant(
      renderSectionHeader,
      'Must provide renderSectionHeader with sections prop');

      return renderSectionHeader({ section: section });
    }, _this.
    _renderSeparator = function (sID, rID) {return (



        React.createElement(_this2.props.SeparatorComponent, { key: sID + rID }));}, _temp), _possibleConstructorReturn(_this, _ret);}_createClass(MetroListView, [{ key: 'scrollToEnd', value: function scrollToEnd(params) {throw new Error('scrollToEnd not supported in legacy ListView.');} }, { key: 'scrollToIndex', value: function scrollToIndex(params) {throw new Error('scrollToIndex not supported in legacy ListView.');} }, { key: 'scrollToItem', value: function scrollToItem(params) {throw new Error('scrollToItem not supported in legacy ListView.');} }, { key: 'scrollToLocation', value: function scrollToLocation(params) {throw new Error('scrollToLocation not supported in legacy ListView.');} }, { key: 'scrollToOffset', value: function scrollToOffset(params) {var animated = params.animated,offset = params.offset;this._listRef.scrollTo(this.props.horizontal ? { x: offset, animated: animated } : { y: offset, animated: animated });} }, { key: 'getListRef', value: function getListRef() {return this._listRef;} }, { key: 'setNativeProps', value: function setNativeProps(props) {if (this._listRef) {this._listRef.setNativeProps(props);}} }, { key: 'UNSAFE_componentWillReceiveProps', value: function UNSAFE_componentWillReceiveProps(newProps) {var _this3 = this;this.setState(function (state) {return _this3._computeState(newProps, state);});} }, { key: 'render', value: function render() {return React.createElement(ListView, _extends({}, this.props, { dataSource: this.state.ds, ref: this._captureRef, renderRow: this._renderRow, renderFooter: this.props.FooterComponent && this._renderFooter, renderSectionHeader: this.props.sections && this._renderSectionHeader, renderSeparator: this.props.SeparatorComponent && this._renderSeparator }));} }, { key: '_computeState', value: function _computeState(props, state) {var sectionHeaderData = {};if (props.sections) {invariant(!props.items, 'Cannot have both sections and items props.');var _sections = {};props.sections.forEach(function (sectionIn, ii) {var sectionID = 's' + ii;_sections[sectionID] = sectionIn.data;sectionHeaderData[sectionID] = sectionIn;});return { ds: state.ds.cloneWithRowsAndSections(_sections), sectionHeaderData: sectionHeaderData };} else {invariant(!props.sections, 'Cannot have both sections and items props.');return { ds: state.ds.cloneWithRows(props.items), sectionHeaderData: sectionHeaderData };}} }]);return MetroListView;}(React.Component);MetroListView.defaultProps = { keyExtractor: function keyExtractor(item, index) {return item.key || String(index);}, renderScrollComponent: function renderScrollComponent(props) {if (props.onRefresh) {return React.createElement(ScrollView, _extends({}, props, { refreshControl: React.createElement(RefreshControl, { refreshing: props.refreshing, onRefresh: props.onRefresh }) }));} else {return React.createElement(ScrollView, props);}} };



module.exports = MetroListView;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIk1ldHJvTGlzdFZpZXcuanMiXSwibmFtZXMiOlsiTGlzdFZpZXciLCJyZXF1aXJlIiwiUmVhY3QiLCJSZWZyZXNoQ29udHJvbCIsIlNjcm9sbFZpZXciLCJpbnZhcmlhbnQiLCJNZXRyb0xpc3RWaWV3Iiwic3RhdGUiLCJfY29tcHV0ZVN0YXRlIiwicHJvcHMiLCJkcyIsIkRhdGFTb3VyY2UiLCJyb3dIYXNDaGFuZ2VkIiwiaXRlbUEiLCJpdGVtQiIsInNlY3Rpb25IZWFkZXJIYXNDaGFuZ2VkIiwiZ2V0U2VjdGlvbkhlYWRlckRhdGEiLCJkYXRhQmxvYiIsInNlY3Rpb25JRCIsInNlY3Rpb25IZWFkZXJEYXRhIiwiX2NhcHR1cmVSZWYiLCJfbGlzdFJlZiIsInJlZiIsIl9yZW5kZXJGb290ZXIiLCJfcmVuZGVyUm93IiwiaXRlbSIsInJvd0lEIiwiaGlnaGxpZ2h0Um93IiwicmVuZGVySXRlbSIsImluZGV4IiwiX3JlbmRlclNlY3Rpb25IZWFkZXIiLCJzZWN0aW9uIiwicmVuZGVyU2VjdGlvbkhlYWRlciIsIl9yZW5kZXJTZXBhcmF0b3IiLCJzSUQiLCJySUQiLCJwYXJhbXMiLCJFcnJvciIsImFuaW1hdGVkIiwib2Zmc2V0Iiwic2Nyb2xsVG8iLCJob3Jpem9udGFsIiwieCIsInkiLCJzZXROYXRpdmVQcm9wcyIsIm5ld1Byb3BzIiwic2V0U3RhdGUiLCJGb290ZXJDb21wb25lbnQiLCJzZWN0aW9ucyIsIlNlcGFyYXRvckNvbXBvbmVudCIsIml0ZW1zIiwiZm9yRWFjaCIsInNlY3Rpb25JbiIsImlpIiwiZGF0YSIsImNsb25lV2l0aFJvd3NBbmRTZWN0aW9ucyIsImNsb25lV2l0aFJvd3MiLCJDb21wb25lbnQiLCJkZWZhdWx0UHJvcHMiLCJrZXlFeHRyYWN0b3IiLCJrZXkiLCJTdHJpbmciLCJyZW5kZXJTY3JvbGxDb21wb25lbnQiLCJvblJlZnJlc2giLCJyZWZyZXNoaW5nIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBU0EsYTs7QUFFQSxJQUFNQSxXQUFXQyxRQUFRLFVBQVIsQ0FBakI7QUFDQSxJQUFNQyxRQUFRRCxRQUFRLE9BQVIsQ0FBZDtBQUNBLElBQU1FLGlCQUFpQkYsUUFBUSxnQkFBUixDQUF2QjtBQUNBLElBQU1HLGFBQWFILFFBQVEsWUFBUixDQUFuQjs7QUFFQSxJQUFNSSxZQUFZSixRQUFRLG9CQUFSLENBQWxCLEM7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQTBDTUssYTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFvRUpDLFMsR0FBUSxNQUFLQyxhQUFMLENBQW1CLE1BQUtDLEtBQXhCLEVBQStCO0FBQ3JDQyxVQUFJLElBQUlWLFNBQVNXLFVBQWIsQ0FBd0I7QUFDMUJDLHVCQUFlLHVCQUFDQyxLQUFELEVBQVFDLEtBQVIsVUFBa0IsSUFBbEIsRUFEVztBQUUxQkMsaUNBQXlCLDJDQUFNLElBQU4sRUFGQztBQUcxQkMsOEJBQXNCLDhCQUFDQyxRQUFELEVBQVdDLFNBQVg7QUFDcEIsa0JBQUtYLEtBQUwsQ0FBV1ksaUJBQVgsQ0FBNkJELFNBQTdCLENBRG9CLEdBSEksRUFBeEIsQ0FEaUM7O0FBT3JDQyx5QkFBbUIsRUFQa0IsRUFBL0IsQzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUEyQlJDLGUsR0FBYyxlQUFPO0FBQ25CLFlBQUtDLFFBQUwsR0FBZ0JDLEdBQWhCO0FBQ0QsSzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBMkJEQyxpQixHQUFnQixvQkFBTSwyQkFBTSxLQUFOLENBQVksZUFBWixJQUE0QixLQUFJLFNBQWhDLEdBQU4sRTtBQUNoQkMsYyxHQUFhLFVBQUNDLElBQUQsRUFBT1AsU0FBUCxFQUFrQlEsS0FBbEIsRUFBeUJDLFlBQXpCLEVBQTBDO0FBQ3JELGFBQU8sTUFBS2xCLEtBQUwsQ0FBV21CLFVBQVgsQ0FBc0IsRUFBQ0gsVUFBRCxFQUFPSSxPQUFPSCxLQUFkLEVBQXRCLENBQVA7QUFDRCxLO0FBQ0RJLHdCLEdBQXVCLFVBQUNDLE9BQUQsRUFBVWIsU0FBVixFQUF3QjtBQUN0Q2MseUJBRHNDLEdBQ2YsTUFBS3ZCLEtBRFUsQ0FDdEN1QixtQkFEc0M7QUFFN0MzQjtBQUNFMkIseUJBREY7QUFFRSwyREFGRjs7QUFJQSxhQUFPQSxvQkFBb0IsRUFBQ0QsZ0JBQUQsRUFBcEIsQ0FBUDtBQUNELEs7QUFDREUsb0IsR0FBbUIsVUFBQ0MsR0FBRCxFQUFNQyxHQUFOOzs7O0FBSWpCLG1DQUFNLEtBQU4sQ0FBWSxrQkFBWixJQUErQixLQUFLRCxNQUFNQyxHQUExQyxHQUppQixHLGtJQXZJUEMsTSxFQUFpQyxDQUMzQyxNQUFNLElBQUlDLEtBQUosQ0FBVSwrQ0FBVixDQUFOLENBQ0QsQywwREFDYUQsTSxFQUlYLENBQ0QsTUFBTSxJQUFJQyxLQUFKLENBQVUsaURBQVYsQ0FBTixDQUNELEMsd0RBQ1lELE0sRUFJVixDQUNELE1BQU0sSUFBSUMsS0FBSixDQUFVLGdEQUFWLENBQU4sQ0FDRCxDLGdFQUNnQkQsTSxFQU1kLENBQ0QsTUFBTSxJQUFJQyxLQUFKLENBQVUsb0RBQVYsQ0FBTixDQUNELEMsNERBQ2NELE0sRUFBK0MsS0FDckRFLFFBRHFELEdBQ2pDRixNQURpQyxDQUNyREUsUUFEcUQsQ0FDM0NDLE1BRDJDLEdBQ2pDSCxNQURpQyxDQUMzQ0csTUFEMkMsQ0FHNUQsS0FBS2xCLFFBQUwsQ0FBY21CLFFBQWQsQ0FDRSxLQUFLL0IsS0FBTCxDQUFXZ0MsVUFBWCxHQUF3QixFQUFDQyxHQUFHSCxNQUFKLEVBQVlELGtCQUFaLEVBQXhCLEdBQWdELEVBQUNLLEdBQUdKLE1BQUosRUFBWUQsa0JBQVosRUFEbEQsRUFHRCxDLHNEQUNZLENBQ1gsT0FBTyxLQUFLakIsUUFBWixDQUNELEMsNERBQ2NaLEssRUFBZSxDQUM1QixJQUFJLEtBQUtZLFFBQVQsRUFBbUIsQ0FDakIsS0FBS0EsUUFBTCxDQUFjdUIsY0FBZCxDQUE2Qm5DLEtBQTdCLEVBQ0QsQ0FDRixDLGdHQW9DZ0NvQyxRLEVBQWlCLG1CQUNoRCxLQUFLQyxRQUFMLENBQWMseUJBQVMsT0FBS3RDLGFBQUwsQ0FBbUJxQyxRQUFuQixFQUE2QnRDLEtBQTdCLENBQVQsRUFBZCxFQUNELEMsOENBQ1EsQ0FDUCxPQUVFLG9CQUFDLFFBQUQsZUFDTSxLQUFLRSxLQURYLElBRUUsWUFBWSxLQUFLRixLQUFMLENBQVdHLEVBRnpCLEVBR0UsS0FBSyxLQUFLVSxXQUhaLEVBSUUsV0FBVyxLQUFLSSxVQUpsQixFQUtFLGNBQWMsS0FBS2YsS0FBTCxDQUFXc0MsZUFBWCxJQUE4QixLQUFLeEIsYUFMbkQsRUFNRSxxQkFBcUIsS0FBS2QsS0FBTCxDQUFXdUMsUUFBWCxJQUF1QixLQUFLbEIsb0JBTm5ELEVBT0UsaUJBQWlCLEtBQUtyQixLQUFMLENBQVd3QyxrQkFBWCxJQUFpQyxLQUFLaEIsZ0JBUHpELElBRkYsQ0FZRCxDLDBEQUtheEIsSyxFQUFjRixLLEVBQU8sQ0FDakMsSUFBTVksb0JBQW9CLEVBQTFCLENBQ0EsSUFBSVYsTUFBTXVDLFFBQVYsRUFBb0IsQ0FDbEIzQyxVQUFVLENBQUNJLE1BQU15QyxLQUFqQixFQUF3Qiw0Q0FBeEIsRUFDQSxJQUFNRixZQUFXLEVBQWpCLENBQ0F2QyxNQUFNdUMsUUFBTixDQUFlRyxPQUFmLENBQXVCLFVBQUNDLFNBQUQsRUFBWUMsRUFBWixFQUFtQixDQUN4QyxJQUFNbkMsWUFBWSxNQUFNbUMsRUFBeEIsQ0FDQUwsVUFBUzlCLFNBQVQsSUFBc0JrQyxVQUFVRSxJQUFoQyxDQUNBbkMsa0JBQWtCRCxTQUFsQixJQUErQmtDLFNBQS9CLENBQ0QsQ0FKRCxFQUtBLE9BQU8sRUFDTDFDLElBQUlILE1BQU1HLEVBQU4sQ0FBUzZDLHdCQUFULENBQWtDUCxTQUFsQyxDQURDLEVBRUw3QixvQ0FGSyxFQUFQLENBSUQsQ0FaRCxNQVlPLENBQ0xkLFVBQVUsQ0FBQ0ksTUFBTXVDLFFBQWpCLEVBQTJCLDRDQUEzQixFQUNBLE9BQU8sRUFFTHRDLElBQUlILE1BQU1HLEVBQU4sQ0FBUzhDLGFBQVQsQ0FBdUIvQyxNQUFNeUMsS0FBN0IsQ0FGQyxFQUdML0Isb0NBSEssRUFBUCxDQUtELENBQ0YsQyw0QkF4SHlCakIsTUFBTXVELFMsRUFBNUJuRCxhLENBMENHb0QsWSxHQUE2QixFQUNsQ0MsY0FBYyxzQkFBQ2xDLElBQUQsRUFBT0ksS0FBUCxVQUFpQkosS0FBS21DLEdBQUwsSUFBWUMsT0FBT2hDLEtBQVAsQ0FBN0IsRUFEb0IsRUFFbENpQyx1QkFBdUIsK0JBQUNyRCxLQUFELEVBQWtCLENBQ3ZDLElBQUlBLE1BQU1zRCxTQUFWLEVBQXFCLENBQ25CLE9BRUUsb0JBQUMsVUFBRCxlQUNNdEQsS0FETixJQUVFLGdCQUtFLG9CQUFDLGNBQUQsSUFDRSxZQUFZQSxNQUFNdUQsVUFEcEIsRUFFRSxXQUFXdkQsTUFBTXNELFNBRm5CLEdBUEosSUFGRixDQWdCRCxDQWpCRCxNQWlCTyxDQUVMLE9BQU8sb0JBQUMsVUFBRCxFQUFnQnRELEtBQWhCLENBQVAsQ0FDRCxDQUNGLENBeEJpQyxFOzs7O0FBc0d0Q3dELE9BQU9DLE9BQVAsR0FBaUI1RCxhQUFqQiIsImZpbGUiOiJNZXRyb0xpc3RWaWV3LmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTUtcHJlc2VudCwgRmFjZWJvb2ssIEluYy5cbiAqXG4gKiBUaGlzIHNvdXJjZSBjb2RlIGlzIGxpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZSBmb3VuZCBpbiB0aGVcbiAqIExJQ0VOU0UgZmlsZSBpbiB0aGUgcm9vdCBkaXJlY3Rvcnkgb2YgdGhpcyBzb3VyY2UgdHJlZS5cbiAqXG4gKiBAZmxvd1xuICogQGZvcm1hdFxuICovXG4ndXNlIHN0cmljdCc7XG5cbmNvbnN0IExpc3RWaWV3ID0gcmVxdWlyZSgnTGlzdFZpZXcnKTtcbmNvbnN0IFJlYWN0ID0gcmVxdWlyZSgnUmVhY3QnKTtcbmNvbnN0IFJlZnJlc2hDb250cm9sID0gcmVxdWlyZSgnUmVmcmVzaENvbnRyb2wnKTtcbmNvbnN0IFNjcm9sbFZpZXcgPSByZXF1aXJlKCdTY3JvbGxWaWV3Jyk7XG5cbmNvbnN0IGludmFyaWFudCA9IHJlcXVpcmUoJ2ZianMvbGliL2ludmFyaWFudCcpO1xuXG50eXBlIEl0ZW0gPSBhbnk7XG5cbnR5cGUgTm9ybWFsUHJvcHMgPSB7XG4gIEZvb3RlckNvbXBvbmVudD86IFJlYWN0LkNvbXBvbmVudFR5cGU8Kj4sXG4gIHJlbmRlckl0ZW06IChpbmZvOiBPYmplY3QpID0+ID9SZWFjdC5FbGVtZW50PGFueT4sXG4gIC8qICRGbG93Rml4TWUoPj0wLjUzLjAgc2l0ZT1yZWFjdF9uYXRpdmVfZmIscmVhY3RfbmF0aXZlX29zcykgVGhpcyBjb21tZW50XG4gICAqIHN1cHByZXNzZXMgYW4gZXJyb3Igd2hlbiB1cGdyYWRpbmcgRmxvdydzIHN1cHBvcnQgZm9yIFJlYWN0LiBUbyBzZWUgdGhlXG4gICAqIGVycm9yIGRlbGV0ZSB0aGlzIGNvbW1lbnQgYW5kIHJ1biBGbG93LiAqL1xuICByZW5kZXJTZWN0aW9uSGVhZGVyPzogKHtzZWN0aW9uOiBPYmplY3R9KSA9PiA/UmVhY3QuRWxlbWVudDxhbnk+LFxuICBTZXBhcmF0b3JDb21wb25lbnQ/OiA/UmVhY3QuQ29tcG9uZW50VHlwZTwqPiwgLy8gbm90IHN1cHBvcnRlZCB5ZXRcblxuICAvLyBQcm92aWRlIGVpdGhlciBgaXRlbXNgIG9yIGBzZWN0aW9uc2BcbiAgaXRlbXM/OiA/QXJyYXk8SXRlbT4sIC8vIEJ5IGRlZmF1bHQsIGFuIEl0ZW0gaXMgYXNzdW1lZCB0byBiZSB7a2V5OiBzdHJpbmd9XG4gIC8vICRGbG93Rml4TWUgLSBTb21ldGhpbmcgaXMgYSBsaXR0bGUgb2ZmIHdpdGggdGhlIHR5cGUgQXJyYXk8SXRlbT5cbiAgc2VjdGlvbnM/OiA/QXJyYXk8e2tleTogc3RyaW5nLCBkYXRhOiBBcnJheTxJdGVtPn0+LFxuXG4gIC8qKlxuICAgKiBJZiBwcm92aWRlZCwgYSBzdGFuZGFyZCBSZWZyZXNoQ29udHJvbCB3aWxsIGJlIGFkZGVkIGZvciBcIlB1bGwgdG8gUmVmcmVzaFwiIGZ1bmN0aW9uYWxpdHkuIE1ha2VcbiAgICogc3VyZSB0byBhbHNvIHNldCB0aGUgYHJlZnJlc2hpbmdgIHByb3AgY29ycmVjdGx5LlxuICAgKi9cbiAgb25SZWZyZXNoPzogP0Z1bmN0aW9uLFxuICAvKipcbiAgICogU2V0IHRoaXMgdHJ1ZSB3aGlsZSB3YWl0aW5nIGZvciBuZXcgZGF0YSBmcm9tIGEgcmVmcmVzaC5cbiAgICovXG4gIHJlZnJlc2hpbmc/OiBib29sZWFuLFxuICAvKipcbiAgICogSWYgdHJ1ZSwgcmVuZGVycyBpdGVtcyBuZXh0IHRvIGVhY2ggb3RoZXIgaG9yaXpvbnRhbGx5IGluc3RlYWQgb2Ygc3RhY2tlZCB2ZXJ0aWNhbGx5LlxuICAgKi9cbiAgaG9yaXpvbnRhbD86ID9ib29sZWFuLFxufTtcbnR5cGUgRGVmYXVsdFByb3BzID0ge1xuICBrZXlFeHRyYWN0b3I6IChpdGVtOiBJdGVtLCBpbmRleDogbnVtYmVyKSA9PiBzdHJpbmcsXG59O1xudHlwZSBQcm9wcyA9IE5vcm1hbFByb3BzICYgRGVmYXVsdFByb3BzO1xuXG4vKipcbiAqIFRoaXMgaXMganVzdCBhIHdyYXBwZXIgYXJvdW5kIHRoZSBsZWdhY3kgTGlzdFZpZXcgdGhhdCBtYXRjaGVzIHRoZSBuZXcgQVBJIG9mIEZsYXRMaXN0LCBidXQgd2l0aFxuICogc29tZSBzZWN0aW9uIHN1cHBvcnQgdGFja2VkIG9uLiBJdCBpcyByZWNvbW1lbmRlZCB0byBqdXN0IHVzZSBGbGF0TGlzdCBkaXJlY3RseSwgdGhpcyBjb21wb25lbnRcbiAqIGlzIG1vc3RseSBmb3IgZGVidWdnaW5nIGFuZCBwZXJmb3JtYW5jZSBjb21wYXJpc29uLlxuICovXG5jbGFzcyBNZXRyb0xpc3RWaWV3IGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50PFByb3BzLCAkRmxvd0ZpeE1lU3RhdGU+IHtcbiAgc2Nyb2xsVG9FbmQocGFyYW1zPzogP3thbmltYXRlZD86ID9ib29sZWFufSkge1xuICAgIHRocm93IG5ldyBFcnJvcignc2Nyb2xsVG9FbmQgbm90IHN1cHBvcnRlZCBpbiBsZWdhY3kgTGlzdFZpZXcuJyk7XG4gIH1cbiAgc2Nyb2xsVG9JbmRleChwYXJhbXM6IHtcbiAgICBhbmltYXRlZD86ID9ib29sZWFuLFxuICAgIGluZGV4OiBudW1iZXIsXG4gICAgdmlld1Bvc2l0aW9uPzogbnVtYmVyLFxuICB9KSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdzY3JvbGxUb0luZGV4IG5vdCBzdXBwb3J0ZWQgaW4gbGVnYWN5IExpc3RWaWV3LicpO1xuICB9XG4gIHNjcm9sbFRvSXRlbShwYXJhbXM6IHtcbiAgICBhbmltYXRlZD86ID9ib29sZWFuLFxuICAgIGl0ZW06IEl0ZW0sXG4gICAgdmlld1Bvc2l0aW9uPzogbnVtYmVyLFxuICB9KSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdzY3JvbGxUb0l0ZW0gbm90IHN1cHBvcnRlZCBpbiBsZWdhY3kgTGlzdFZpZXcuJyk7XG4gIH1cbiAgc2Nyb2xsVG9Mb2NhdGlvbihwYXJhbXM6IHtcbiAgICBhbmltYXRlZD86ID9ib29sZWFuLFxuICAgIGl0ZW1JbmRleDogbnVtYmVyLFxuICAgIHNlY3Rpb25JbmRleDogbnVtYmVyLFxuICAgIHZpZXdPZmZzZXQ/OiBudW1iZXIsXG4gICAgdmlld1Bvc2l0aW9uPzogbnVtYmVyLFxuICB9KSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdzY3JvbGxUb0xvY2F0aW9uIG5vdCBzdXBwb3J0ZWQgaW4gbGVnYWN5IExpc3RWaWV3LicpO1xuICB9XG4gIHNjcm9sbFRvT2Zmc2V0KHBhcmFtczoge2FuaW1hdGVkPzogP2Jvb2xlYW4sIG9mZnNldDogbnVtYmVyfSkge1xuICAgIGNvbnN0IHthbmltYXRlZCwgb2Zmc2V0fSA9IHBhcmFtcztcbiAgICAvLyAkRmxvd0ZpeE1lIEludmFsaWQgcHJvcCB1c2FnZVxuICAgIHRoaXMuX2xpc3RSZWYuc2Nyb2xsVG8oXG4gICAgICB0aGlzLnByb3BzLmhvcml6b250YWwgPyB7eDogb2Zmc2V0LCBhbmltYXRlZH0gOiB7eTogb2Zmc2V0LCBhbmltYXRlZH0sXG4gICAgKTtcbiAgfVxuICBnZXRMaXN0UmVmKCkge1xuICAgIHJldHVybiB0aGlzLl9saXN0UmVmO1xuICB9XG4gIHNldE5hdGl2ZVByb3BzKHByb3BzOiBPYmplY3QpIHtcbiAgICBpZiAodGhpcy5fbGlzdFJlZikge1xuICAgICAgdGhpcy5fbGlzdFJlZi5zZXROYXRpdmVQcm9wcyhwcm9wcyk7XG4gICAgfVxuICB9XG4gIHN0YXRpYyBkZWZhdWx0UHJvcHM6IERlZmF1bHRQcm9wcyA9IHtcbiAgICBrZXlFeHRyYWN0b3I6IChpdGVtLCBpbmRleCkgPT4gaXRlbS5rZXkgfHwgU3RyaW5nKGluZGV4KSxcbiAgICByZW5kZXJTY3JvbGxDb21wb25lbnQ6IChwcm9wczogUHJvcHMpID0+IHtcbiAgICAgIGlmIChwcm9wcy5vblJlZnJlc2gpIHtcbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAvLyAkRmxvd0ZpeE1lIEludmFsaWQgcHJvcCB1c2FnZVxuICAgICAgICAgIDxTY3JvbGxWaWV3XG4gICAgICAgICAgICB7Li4ucHJvcHN9XG4gICAgICAgICAgICByZWZyZXNoQ29udHJvbD17XG4gICAgICAgICAgICAgIC8qICRGbG93Rml4TWUoPj0wLjUzLjAgc2l0ZT1yZWFjdF9uYXRpdmVfZmIscmVhY3RfbmF0aXZlX29zcylcbiAgICAgICAgICAgICAgICogVGhpcyBjb21tZW50IHN1cHByZXNzZXMgYW4gZXJyb3Igd2hlbiB1cGdyYWRpbmcgRmxvdydzIHN1cHBvcnRcbiAgICAgICAgICAgICAgICogZm9yIFJlYWN0LiBUbyBzZWUgdGhlIGVycm9yIGRlbGV0ZSB0aGlzIGNvbW1lbnQgYW5kIHJ1biBGbG93LlxuICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgPFJlZnJlc2hDb250cm9sXG4gICAgICAgICAgICAgICAgcmVmcmVzaGluZz17cHJvcHMucmVmcmVzaGluZ31cbiAgICAgICAgICAgICAgICBvblJlZnJlc2g9e3Byb3BzLm9uUmVmcmVzaH1cbiAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAvPlxuICAgICAgICApO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gJEZsb3dGaXhNZSBJbnZhbGlkIHByb3AgdXNhZ2VcbiAgICAgICAgcmV0dXJuIDxTY3JvbGxWaWV3IHsuLi5wcm9wc30gLz47XG4gICAgICB9XG4gICAgfSxcbiAgfTtcbiAgc3RhdGUgPSB0aGlzLl9jb21wdXRlU3RhdGUodGhpcy5wcm9wcywge1xuICAgIGRzOiBuZXcgTGlzdFZpZXcuRGF0YVNvdXJjZSh7XG4gICAgICByb3dIYXNDaGFuZ2VkOiAoaXRlbUEsIGl0ZW1CKSA9PiB0cnVlLFxuICAgICAgc2VjdGlvbkhlYWRlckhhc0NoYW5nZWQ6ICgpID0+IHRydWUsXG4gICAgICBnZXRTZWN0aW9uSGVhZGVyRGF0YTogKGRhdGFCbG9iLCBzZWN0aW9uSUQpID0+XG4gICAgICAgIHRoaXMuc3RhdGUuc2VjdGlvbkhlYWRlckRhdGFbc2VjdGlvbklEXSxcbiAgICB9KSxcbiAgICBzZWN0aW9uSGVhZGVyRGF0YToge30sXG4gIH0pO1xuICBVTlNBRkVfY29tcG9uZW50V2lsbFJlY2VpdmVQcm9wcyhuZXdQcm9wczogUHJvcHMpIHtcbiAgICB0aGlzLnNldFN0YXRlKHN0YXRlID0+IHRoaXMuX2NvbXB1dGVTdGF0ZShuZXdQcm9wcywgc3RhdGUpKTtcbiAgfVxuICByZW5kZXIoKSB7XG4gICAgcmV0dXJuIChcbiAgICAgIC8vICRGbG93Rml4TWUgRm91bmQgd2hlbiB0eXBpbmcgTGlzdFZpZXdcbiAgICAgIDxMaXN0Vmlld1xuICAgICAgICB7Li4udGhpcy5wcm9wc31cbiAgICAgICAgZGF0YVNvdXJjZT17dGhpcy5zdGF0ZS5kc31cbiAgICAgICAgcmVmPXt0aGlzLl9jYXB0dXJlUmVmfVxuICAgICAgICByZW5kZXJSb3c9e3RoaXMuX3JlbmRlclJvd31cbiAgICAgICAgcmVuZGVyRm9vdGVyPXt0aGlzLnByb3BzLkZvb3RlckNvbXBvbmVudCAmJiB0aGlzLl9yZW5kZXJGb290ZXJ9XG4gICAgICAgIHJlbmRlclNlY3Rpb25IZWFkZXI9e3RoaXMucHJvcHMuc2VjdGlvbnMgJiYgdGhpcy5fcmVuZGVyU2VjdGlvbkhlYWRlcn1cbiAgICAgICAgcmVuZGVyU2VwYXJhdG9yPXt0aGlzLnByb3BzLlNlcGFyYXRvckNvbXBvbmVudCAmJiB0aGlzLl9yZW5kZXJTZXBhcmF0b3J9XG4gICAgICAvPlxuICAgICk7XG4gIH1cbiAgX2xpc3RSZWY6ID9MaXN0VmlldztcbiAgX2NhcHR1cmVSZWYgPSByZWYgPT4ge1xuICAgIHRoaXMuX2xpc3RSZWYgPSByZWY7XG4gIH07XG4gIF9jb21wdXRlU3RhdGUocHJvcHM6IFByb3BzLCBzdGF0ZSkge1xuICAgIGNvbnN0IHNlY3Rpb25IZWFkZXJEYXRhID0ge307XG4gICAgaWYgKHByb3BzLnNlY3Rpb25zKSB7XG4gICAgICBpbnZhcmlhbnQoIXByb3BzLml0ZW1zLCAnQ2Fubm90IGhhdmUgYm90aCBzZWN0aW9ucyBhbmQgaXRlbXMgcHJvcHMuJyk7XG4gICAgICBjb25zdCBzZWN0aW9ucyA9IHt9O1xuICAgICAgcHJvcHMuc2VjdGlvbnMuZm9yRWFjaCgoc2VjdGlvbkluLCBpaSkgPT4ge1xuICAgICAgICBjb25zdCBzZWN0aW9uSUQgPSAncycgKyBpaTtcbiAgICAgICAgc2VjdGlvbnNbc2VjdGlvbklEXSA9IHNlY3Rpb25Jbi5kYXRhO1xuICAgICAgICBzZWN0aW9uSGVhZGVyRGF0YVtzZWN0aW9uSURdID0gc2VjdGlvbkluO1xuICAgICAgfSk7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBkczogc3RhdGUuZHMuY2xvbmVXaXRoUm93c0FuZFNlY3Rpb25zKHNlY3Rpb25zKSxcbiAgICAgICAgc2VjdGlvbkhlYWRlckRhdGEsXG4gICAgICB9O1xuICAgIH0gZWxzZSB7XG4gICAgICBpbnZhcmlhbnQoIXByb3BzLnNlY3Rpb25zLCAnQ2Fubm90IGhhdmUgYm90aCBzZWN0aW9ucyBhbmQgaXRlbXMgcHJvcHMuJyk7XG4gICAgICByZXR1cm4ge1xuICAgICAgICAvLyAkRmxvd0ZpeE1lIEZvdW5kIHdoZW4gdHlwaW5nIExpc3RWaWV3XG4gICAgICAgIGRzOiBzdGF0ZS5kcy5jbG9uZVdpdGhSb3dzKHByb3BzLml0ZW1zKSxcbiAgICAgICAgc2VjdGlvbkhlYWRlckRhdGEsXG4gICAgICB9O1xuICAgIH1cbiAgfVxuICAvKiAkRmxvd0ZpeE1lKD49MC41My4wIHNpdGU9cmVhY3RfbmF0aXZlX2ZiLHJlYWN0X25hdGl2ZV9vc3MpIFRoaXMgY29tbWVudFxuICAgKiBzdXBwcmVzc2VzIGFuIGVycm9yIHdoZW4gdXBncmFkaW5nIEZsb3cncyBzdXBwb3J0IGZvciBSZWFjdC4gVG8gc2VlIHRoZVxuICAgKiBlcnJvciBkZWxldGUgdGhpcyBjb21tZW50IGFuZCBydW4gRmxvdy4gKi9cbiAgX3JlbmRlckZvb3RlciA9ICgpID0+IDx0aGlzLnByb3BzLkZvb3RlckNvbXBvbmVudCBrZXk9XCIkZm9vdGVyXCIgLz47XG4gIF9yZW5kZXJSb3cgPSAoaXRlbSwgc2VjdGlvbklELCByb3dJRCwgaGlnaGxpZ2h0Um93KSA9PiB7XG4gICAgcmV0dXJuIHRoaXMucHJvcHMucmVuZGVySXRlbSh7aXRlbSwgaW5kZXg6IHJvd0lEfSk7XG4gIH07XG4gIF9yZW5kZXJTZWN0aW9uSGVhZGVyID0gKHNlY3Rpb24sIHNlY3Rpb25JRCkgPT4ge1xuICAgIGNvbnN0IHtyZW5kZXJTZWN0aW9uSGVhZGVyfSA9IHRoaXMucHJvcHM7XG4gICAgaW52YXJpYW50KFxuICAgICAgcmVuZGVyU2VjdGlvbkhlYWRlcixcbiAgICAgICdNdXN0IHByb3ZpZGUgcmVuZGVyU2VjdGlvbkhlYWRlciB3aXRoIHNlY3Rpb25zIHByb3AnLFxuICAgICk7XG4gICAgcmV0dXJuIHJlbmRlclNlY3Rpb25IZWFkZXIoe3NlY3Rpb259KTtcbiAgfTtcbiAgX3JlbmRlclNlcGFyYXRvciA9IChzSUQsIHJJRCkgPT4gKFxuICAgIC8qICRGbG93Rml4TWUoPj0wLjUzLjAgc2l0ZT1yZWFjdF9uYXRpdmVfZmIscmVhY3RfbmF0aXZlX29zcykgVGhpcyBjb21tZW50XG4gICAgICogc3VwcHJlc3NlcyBhbiBlcnJvciB3aGVuIHVwZ3JhZGluZyBGbG93J3Mgc3VwcG9ydCBmb3IgUmVhY3QuIFRvIHNlZSB0aGVcbiAgICAgKiBlcnJvciBkZWxldGUgdGhpcyBjb21tZW50IGFuZCBydW4gRmxvdy4gKi9cbiAgICA8dGhpcy5wcm9wcy5TZXBhcmF0b3JDb21wb25lbnQga2V5PXtzSUQgKyBySUR9IC8+XG4gICk7XG59XG5cbm1vZHVsZS5leHBvcnRzID0gTWV0cm9MaXN0VmlldztcbiJdfQ==