1d65141b049878dadd92c9f5afe480e9









'use strict';var _extends = Object.assign || function (target) {for (var i = 1; i < arguments.length; i++) {var source = arguments[i];for (var key in source) {if (Object.prototype.hasOwnProperty.call(source, key)) {target[key] = source[key];}}}return target;};var _createClass = function () {function defineProperties(target, props) {for (var i = 0; i < props.length; i++) {var descriptor = props[i];descriptor.enumerable = descriptor.enumerable || false;descriptor.configurable = true;if ("value" in descriptor) descriptor.writable = true;Object.defineProperty(target, descriptor.key, descriptor);}}return function (Constructor, protoProps, staticProps) {if (protoProps) defineProperties(Constructor.prototype, protoProps);if (staticProps) defineProperties(Constructor, staticProps);return Constructor;};}();var _get = function get(object, property, receiver) {if (object === null) object = Function.prototype;var desc = Object.getOwnPropertyDescriptor(object, property);if (desc === undefined) {var parent = Object.getPrototypeOf(object);if (parent === null) {return undefined;} else {return get(parent, property, receiver);}} else if ("value" in desc) {return desc.value;} else {var getter = desc.get;if (getter === undefined) {return undefined;}return getter.call(receiver);}};function _classCallCheck(instance, Constructor) {if (!(instance instanceof Constructor)) {throw new TypeError("Cannot call a class as a function");}}function _possibleConstructorReturn(self, call) {if (!self) {throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call && (typeof call === "object" || typeof call === "function") ? call : self;}function _inherits(subClass, superClass) {if (typeof superClass !== "function" && superClass !== null) {throw new TypeError("Super expression must either be null or a function, not " + typeof superClass);}subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } });if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;}var _require =

require('../AnimatedEvent'),AnimatedEvent = _require.AnimatedEvent;
var AnimatedNode = require('./AnimatedNode');
var AnimatedStyle = require('./AnimatedStyle');
var NativeAnimatedHelper = require('../NativeAnimatedHelper');
var ReactNative = require('ReactNative');

var invariant = require('fbjs/lib/invariant');var

AnimatedProps = function (_AnimatedNode) {_inherits(AnimatedProps, _AnimatedNode);




  function AnimatedProps(props, callback) {_classCallCheck(this, AnimatedProps);var _this = _possibleConstructorReturn(this, (AnimatedProps.__proto__ || Object.getPrototypeOf(AnimatedProps)).call(this));

    if (props.style) {
      props = _extends({},
      props, {
        style: new AnimatedStyle(props.style) });

    }
    _this._props = props;
    _this._callback = callback;
    _this.__attach();return _this;
  }_createClass(AnimatedProps, [{ key: '__getValue', value: function __getValue()

    {
      var props = {};
      for (var key in this._props) {
        var value = this._props[key];
        if (value instanceof AnimatedNode) {
          if (!value.__isNative || value instanceof AnimatedStyle) {


            props[key] = value.__getValue();
          }
        } else if (value instanceof AnimatedEvent) {
          props[key] = value.__getHandler();
        } else {
          props[key] = value;
        }
      }
      return props;
    } }, { key: '__getAnimatedValue', value: function __getAnimatedValue()

    {
      var props = {};
      for (var key in this._props) {
        var value = this._props[key];
        if (value instanceof AnimatedNode) {
          props[key] = value.__getAnimatedValue();
        }
      }
      return props;
    } }, { key: '__attach', value: function __attach()

    {
      for (var key in this._props) {
        var value = this._props[key];
        if (value instanceof AnimatedNode) {
          value.__addChild(this);
        }
      }
    } }, { key: '__detach', value: function __detach()

    {
      if (this.__isNative && this._animatedView) {
        this.__disconnectAnimatedView();
      }
      for (var key in this._props) {
        var value = this._props[key];
        if (value instanceof AnimatedNode) {
          value.__removeChild(this);
        }
      }
      _get(AnimatedProps.prototype.__proto__ || Object.getPrototypeOf(AnimatedProps.prototype), '__detach', this).call(this);
    } }, { key: 'update', value: function update()

    {
      this._callback();
    } }, { key: '__makeNative', value: function __makeNative()

    {
      if (!this.__isNative) {
        this.__isNative = true;
        for (var key in this._props) {
          var value = this._props[key];
          if (value instanceof AnimatedNode) {
            value.__makeNative();
          }
        }
        if (this._animatedView) {
          this.__connectAnimatedView();
        }
      }
    } }, { key: 'setNativeView', value: function setNativeView(

    animatedView) {
      if (this._animatedView === animatedView) {
        return;
      }
      this._animatedView = animatedView;
      if (this.__isNative) {
        this.__connectAnimatedView();
      }
    } }, { key: '__connectAnimatedView', value: function __connectAnimatedView()

    {
      invariant(this.__isNative, 'Expected node to be marked as "native"');
      var nativeViewTag = ReactNative.findNodeHandle(
      this._animatedView);

      invariant(
      nativeViewTag != null,
      'Unable to locate attached view in the native tree');

      NativeAnimatedHelper.API.connectAnimatedNodeToView(
      this.__getNativeTag(),
      nativeViewTag);

    } }, { key: '__disconnectAnimatedView', value: function __disconnectAnimatedView()

    {
      invariant(this.__isNative, 'Expected node to be marked as "native"');
      var nativeViewTag = ReactNative.findNodeHandle(
      this._animatedView);

      invariant(
      nativeViewTag != null,
      'Unable to locate attached view in the native tree');

      NativeAnimatedHelper.API.disconnectAnimatedNodeFromView(
      this.__getNativeTag(),
      nativeViewTag);

    } }, { key: '__getNativeConfig', value: function __getNativeConfig()

    {
      var propsConfig = {};
      for (var propKey in this._props) {
        var value = this._props[propKey];
        if (value instanceof AnimatedNode) {
          propsConfig[propKey] = value.__getNativeTag();
        }
      }
      return {
        type: 'props',
        props: propsConfig };

    } }]);return AnimatedProps;}(AnimatedNode);


module.exports = AnimatedProps;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkFuaW1hdGVkUHJvcHMuanMiXSwibmFtZXMiOlsicmVxdWlyZSIsIkFuaW1hdGVkRXZlbnQiLCJBbmltYXRlZE5vZGUiLCJBbmltYXRlZFN0eWxlIiwiTmF0aXZlQW5pbWF0ZWRIZWxwZXIiLCJSZWFjdE5hdGl2ZSIsImludmFyaWFudCIsIkFuaW1hdGVkUHJvcHMiLCJwcm9wcyIsImNhbGxiYWNrIiwic3R5bGUiLCJfcHJvcHMiLCJfY2FsbGJhY2siLCJfX2F0dGFjaCIsImtleSIsInZhbHVlIiwiX19pc05hdGl2ZSIsIl9fZ2V0VmFsdWUiLCJfX2dldEhhbmRsZXIiLCJfX2dldEFuaW1hdGVkVmFsdWUiLCJfX2FkZENoaWxkIiwiX2FuaW1hdGVkVmlldyIsIl9fZGlzY29ubmVjdEFuaW1hdGVkVmlldyIsIl9fcmVtb3ZlQ2hpbGQiLCJfX21ha2VOYXRpdmUiLCJfX2Nvbm5lY3RBbmltYXRlZFZpZXciLCJhbmltYXRlZFZpZXciLCJuYXRpdmVWaWV3VGFnIiwiZmluZE5vZGVIYW5kbGUiLCJBUEkiLCJjb25uZWN0QW5pbWF0ZWROb2RlVG9WaWV3IiwiX19nZXROYXRpdmVUYWciLCJkaXNjb25uZWN0QW5pbWF0ZWROb2RlRnJvbVZpZXciLCJwcm9wc0NvbmZpZyIsInByb3BLZXkiLCJ0eXBlIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBU0EsYTs7QUFFd0JBLFFBQVEsa0JBQVIsQyxDQUFqQkMsYSxZQUFBQSxhO0FBQ1AsSUFBTUMsZUFBZUYsUUFBUSxnQkFBUixDQUFyQjtBQUNBLElBQU1HLGdCQUFnQkgsUUFBUSxpQkFBUixDQUF0QjtBQUNBLElBQU1JLHVCQUF1QkosUUFBUSx5QkFBUixDQUE3QjtBQUNBLElBQU1LLGNBQWNMLFFBQVEsYUFBUixDQUFwQjs7QUFFQSxJQUFNTSxZQUFZTixRQUFRLG9CQUFSLENBQWxCLEM7O0FBRU1PLGE7Ozs7O0FBS0oseUJBQVlDLEtBQVosRUFBMkJDLFFBQTNCLEVBQWlEOztBQUUv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Qjs7QUFHQWY7QUFDRXFCLHVCQUFpQixJQURuQjtBQUVFLHlEQUZGOztBQUlBdkIsMkJBQXFCeUIsR0FBckIsQ0FBeUJDLHlCQUF6QjtBQUNFLFdBQUtDLGNBQUwsRUFERjtBQUVFSixtQkFGRjs7QUFJRCxLOztBQUVnQztBQUMvQnJCLGdCQUFVLEtBQUtVLFVBQWYsRUFBMkIsd0NBQTNCO0FBQ0EsVUFBTVcsZ0JBQXlCdEIsWUFBWXVCLGNBQVo7QUFDN0IsV0FBS1AsYUFEd0IsQ0FBL0I7O0FBR0FmO0FBQ0VxQix1QkFBaUIsSUFEbkI7QUFFRSx5REFGRjs7QUFJQXZCLDJCQUFxQnlCLEdBQXJCLENBQXlCRyw4QkFBekI7QUFDRSxXQUFLRCxjQUFMLEVBREY7QUFFRUosbUJBRkY7O0FBSUQsSzs7QUFFMkI7QUFDMUIsVUFBTU0sY0FBYyxFQUFwQjtBQUNBLFdBQUssSUFBTUMsT0FBWCxJQUFzQixLQUFLdkIsTUFBM0IsRUFBbUM7QUFDakMsWUFBTUksUUFBUSxLQUFLSixNQUFMLENBQVl1QixPQUFaLENBQWQ7QUFDQSxZQUFJbkIsaUJBQWlCYixZQUFyQixFQUFtQztBQUNqQytCLHNCQUFZQyxPQUFaLElBQXVCbkIsTUFBTWdCLGNBQU4sRUFBdkI7QUFDRDtBQUNGO0FBQ0QsYUFBTztBQUNMSSxjQUFNLE9BREQ7QUFFTDNCLGVBQU95QixXQUZGLEVBQVA7O0FBSUQsSyw0QkE3SXlCL0IsWTs7O0FBZ0o1QmtDLE9BQU9DLE9BQVAsR0FBaUI5QixhQUFqQiIsImZpbGUiOiJBbmltYXRlZFByb3BzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTUtcHJlc2VudCwgRmFjZWJvb2ssIEluYy5cbiAqXG4gKiBUaGlzIHNvdXJjZSBjb2RlIGlzIGxpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZSBmb3VuZCBpbiB0aGVcbiAqIExJQ0VOU0UgZmlsZSBpbiB0aGUgcm9vdCBkaXJlY3Rvcnkgb2YgdGhpcyBzb3VyY2UgdHJlZS5cbiAqXG4gKiBAZmxvd1xuICogQGZvcm1hdFxuICovXG4ndXNlIHN0cmljdCc7XG5cbmNvbnN0IHtBbmltYXRlZEV2ZW50fSA9IHJlcXVpcmUoJy4uL0FuaW1hdGVkRXZlbnQnKTtcbmNvbnN0IEFuaW1hdGVkTm9kZSA9IHJlcXVpcmUoJy4vQW5pbWF0ZWROb2RlJyk7XG5jb25zdCBBbmltYXRlZFN0eWxlID0gcmVxdWlyZSgnLi9BbmltYXRlZFN0eWxlJyk7XG5jb25zdCBOYXRpdmVBbmltYXRlZEhlbHBlciA9IHJlcXVpcmUoJy4uL05hdGl2ZUFuaW1hdGVkSGVscGVyJyk7XG5jb25zdCBSZWFjdE5hdGl2ZSA9IHJlcXVpcmUoJ1JlYWN0TmF0aXZlJyk7XG5cbmNvbnN0IGludmFyaWFudCA9IHJlcXVpcmUoJ2ZianMvbGliL2ludmFyaWFudCcpO1xuXG5jbGFzcyBBbmltYXRlZFByb3BzIGV4dGVuZHMgQW5pbWF0ZWROb2RlIHtcbiAgX3Byb3BzOiBPYmplY3Q7XG4gIF9hbmltYXRlZFZpZXc6IGFueTtcbiAgX2NhbGxiYWNrOiAoKSA9PiB2b2lkO1xuXG4gIGNvbnN0cnVjdG9yKHByb3BzOiBPYmplY3QsIGNhbGxiYWNrOiAoKSA9PiB2b2lkKSB7XG4gICAgc3VwZXIoKTtcbiAgICBpZiAocHJvcHMuc3R5bGUpIHtcbiAgICAgIHByb3BzID0ge1xuICAgICAgICAuLi5wcm9wcyxcbiAgICAgICAgc3R5bGU6IG5ldyBBbmltYXRlZFN0eWxlKHByb3BzLnN0eWxlKSxcbiAgICAgIH07XG4gICAgfVxuICAgIHRoaXMuX3Byb3BzID0gcHJvcHM7XG4gICAgdGhpcy5fY2FsbGJhY2sgPSBjYWxsYmFjaztcbiAgICB0aGlzLl9fYXR0YWNoKCk7XG4gIH1cblxuICBfX2dldFZhbHVlKCk6IE9iamVjdCB7XG4gICAgY29uc3QgcHJvcHMgPSB7fTtcbiAgICBmb3IgKGNvbnN0IGtleSBpbiB0aGlzLl9wcm9wcykge1xuICAgICAgY29uc3QgdmFsdWUgPSB0aGlzLl9wcm9wc1trZXldO1xuICAgICAgaWYgKHZhbHVlIGluc3RhbmNlb2YgQW5pbWF0ZWROb2RlKSB7XG4gICAgICAgIGlmICghdmFsdWUuX19pc05hdGl2ZSB8fCB2YWx1ZSBpbnN0YW5jZW9mIEFuaW1hdGVkU3R5bGUpIHtcbiAgICAgICAgICAvLyBXZSBjYW5ub3QgdXNlIHZhbHVlIG9mIG5hdGl2ZWx5IGRyaXZlbiBub2RlcyB0aGlzIHdheSBhcyB0aGUgdmFsdWUgd2UgaGF2ZSBhY2Nlc3MgZnJvbVxuICAgICAgICAgIC8vIEpTIG1heSBub3QgYmUgdXAgdG8gZGF0ZS5cbiAgICAgICAgICBwcm9wc1trZXldID0gdmFsdWUuX19nZXRWYWx1ZSgpO1xuICAgICAgICB9XG4gICAgICB9IGVsc2UgaWYgKHZhbHVlIGluc3RhbmNlb2YgQW5pbWF0ZWRFdmVudCkge1xuICAgICAgICBwcm9wc1trZXldID0gdmFsdWUuX19nZXRIYW5kbGVyKCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBwcm9wc1trZXldID0gdmFsdWU7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBwcm9wcztcbiAgfVxuXG4gIF9fZ2V0QW5pbWF0ZWRWYWx1ZSgpOiBPYmplY3Qge1xuICAgIGNvbnN0IHByb3BzID0ge307XG4gICAgZm9yIChjb25zdCBrZXkgaW4gdGhpcy5fcHJvcHMpIHtcbiAgICAgIGNvbnN0IHZhbHVlID0gdGhpcy5fcHJvcHNba2V5XTtcbiAgICAgIGlmICh2YWx1ZSBpbnN0YW5jZW9mIEFuaW1hdGVkTm9kZSkge1xuICAgICAgICBwcm9wc1trZXldID0gdmFsdWUuX19nZXRBbmltYXRlZFZhbHVlKCk7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBwcm9wcztcbiAgfVxuXG4gIF9fYXR0YWNoKCk6IHZvaWQge1xuICAgIGZvciAoY29uc3Qga2V5IGluIHRoaXMuX3Byb3BzKSB7XG4gICAgICBjb25zdCB2YWx1ZSA9IHRoaXMuX3Byb3BzW2tleV07XG4gICAgICBpZiAodmFsdWUgaW5zdGFuY2VvZiBBbmltYXRlZE5vZGUpIHtcbiAgICAgICAgdmFsdWUuX19hZGRDaGlsZCh0aGlzKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBfX2RldGFjaCgpOiB2b2lkIHtcbiAgICBpZiAodGhpcy5fX2lzTmF0aXZlICYmIHRoaXMuX2FuaW1hdGVkVmlldykge1xuICAgICAgdGhpcy5fX2Rpc2Nvbm5lY3RBbmltYXRlZFZpZXcoKTtcbiAgICB9XG4gICAgZm9yIChjb25zdCBrZXkgaW4gdGhpcy5fcHJvcHMpIHtcbiAgICAgIGNvbnN0IHZhbHVlID0gdGhpcy5fcHJvcHNba2V5XTtcbiAgICAgIGlmICh2YWx1ZSBpbnN0YW5jZW9mIEFuaW1hdGVkTm9kZSkge1xuICAgICAgICB2YWx1ZS5fX3JlbW92ZUNoaWxkKHRoaXMpO1xuICAgICAgfVxuICAgIH1cbiAgICBzdXBlci5fX2RldGFjaCgpO1xuICB9XG5cbiAgdXBkYXRlKCk6IHZvaWQge1xuICAgIHRoaXMuX2NhbGxiYWNrKCk7XG4gIH1cblxuICBfX21ha2VOYXRpdmUoKTogdm9pZCB7XG4gICAgaWYgKCF0aGlzLl9faXNOYXRpdmUpIHtcbiAgICAgIHRoaXMuX19pc05hdGl2ZSA9IHRydWU7XG4gICAgICBmb3IgKGNvbnN0IGtleSBpbiB0aGlzLl9wcm9wcykge1xuICAgICAgICBjb25zdCB2YWx1ZSA9IHRoaXMuX3Byb3BzW2tleV07XG4gICAgICAgIGlmICh2YWx1ZSBpbnN0YW5jZW9mIEFuaW1hdGVkTm9kZSkge1xuICAgICAgICAgIHZhbHVlLl9fbWFrZU5hdGl2ZSgpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBpZiAodGhpcy5fYW5pbWF0ZWRWaWV3KSB7XG4gICAgICAgIHRoaXMuX19jb25uZWN0QW5pbWF0ZWRWaWV3KCk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgc2V0TmF0aXZlVmlldyhhbmltYXRlZFZpZXc6IGFueSk6IHZvaWQge1xuICAgIGlmICh0aGlzLl9hbmltYXRlZFZpZXcgPT09IGFuaW1hdGVkVmlldykge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB0aGlzLl9hbmltYXRlZFZpZXcgPSBhbmltYXRlZFZpZXc7XG4gICAgaWYgKHRoaXMuX19pc05hdGl2ZSkge1xuICAgICAgdGhpcy5fX2Nvbm5lY3RBbmltYXRlZFZpZXcoKTtcbiAgICB9XG4gIH1cblxuICBfX2Nvbm5lY3RBbmltYXRlZFZpZXcoKTogdm9pZCB7XG4gICAgaW52YXJpYW50KHRoaXMuX19pc05hdGl2ZSwgJ0V4cGVjdGVkIG5vZGUgdG8gYmUgbWFya2VkIGFzIFwibmF0aXZlXCInKTtcbiAgICBjb25zdCBuYXRpdmVWaWV3VGFnOiA/bnVtYmVyID0gUmVhY3ROYXRpdmUuZmluZE5vZGVIYW5kbGUoXG4gICAgICB0aGlzLl9hbmltYXRlZFZpZXcsXG4gICAgKTtcbiAgICBpbnZhcmlhbnQoXG4gICAgICBuYXRpdmVWaWV3VGFnICE9IG51bGwsXG4gICAgICAnVW5hYmxlIHRvIGxvY2F0ZSBhdHRhY2hlZCB2aWV3IGluIHRoZSBuYXRpdmUgdHJlZScsXG4gICAgKTtcbiAgICBOYXRpdmVBbmltYXRlZEhlbHBlci5BUEkuY29ubmVjdEFuaW1hdGVkTm9kZVRvVmlldyhcbiAgICAgIHRoaXMuX19nZXROYXRpdmVUYWcoKSxcbiAgICAgIG5hdGl2ZVZpZXdUYWcsXG4gICAgKTtcbiAgfVxuXG4gIF9fZGlzY29ubmVjdEFuaW1hdGVkVmlldygpOiB2b2lkIHtcbiAgICBpbnZhcmlhbnQodGhpcy5fX2lzTmF0aXZlLCAnRXhwZWN0ZWQgbm9kZSB0byBiZSBtYXJrZWQgYXMgXCJuYXRpdmVcIicpO1xuICAgIGNvbnN0IG5hdGl2ZVZpZXdUYWc6ID9udW1iZXIgPSBSZWFjdE5hdGl2ZS5maW5kTm9kZUhhbmRsZShcbiAgICAgIHRoaXMuX2FuaW1hdGVkVmlldyxcbiAgICApO1xuICAgIGludmFyaWFudChcbiAgICAgIG5hdGl2ZVZpZXdUYWcgIT0gbnVsbCxcbiAgICAgICdVbmFibGUgdG8gbG9jYXRlIGF0dGFjaGVkIHZpZXcgaW4gdGhlIG5hdGl2ZSB0cmVlJyxcbiAgICApO1xuICAgIE5hdGl2ZUFuaW1hdGVkSGVscGVyLkFQSS5kaXNjb25uZWN0QW5pbWF0ZWROb2RlRnJvbVZpZXcoXG4gICAgICB0aGlzLl9fZ2V0TmF0aXZlVGFnKCksXG4gICAgICBuYXRpdmVWaWV3VGFnLFxuICAgICk7XG4gIH1cblxuICBfX2dldE5hdGl2ZUNvbmZpZygpOiBPYmplY3Qge1xuICAgIGNvbnN0IHByb3BzQ29uZmlnID0ge307XG4gICAgZm9yIChjb25zdCBwcm9wS2V5IGluIHRoaXMuX3Byb3BzKSB7XG4gICAgICBjb25zdCB2YWx1ZSA9IHRoaXMuX3Byb3BzW3Byb3BLZXldO1xuICAgICAgaWYgKHZhbHVlIGluc3RhbmNlb2YgQW5pbWF0ZWROb2RlKSB7XG4gICAgICAgIHByb3BzQ29uZmlnW3Byb3BLZXldID0gdmFsdWUuX19nZXROYXRpdmVUYWcoKTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHtcbiAgICAgIHR5cGU6ICdwcm9wcycsXG4gICAgICBwcm9wczogcHJvcHNDb25maWcsXG4gICAgfTtcbiAgfVxufVxuXG5tb2R1bGUuZXhwb3J0cyA9IEFuaW1hdGVkUHJvcHM7XG4iXX0=