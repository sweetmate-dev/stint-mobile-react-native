09e28640f58e4d8ad42dcee78e535780









'use strict';var _createClass = function () {function defineProperties(target, props) {for (var i = 0; i < props.length; i++) {var descriptor = props[i];descriptor.enumerable = descriptor.enumerable || false;descriptor.configurable = true;if ("value" in descriptor) descriptor.writable = true;Object.defineProperty(target, descriptor.key, descriptor);}}return function (Constructor, protoProps, staticProps) {if (protoProps) defineProperties(Constructor.prototype, protoProps);if (staticProps) defineProperties(Constructor, staticProps);return Constructor;};}();function _toConsumableArray(arr) {if (Array.isArray(arr)) {for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) {arr2[i] = arr[i];}return arr2;} else {return Array.from(arr);}}function _classCallCheck(instance, Constructor) {if (!(instance instanceof Constructor)) {throw new TypeError("Cannot call a class as a function");}}

var invariant = require('fbjs/lib/invariant');
var isEmpty = require('isEmpty');



var warning = require('fbjs/lib/warning');

function defaultGetRowData(
dataBlob,
sectionID,
rowID)
{
  return dataBlob[sectionID][rowID];
}

function defaultGetSectionHeaderData(
dataBlob,
sectionID)
{
  return dataBlob[sectionID];
}var












































ListViewDataSource = function () {

























  function ListViewDataSource(params) {_classCallCheck(this, ListViewDataSource);
    invariant(
    params && typeof params.rowHasChanged === 'function',
    'Must provide a rowHasChanged function.');

    this._rowHasChanged = params.rowHasChanged;
    this._getRowData = params.getRowData || defaultGetRowData;
    this._sectionHeaderHasChanged = params.sectionHeaderHasChanged;
    this._getSectionHeaderData =
    params.getSectionHeaderData || defaultGetSectionHeaderData;

    this._dataBlob = null;
    this._dirtyRows = [];
    this._dirtySections = [];
    this._cachedRowCount = 0;



    this.rowIdentities = [];
    this.sectionIdentities = [];
  }_createClass(ListViewDataSource, [{ key: 'cloneWithRows', value: function cloneWithRows(


















    dataBlob,
    rowIdentities)
    {
      var rowIds = rowIdentities ? [[].concat(_toConsumableArray(rowIdentities))] : null;
      if (!this._sectionHeaderHasChanged) {
        this._sectionHeaderHasChanged = function () {return false;};
      }
      return this.cloneWithRowsAndSections({ s1: dataBlob }, ['s1'], rowIds);
    } }, { key: 'cloneWithRowsAndSections', value: function cloneWithRowsAndSections(





















    dataBlob,
    sectionIdentities,
    rowIdentities)
    {
      invariant(
      typeof this._sectionHeaderHasChanged === 'function',
      'Must provide a sectionHeaderHasChanged function with section data.');

      invariant(
      !sectionIdentities ||
      !rowIdentities ||
      sectionIdentities.length === rowIdentities.length,
      'row and section ids lengths must be the same');


      var newSource = new ListViewDataSource({
        getRowData: this._getRowData,
        getSectionHeaderData: this._getSectionHeaderData,
        rowHasChanged: this._rowHasChanged,
        sectionHeaderHasChanged: this._sectionHeaderHasChanged });

      newSource._dataBlob = dataBlob;
      if (sectionIdentities) {
        newSource.sectionIdentities = sectionIdentities;
      } else {
        newSource.sectionIdentities = Object.keys(dataBlob);
      }
      if (rowIdentities) {
        newSource.rowIdentities = rowIdentities;
      } else {
        newSource.rowIdentities = [];
        newSource.sectionIdentities.forEach(function (sectionID) {
          newSource.rowIdentities.push(Object.keys(dataBlob[sectionID]));
        });
      }
      newSource._cachedRowCount = countRows(newSource.rowIdentities);

      newSource._calculateDirtyArrays(
      this._dataBlob,
      this.sectionIdentities,
      this.rowIdentities);


      return newSource;
    } }, { key: 'getRowCount', value: function getRowCount()






    {
      return this._cachedRowCount;
    } }, { key: 'getRowAndSectionCount', value: function getRowAndSectionCount()






    {
      return this._cachedRowCount + this.sectionIdentities.length;
    } }, { key: 'rowShouldUpdate', value: function rowShouldUpdate(




    sectionIndex, rowIndex) {
      var needsUpdate = this._dirtyRows[sectionIndex][rowIndex];
      warning(
      needsUpdate !== undefined,
      'missing dirtyBit for section, row: ' + sectionIndex + ', ' + rowIndex);

      return needsUpdate;
    } }, { key: 'getRowData', value: function getRowData(




    sectionIndex, rowIndex) {
      var sectionID = this.sectionIdentities[sectionIndex];
      var rowID = this.rowIdentities[sectionIndex][rowIndex];
      warning(
      sectionID !== undefined && rowID !== undefined,
      'rendering invalid section, row: ' + sectionIndex + ', ' + rowIndex);

      return this._getRowData(this._dataBlob, sectionID, rowID);
    } }, { key: 'getRowIDForFlatIndex', value: function getRowIDForFlatIndex(





    index) {
      var accessIndex = index;
      for (var ii = 0; ii < this.sectionIdentities.length; ii++) {
        if (accessIndex >= this.rowIdentities[ii].length) {
          accessIndex -= this.rowIdentities[ii].length;
        } else {
          return this.rowIdentities[ii][accessIndex];
        }
      }
      return null;
    } }, { key: 'getSectionIDForFlatIndex', value: function getSectionIDForFlatIndex(





    index) {
      var accessIndex = index;
      for (var ii = 0; ii < this.sectionIdentities.length; ii++) {
        if (accessIndex >= this.rowIdentities[ii].length) {
          accessIndex -= this.rowIdentities[ii].length;
        } else {
          return this.sectionIdentities[ii];
        }
      }
      return null;
    } }, { key: 'getSectionLengths', value: function getSectionLengths()




    {
      var results = [];
      for (var ii = 0; ii < this.sectionIdentities.length; ii++) {
        results.push(this.rowIdentities[ii].length);
      }
      return results;
    } }, { key: 'sectionHeaderShouldUpdate', value: function sectionHeaderShouldUpdate(




    sectionIndex) {
      var needsUpdate = this._dirtySections[sectionIndex];
      warning(
      needsUpdate !== undefined,
      'missing dirtyBit for section: ' + sectionIndex);

      return needsUpdate;
    } }, { key: 'getSectionHeaderData', value: function getSectionHeaderData(




    sectionIndex) {
      if (!this._getSectionHeaderData) {
        return null;
      }
      var sectionID = this.sectionIdentities[sectionIndex];
      warning(
      sectionID !== undefined,
      'renderSection called on invalid section: ' + sectionIndex);

      return this._getSectionHeaderData(this._dataBlob, sectionID);
    } }, { key: '_calculateDirtyArrays', value: function _calculateDirtyArrays(





















    prevDataBlob,
    prevSectionIDs,
    prevRowIDs)
    {

      var prevSectionsHash = keyedDictionaryFromArray(prevSectionIDs);
      var prevRowsHash = {};
      for (var ii = 0; ii < prevRowIDs.length; ii++) {
        var sectionID = prevSectionIDs[ii];
        warning(
        !prevRowsHash[sectionID],
        'SectionID appears more than once: ' + sectionID);

        prevRowsHash[sectionID] = keyedDictionaryFromArray(prevRowIDs[ii]);
      }


      this._dirtySections = [];
      this._dirtyRows = [];

      var dirty = void 0;
      for (var sIndex = 0; sIndex < this.sectionIdentities.length; sIndex++) {
        var sectionID = this.sectionIdentities[sIndex];

        dirty = !prevSectionsHash[sectionID];
        var _sectionHeaderHasChanged = this._sectionHeaderHasChanged;
        if (!dirty && _sectionHeaderHasChanged) {
          dirty = _sectionHeaderHasChanged(
          this._getSectionHeaderData(prevDataBlob, sectionID),
          this._getSectionHeaderData(this._dataBlob, sectionID));

        }
        this._dirtySections.push(!!dirty);

        this._dirtyRows[sIndex] = [];
        for (
        var rIndex = 0;
        rIndex < this.rowIdentities[sIndex].length;
        rIndex++)
        {
          var rowID = this.rowIdentities[sIndex][rIndex];

          dirty =
          !prevSectionsHash[sectionID] ||
          !prevRowsHash[sectionID][rowID] ||
          this._rowHasChanged(
          this._getRowData(prevDataBlob, sectionID, rowID),
          this._getRowData(this._dataBlob, sectionID, rowID));

          this._dirtyRows[sIndex].push(!!dirty);
        }
      }
    } }]);return ListViewDataSource;}();


function countRows(allRowIDs) {
  var totalRows = 0;
  for (var sectionIdx = 0; sectionIdx < allRowIDs.length; sectionIdx++) {
    var rowIDs = allRowIDs[sectionIdx];
    totalRows += rowIDs.length;
  }
  return totalRows;
}

function keyedDictionaryFromArray(arr) {
  if (isEmpty(arr)) {
    return {};
  }
  var result = {};
  for (var ii = 0; ii < arr.length; ii++) {
    var _key = arr[ii];
    warning(!result[_key], 'Value appears more than once in array: ' + _key);
    result[_key] = true;
  }
  return result;
}

module.exports = ListViewDataSource;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkxpc3RWaWV3RGF0YVNvdXJjZS5qcyJdLCJuYW1lcyI6WyJpbnZhcmlhbnQiLCJyZXF1aXJlIiwiaXNFbXB0eSIsIndhcm5pbmciLCJkZWZhdWx0R2V0Um93RGF0YSIsImRhdGFCbG9iIiwic2VjdGlvbklEIiwicm93SUQiLCJkZWZhdWx0R2V0U2VjdGlvbkhlYWRlckRhdGEiLCJMaXN0Vmlld0RhdGFTb3VyY2UiLCJwYXJhbXMiLCJyb3dIYXNDaGFuZ2VkIiwiX3Jvd0hhc0NoYW5nZWQiLCJfZ2V0Um93RGF0YSIsImdldFJvd0RhdGEiLCJfc2VjdGlvbkhlYWRlckhhc0NoYW5nZWQiLCJzZWN0aW9uSGVhZGVySGFzQ2hhbmdlZCIsIl9nZXRTZWN0aW9uSGVhZGVyRGF0YSIsImdldFNlY3Rpb25IZWFkZXJEYXRhIiwiX2RhdGFCbG9iIiwiX2RpcnR5Um93cyIsIl9kaXJ0eVNlY3Rpb25zIiwiX2NhY2hlZFJvd0NvdW50Iiwicm93SWRlbnRpdGllcyIsInNlY3Rpb25JZGVudGl0aWVzIiwicm93SWRzIiwiY2xvbmVXaXRoUm93c0FuZFNlY3Rpb25zIiwiczEiLCJsZW5ndGgiLCJuZXdTb3VyY2UiLCJPYmplY3QiLCJrZXlzIiwiZm9yRWFjaCIsInB1c2giLCJjb3VudFJvd3MiLCJfY2FsY3VsYXRlRGlydHlBcnJheXMiLCJzZWN0aW9uSW5kZXgiLCJyb3dJbmRleCIsIm5lZWRzVXBkYXRlIiwidW5kZWZpbmVkIiwiaW5kZXgiLCJhY2Nlc3NJbmRleCIsImlpIiwicmVzdWx0cyIsInByZXZEYXRhQmxvYiIsInByZXZTZWN0aW9uSURzIiwicHJldlJvd0lEcyIsInByZXZTZWN0aW9uc0hhc2giLCJrZXllZERpY3Rpb25hcnlGcm9tQXJyYXkiLCJwcmV2Um93c0hhc2giLCJkaXJ0eSIsInNJbmRleCIsInJJbmRleCIsImFsbFJvd0lEcyIsInRvdGFsUm93cyIsInNlY3Rpb25JZHgiLCJyb3dJRHMiLCJhcnIiLCJyZXN1bHQiLCJrZXkiLCJtb2R1bGUiLCJleHBv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QUFmO0FBQ0FELGlCQUFhRSxPQUFPNUIsTUFBcEI7QUFDRDtBQUNELFNBQU8wQixTQUFQO0FBQ0Q7O0FBRUQsU0FBU04sd0JBQVQsQ0FBa0NTLEdBQWxDLEVBQXVDO0FBQ3JDLE1BQUl2RCxRQUFRdUQsR0FBUixDQUFKLEVBQWtCO0FBQ2hCLFdBQU8sRUFBUDtBQUNEO0FBQ0QsTUFBTUMsU0FBUyxFQUFmO0FBQ0EsT0FBSyxJQUFJaEIsS0FBSyxDQUFkLEVBQWlCQSxLQUFLZSxJQUFJN0IsTUFBMUIsRUFBa0NjLElBQWxDLEVBQXdDO0FBQ3RDLFFBQU1pQixPQUFNRixJQUFJZixFQUFKLENBQVo7QUFDQXZDLFlBQVEsQ0FBQ3VELE9BQU9DLElBQVAsQ0FBVCxFQUFzQiw0Q0FBNENBLElBQWxFO0FBQ0FELFdBQU9DLElBQVAsSUFBYyxJQUFkO0FBQ0Q7QUFDRCxTQUFPRCxNQUFQO0FBQ0Q7O0FBRURFLE9BQU9DLE9BQVAsR0FBaUJwRCxrQkFBakIiLCJmaWxlIjoiTGlzdFZpZXdEYXRhU291cmNlLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTUtcHJlc2VudCwgRmFjZWJvb2ssIEluYy5cbiAqXG4gKiBUaGlzIHNvdXJjZSBjb2RlIGlzIGxpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZSBmb3VuZCBpbiB0aGVcbiAqIExJQ0VOU0UgZmlsZSBpbiB0aGUgcm9vdCBkaXJlY3Rvcnkgb2YgdGhpcyBzb3VyY2UgdHJlZS5cbiAqXG4gKiBAZmxvd1xuICogQGZvcm1hdFxuICovXG4ndXNlIHN0cmljdCc7XG5cbmNvbnN0IGludmFyaWFudCA9IHJlcXVpcmUoJ2ZianMvbGliL2ludmFyaWFudCcpO1xuY29uc3QgaXNFbXB0eSA9IHJlcXVpcmUoJ2lzRW1wdHknKTtcbi8qICRGbG93Rml4TWUoPj0wLjU0LjAgc2l0ZT1yZWFjdF9uYXRpdmVfb3NzKSBUaGlzIGNvbW1lbnQgc3VwcHJlc3NlcyBhbiBlcnJvclxuICogZm91bmQgd2hlbiBGbG93IHYwLjU0IHdhcyBkZXBsb3llZC4gVG8gc2VlIHRoZSBlcnJvciBkZWxldGUgdGhpcyBjb21tZW50IGFuZFxuICogcnVuIEZsb3cuICovXG5jb25zdCB3YXJuaW5nID0gcmVxdWlyZSgnZmJqcy9saWIvd2FybmluZycpO1xuXG5mdW5jdGlvbiBkZWZhdWx0R2V0Um93RGF0YShcbiAgZGF0YUJsb2I6IGFueSxcbiAgc2VjdGlvbklEOiBudW1iZXIgfCBzdHJpbmcsXG4gIHJvd0lEOiBudW1iZXIgfCBzdHJpbmcsXG4pOiBhbnkge1xuICByZXR1cm4gZGF0YUJsb2Jbc2VjdGlvbklEXVtyb3dJRF07XG59XG5cbmZ1bmN0aW9uIGRlZmF1bHRHZXRTZWN0aW9uSGVhZGVyRGF0YShcbiAgZGF0YUJsb2I6IGFueSxcbiAgc2VjdGlvbklEOiBudW1iZXIgfCBzdHJpbmcsXG4pOiBhbnkge1xuICByZXR1cm4gZGF0YUJsb2Jbc2VjdGlvbklEXTtcbn1cblxudHlwZSBkaWZmZXJUeXBlID0gKGRhdGExOiBhbnksIGRhdGEyOiBhbnkpID0+IGJvb2xlYW47XG5cbnR5cGUgUGFyYW1UeXBlID0ge1xuICByb3dIYXNDaGFuZ2VkOiBkaWZmZXJUeXBlLFxuICBnZXRSb3dEYXRhPzogP3R5cGVvZiBkZWZhdWx0R2V0Um93RGF0YSxcbiAgc2VjdGlvbkhlYWRlckhhc0NoYW5nZWQ/OiA/ZGlmZmVyVHlwZSxcbiAgZ2V0U2VjdGlvbkhlYWRlckRhdGE/OiA/dHlwZW9mIGRlZmF1bHRHZXRTZWN0aW9uSGVhZGVyRGF0YSxcbn07XG5cbi8qKlxuICogUHJvdmlkZXMgZWZmaWNpZW50IGRhdGEgcHJvY2Vzc2luZyBhbmQgYWNjZXNzIHRvIHRoZVxuICogYExpc3RWaWV3YCBjb21wb25lbnQuICBBIGBMaXN0Vmlld0RhdGFTb3VyY2VgIGlzIGNyZWF0ZWQgd2l0aCBmdW5jdGlvbnMgZm9yXG4gKiBleHRyYWN0aW5nIGRhdGEgZnJvbSB0aGUgaW5wdXQgYmxvYiwgYW5kIGNvbXBhcmluZyBlbGVtZW50cyAod2l0aCBkZWZhdWx0XG4gKiBpbXBsZW1lbnRhdGlvbnMgZm9yIGNvbnZlbmllbmNlKS4gIFRoZSBpbnB1dCBibG9iIGNhbiBiZSBhcyBzaW1wbGUgYXMgYW5cbiAqIGFycmF5IG9mIHN0cmluZ3MsIG9yIGFuIG9iamVjdCB3aXRoIHJvd3MgbmVzdGVkIGluc2lkZSBzZWN0aW9uIG9iamVjdHMuXG4gKlxuICogVG8gdXBkYXRlIHRoZSBkYXRhIGluIHRoZSBkYXRhc291cmNlLCB1c2UgYGNsb25lV2l0aFJvd3NgIChvclxuICogYGNsb25lV2l0aFJvd3NBbmRTZWN0aW9uc2AgaWYgeW91IGNhcmUgYWJvdXQgc2VjdGlvbnMpLiAgVGhlIGRhdGEgaW4gdGhlXG4gKiBkYXRhIHNvdXJjZSBpcyBpbW11dGFibGUsIHNvIHlvdSBjYW4ndCBtb2RpZnkgaXQgZGlyZWN0bHkuICBUaGUgY2xvbmUgbWV0aG9kc1xuICogc3VjayBpbiB0aGUgbmV3IGRhdGEgYW5kIGNvbXB1dGUgYSBkaWZmIGZvciBlYWNoIHJvdyBzbyBMaXN0VmlldyBrbm93c1xuICogd2hldGhlciB0byByZS1yZW5kZXIgaXQgb3Igbm90LlxuICpcbiAqIEluIHRoaXMgZXhhbXBsZSwgYSBjb21wb25lbnQgcmVjZWl2ZXMgZGF0YSBpbiBjaHVua3MsIGhhbmRsZWQgYnlcbiAqIGBfb25EYXRhQXJyaXZlZGAsIHdoaWNoIGNvbmNhdHMgdGhlIG5ldyBkYXRhIG9udG8gdGhlIG9sZCBkYXRhIGFuZCB1cGRhdGVzIHRoZVxuICogZGF0YSBzb3VyY2UuICBXZSB1c2UgYGNvbmNhdGAgdG8gY3JlYXRlIGEgbmV3IGFycmF5IC0gbXV0YXRpbmcgYHRoaXMuX2RhdGFgLFxuICogZS5nLiB3aXRoIGB0aGlzLl9kYXRhLnB1c2gobmV3Um93RGF0YSlgLCB3b3VsZCBiZSBhbiBlcnJvci4gYF9yb3dIYXNDaGFuZ2VkYFxuICogdW5kZXJzdGFuZHMgdGhlIHNoYXBlIG9mIHRoZSByb3cgZGF0YSBhbmQga25vd3MgaG93IHRvIGVmZmljaWVudGx5IGNvbXBhcmVcbiAqIGl0LlxuICpcbiAqIGBgYFxuICogZ2V0SW5pdGlhbFN0YXRlOiBmdW5jdGlvbigpIHtcbiAqICAgdmFyIGRzID0gbmV3IExpc3RWaWV3LkRhdGFTb3VyY2Uoe3Jvd0hhc0NoYW5nZWQ6IHRoaXMuX3Jvd0hhc0NoYW5nZWR9KTtcbiAqICAgcmV0dXJuIHtkc307XG4gKiB9LFxuICogX29uRGF0YUFycml2ZWQobmV3RGF0YSkge1xuICogICB0aGlzLl9kYXRhID0gdGhpcy5fZGF0YS5jb25jYXQobmV3RGF0YSk7XG4gKiAgIHRoaXMuc2V0U3RhdGUoe1xuICogICAgIGRzOiB0aGlzLnN0YXRlLmRzLmNsb25lV2l0aFJvd3ModGhpcy5fZGF0YSlcbiAqICAgfSk7XG4gKiB9XG4gKiBgYGBcbiAqL1xuXG5jbGFzcyBMaXN0Vmlld0RhdGFTb3VyY2Uge1xuICAvKipcbiAgICogWW91IGNhbiBwcm92aWRlIGN1c3RvbSBleHRyYWN0aW9uIGFuZCBgaGFzQ2hhbmdlZGAgZnVuY3Rpb25zIGZvciBzZWN0aW9uXG4gICAqIGhlYWRlcnMgYW5kIHJvd3MuICBJZiBhYnNlbnQsIGRhdGEgd2lsbCBiZSBleHRyYWN0ZWQgd2l0aCB0aGVcbiAgICogYGRlZmF1bHRHZXRSb3dEYXRhYCBhbmQgYGRlZmF1bHRHZXRTZWN0aW9uSGVhZGVyRGF0YWAgZnVuY3Rpb25zLlxuICAgKlxuICAgKiBUaGUgZGVmYXVsdCBleHRyYWN0b3IgZXhwZWN0cyBkYXRhIG9mIG9uZSBvZiB0aGUgZm9sbG93aW5nIGZvcm1zOlxuICAgKlxuICAgKiAgICAgIHsgc2VjdGlvbklEXzE6IHsgcm93SURfMTogPHJvd0RhdGExPiwgLi4uIH0sIC4uLiB9XG4gICAqXG4gICAqICAgIG9yXG4gICAqXG4gICAqICAgICAgeyBzZWN0aW9uSURfMTogWyA8cm93RGF0YTE+LCA8cm93RGF0YTI+LCAuLi4gXSwgLi4uIH1cbiAgICpcbiAgICogICAgb3JcbiAgICpcbiAgICogICAgICBbIFsgPHJvd0RhdGExPiwgPHJvd0RhdGEyPiwgLi4uIF0sIC4uLiBdXG4gICAqXG4gICAqIFRoZSBjb25zdHJ1Y3RvciB0YWtlcyBpbiBhIHBhcmFtcyBhcmd1bWVudCB0aGF0IGNhbiBjb250YWluIGFueSBvZiB0aGVcbiAgICogZm9sbG93aW5nOlxuICAgKlxuICAgKiAtIGdldFJvd0RhdGEoZGF0YUJsb2IsIHNlY3Rpb25JRCwgcm93SUQpO1xuICAgKiAtIGdldFNlY3Rpb25IZWFkZXJEYXRhKGRhdGFCbG9iLCBzZWN0aW9uSUQpO1xuICAgKiAtIHJvd0hhc0NoYW5nZWQocHJldlJvd0RhdGEsIG5leHRSb3dEYXRhKTtcbiAgICogLSBzZWN0aW9uSGVhZGVySGFzQ2hhbmdlZChwcmV2U2VjdGlvbkRhdGEsIG5leHRTZWN0aW9uRGF0YSk7XG4gICAqL1xuICBjb25zdHJ1Y3RvcihwYXJhbXM6IFBhcmFtVHlwZSkge1xuICAgIGludmFyaWFudChcbiAgICAgIHBhcmFtcyAmJiB0eXBlb2YgcGFyYW1zLnJvd0hhc0NoYW5nZWQgPT09ICdmdW5jdGlvbicsXG4gICAgICAnTXVzdCBwcm92aWRlIGEgcm93SGFzQ2hhbmdlZCBmdW5jdGlvbi4nLFxuICAgICk7XG4gICAgdGhpcy5fcm93SGFzQ2hhbmdlZCA9IHBhcmFtcy5yb3dIYXNDaGFuZ2VkO1xuICAgIHRoaXMuX2dldFJvd0RhdGEgPSBwYXJhbXMuZ2V0Um93RGF0YSB8fCBkZWZhdWx0R2V0Um93RGF0YTtcbiAgICB0aGlzLl9zZWN0aW9uSGVhZGVySGFzQ2hhbmdlZCA9IHBhcmFtcy5zZWN0aW9uSGVhZGVySGFzQ2hhbmdlZDtcbiAgICB0aGlzLl9nZXRTZWN0aW9uSGVhZGVyRGF0YSA9XG4gICAgICBwYXJhbXMuZ2V0U2VjdGlvbkhlYWRlckRhdGEgfHwgZGVmYXVsdEdldFNlY3Rpb25IZWFkZXJEYXRhO1xuXG4gICAgdGhpcy5fZGF0YUJsb2IgPSBudWxsO1xuICAgIHRoaXMuX2RpcnR5Um93cyA9IFtdO1xuICAgIHRoaXMuX2RpcnR5U2VjdGlvbnMgPSBbXTtcbiAgICB0aGlzLl9jYWNoZWRSb3dDb3VudCA9IDA7XG5cbiAgICAvLyBUaGVzZSB0d28gcHJpdmF0ZSB2YXJpYWJsZXMgYXJlIGFjY2Vzc2VkIGJ5IG91dHNpZGVycyBiZWNhdXNlIExpc3RWaWV3XG4gICAgLy8gdXNlcyB0aGVtIHRvIGl0ZXJhdGUgb3ZlciB0aGUgZGF0YSBpbiB0aGlzIGNsYXNzLlxuICAgIHRoaXMucm93SWRlbnRpdGllcyA9IFtdO1xuICAgIHRoaXMuc2VjdGlvbklkZW50aXRpZXMgPSBbXTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDbG9uZXMgdGhpcyBgTGlzdFZpZXdEYXRhU291cmNlYCB3aXRoIHRoZSBzcGVjaWZpZWQgYGRhdGFCbG9iYCBhbmRcbiAgICogYHJvd0lkZW50aXRpZXNgLiBUaGUgYGRhdGFCbG9iYCBpcyBqdXN0IGFuIGFyYml0cmFyeSBibG9iIG9mIGRhdGEuIEF0XG4gICAqIGNvbnN0cnVjdGlvbiBhbiBleHRyYWN0b3IgdG8gZ2V0IHRoZSBpbnRlcmVzdGluZyBpbmZvcm1hdGlvbiB3YXMgZGVmaW5lZFxuICAgKiAob3IgdGhlIGRlZmF1bHQgd2FzIHVzZWQpLlxuICAgKlxuICAgKiBUaGUgYHJvd0lkZW50aXRpZXNgIGlzIGEgMkQgYXJyYXkgb2YgaWRlbnRpZmllcnMgZm9yIHJvd3MuXG4gICAqIGllLiBbWydhMScsICdhMiddLCBbJ2IxJywgJ2IyJywgJ2IzJ10sIC4uLl0uICBJZiBub3QgcHJvdmlkZWQsIGl0J3NcbiAgICogYXNzdW1lZCB0aGF0IHRoZSBrZXlzIG9mIHRoZSBzZWN0aW9uIGRhdGEgYXJlIHRoZSByb3cgaWRlbnRpdGllcy5cbiAgICpcbiAgICogTm90ZTogVGhpcyBmdW5jdGlvbiBkb2VzIE5PVCBjbG9uZSB0aGUgZGF0YSBpbiB0aGlzIGRhdGEgc291cmNlLiBJdCBzaW1wbHlcbiAgICogcGFzc2VzIHRoZSBmdW5jdGlvbnMgZGVmaW5lZCBhdCBjb25zdHJ1Y3Rpb24gdG8gYSBuZXcgZGF0YSBzb3VyY2Ugd2l0aFxuICAgKiB0aGUgZGF0YSBzcGVjaWZpZWQuIElmIHlvdSB3aXNoIHRvIG1haW50YWluIHRoZSBleGlzdGluZyBkYXRhIHlvdSBtdXN0XG4gICAqIGhhbmRsZSBtZXJnaW5nIG9mIG9sZCBhbmQgbmV3IGRhdGEgc2VwYXJhdGVseSBhbmQgdGhlbiBwYXNzIHRoYXQgaW50b1xuICAgKiB0aGlzIGZ1bmN0aW9uIGFzIHRoZSBgZGF0YUJsb2JgLlxuICAgKi9cbiAgY2xvbmVXaXRoUm93cyhcbiAgICBkYXRhQmxvYjogJFJlYWRPbmx5QXJyYXk8YW55PiB8IHsrW2tleTogc3RyaW5nXTogYW55fSxcbiAgICByb3dJZGVudGl0aWVzOiA/JFJlYWRPbmx5QXJyYXk8c3RyaW5nPixcbiAgKTogTGlzdFZpZXdEYXRhU291cmNlIHtcbiAgICBjb25zdCByb3dJZHMgPSByb3dJZGVudGl0aWVzID8gW1suLi5yb3dJZGVudGl0aWVzXV0gOiBudWxsO1xuICAgIGlmICghdGhpcy5fc2VjdGlvbkhlYWRlckhhc0NoYW5nZWQpIHtcbiAgICAgIHRoaXMuX3NlY3Rpb25IZWFkZXJIYXNDaGFuZ2VkID0gKCkgPT4gZmFsc2U7XG4gICAgfVxuICAgIHJldHVybiB0aGlzLmNsb25lV2l0aFJvd3NBbmRTZWN0aW9ucyh7czE6IGRhdGFCbG9ifSwgWydzMSddLCByb3dJZHMpO1xuICB9XG5cbiAgLyoqXG4gICAqIFRoaXMgcGVyZm9ybXMgdGhlIHNhbWUgZnVuY3Rpb24gYXMgdGhlIGBjbG9uZVdpdGhSb3dzYCBmdW5jdGlvbiBidXQgaGVyZVxuICAgKiB5b3UgYWxzbyBzcGVjaWZ5IHdoYXQgeW91ciBgc2VjdGlvbklkZW50aXRpZXNgIGFyZS4gSWYgeW91IGRvbid0IGNhcmVcbiAgICogYWJvdXQgc2VjdGlvbnMgeW91IHNob3VsZCBzYWZlbHkgYmUgYWJsZSB0byB1c2UgYGNsb25lV2l0aFJvd3NgLlxuICAgKlxuICAgKiBgc2VjdGlvbklkZW50aXRpZXNgIGlzIGFuIGFycmF5IG9mIGlkZW50aWZpZXJzIGZvciBzZWN0aW9ucy5cbiAgICogaWUuIFsnczEnLCAnczInLCAuLi5dLiAgVGhlIGlkZW50aWZpZXJzIHNob3VsZCBjb3JyZXNwb25kIHRvIHRoZSBrZXlzIG9yIGFycmF5IGluZGV4ZXNcbiAgICogb2YgdGhlIGRhdGEgeW91IHdpc2ggdG8gaW5jbHVkZS4gIElmIG5vdCBwcm92aWRlZCwgaXQncyBhc3N1bWVkIHRoYXQgdGhlXG4gICAqIGtleXMgb2YgZGF0YUJsb2IgYXJlIHRoZSBzZWN0aW9uIGlkZW50aXRpZXMuXG4gICAqXG4gICAqIE5vdGU6IHRoaXMgcmV0dXJucyBhIG5ldyBvYmplY3QhXG4gICAqXG4gICAqIGBgYFxuICAgKiBjb25zdCBkYXRhU291cmNlID0gZHMuY2xvbmVXaXRoUm93c0FuZFNlY3Rpb25zKHtcbiAgICogICBhZGRyZXNzZXM6IFsncm93IDEnLCAncm93IDInXSxcbiAgICogICBwaG9uZV9udW1iZXJzOiBbJ2RhdGEgMScsICdkYXRhIDInXSxcbiAgICogfSwgWydwaG9uZV9udW1iZXJzJ10pO1xuICAgKiBgYGBcbiAgICovXG4gIGNsb25lV2l0aFJvd3NBbmRTZWN0aW9ucyhcbiAgICBkYXRhQmxvYjogYW55LFxuICAgIHNlY3Rpb25JZGVudGl0aWVzOiA/QXJyYXk8c3RyaW5nPixcbiAgICByb3dJZGVudGl0aWVzOiA/QXJyYXk8QXJyYXk8c3RyaW5nPj4sXG4gICk6IExpc3RWaWV3RGF0YVNvdXJjZSB7XG4gICAgaW52YXJpYW50KFxuICAgICAgdHlwZW9mIHRoaXMuX3NlY3Rpb25IZWFkZXJIYXNDaGFuZ2VkID09PSAnZnVuY3Rpb24nLFxuICAgICAgJ011c3QgcHJvdmlkZSBhIHNlY3Rpb25IZWFkZXJIYXNDaGFuZ2VkIGZ1bmN0aW9uIHdpdGggc2VjdGlvbiBkYXRhLicsXG4gICAgKTtcbiAgICBpbnZhcmlhbnQoXG4gICAgICAhc2VjdGlvbklkZW50aXRpZXMgfHxcbiAgICAgICAgIXJvd0lkZW50aXRpZXMgfHxcbiAgICAgICAgc2VjdGlvbklkZW50aXRpZXMubGVuZ3RoID09PSByb3dJZGVudGl0aWVzLmxlbmd0aCxcbiAgICAgICdyb3cgYW5kIHNlY3Rpb24gaWRzIGxlbmd0aHMgbXVzdCBiZSB0aGUgc2FtZScsXG4gICAgKTtcblxuICAgIGNvbnN0IG5ld1NvdXJjZSA9IG5ldyBMaXN0Vmlld0RhdGFTb3VyY2Uoe1xuICAgICAgZ2V0Um93RGF0YTogdGhpcy5fZ2V0Um93RGF0YSxcbiAgICAgIGdldFNlY3Rpb25IZWFkZXJEYXRhOiB0aGlzLl9nZXRTZWN0aW9uSGVhZGVyRGF0YSxcbiAgICAgIHJvd0hhc0NoYW5nZWQ6IHRoaXMuX3Jvd0hhc0NoYW5nZWQsXG4gICAgICBzZWN0aW9uSGVhZGVySGFzQ2hhbmdlZDogdGhpcy5fc2VjdGlvbkhlYWRlckhhc0NoYW5nZWQsXG4gICAgfSk7XG4gICAgbmV3U291cmNlLl9kYXRhQmxvYiA9IGRhdGFCbG9iO1xuICAgIGlmIChzZWN0aW9uSWRlbnRpdGllcykge1xuICAgICAgbmV3U291cmNlLnNlY3Rpb25JZGVudGl0aWVzID0gc2VjdGlvbklkZW50aXRpZXM7XG4gICAgfSBlbHNlIHtcbiAgICAgIG5ld1NvdXJjZS5zZWN0aW9uSWRlbnRpdGllcyA9IE9iamVjdC5rZXlzKGRhdGFCbG9iKTtcbiAgICB9XG4gICAgaWYgKHJvd0lkZW50aXRpZXMpIHtcbiAgICAgIG5ld1NvdXJjZS5yb3dJZGVudGl0aWVzID0gcm93SWRlbnRpdGllcztcbiAgICB9IGVsc2Uge1xuICAgICAgbmV3U291cmNlLnJvd0lkZW50aXRpZXMgPSBbXTtcbiAgICAgIG5ld1NvdXJjZS5zZWN0aW9uSWRlbnRpdGllcy5mb3JFYWNoKHNlY3Rpb25JRCA9PiB7XG4gICAgICAgIG5ld1NvdXJjZS5yb3dJZGVudGl0aWVzLnB1c2goT2JqZWN0LmtleXMoZGF0YUJsb2Jbc2VjdGlvbklEXSkpO1xuICAgICAgfSk7XG4gICAgfVxuICAgIG5ld1NvdXJjZS5fY2FjaGVkUm93Q291bnQgPSBjb3VudFJvd3MobmV3U291cmNlLnJvd0lkZW50aXRpZXMpO1xuXG4gICAgbmV3U291cmNlLl9jYWxjdWxhdGVEaXJ0eUFycmF5cyhcbiAgICAgIHRoaXMuX2RhdGFCbG9iLFxuICAgICAgdGhpcy5zZWN0aW9uSWRlbnRpdGllcyxcbiAgICAgIHRoaXMucm93SWRlbnRpdGllcyxcbiAgICApO1xuXG4gICAgcmV0dXJuIG5ld1NvdXJjZTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXR1cm5zIHRoZSB0b3RhbCBudW1iZXIgb2Ygcm93cyBpbiB0aGUgZGF0YSBzb3VyY2UuXG4gICAqXG4gICAqIElmIHlvdSBhcmUgc3BlY2lmeWluZyB0aGUgcm93SWRlbnRpdGllcyBvciBzZWN0aW9uSWRlbnRpdGllcywgdGhlbiBgZ2V0Um93Q291bnRgIHdpbGwgcmV0dXJuIHRoZSBudW1iZXIgb2Ygcm93cyBpbiB0aGUgZmlsdGVyZWQgZGF0YSBzb3VyY2UuXG4gICAqL1xuICBnZXRSb3dDb3VudCgpOiBudW1iZXIge1xuICAgIHJldHVybiB0aGlzLl9jYWNoZWRSb3dDb3VudDtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXR1cm5zIHRoZSB0b3RhbCBudW1iZXIgb2Ygcm93cyBpbiB0aGUgZGF0YSBzb3VyY2UgKHNlZSBgZ2V0Um93Q291bnRgIGZvciBob3cgdGhpcyBpcyBjYWxjdWxhdGVkKSBwbHVzIHRoZSBudW1iZXIgb2Ygc2VjdGlvbnMgaW4gdGhlIGRhdGEuXG4gICAqXG4gICAqIElmIHlvdSBhcmUgc3BlY2lmeWluZyB0aGUgcm93SWRlbnRpdGllcyBvciBzZWN0aW9uSWRlbnRpdGllcywgdGhlbiBgZ2V0Um93QW5kU2VjdGlvbkNvdW50YCB3aWxsIHJldHVybiB0aGUgbnVtYmVyIG9mIHJvd3MgJiBzZWN0aW9ucyBpbiB0aGUgZmlsdGVyZWQgZGF0YSBzb3VyY2UuXG4gICAqL1xuICBnZXRSb3dBbmRTZWN0aW9uQ291bnQoKTogbnVtYmVyIHtcbiAgICByZXR1cm4gdGhpcy5fY2FjaGVkUm93Q291bnQgKyB0aGlzLnNlY3Rpb25JZGVudGl0aWVzLmxlbmd0aDtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXR1cm5zIGlmIHRoZSByb3cgaXMgZGlydGllZCBhbmQgbmVlZHMgdG8gYmUgcmVyZW5kZXJlZFxuICAgKi9cbiAgcm93U2hvdWxkVXBkYXRlKHNlY3Rpb25JbmRleDogbnVtYmVyLCByb3dJbmRleDogbnVtYmVyKTogYm9vbGVhbiB7XG4gICAgY29uc3QgbmVlZHNVcGRhdGUgPSB0aGlzLl9kaXJ0eVJvd3Nbc2VjdGlvbkluZGV4XVtyb3dJbmRleF07XG4gICAgd2FybmluZyhcbiAgICAgIG5lZWRzVXBkYXRlICE9PSB1bmRlZmluZWQsXG4gICAgICAnbWlzc2luZyBkaXJ0eUJpdCBmb3Igc2VjdGlvbiwgcm93OiAnICsgc2VjdGlvbkluZGV4ICsgJywgJyArIHJvd0luZGV4LFxuICAgICk7XG4gICAgcmV0dXJuIG5lZWRzVXBkYXRlO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldHMgdGhlIGRhdGEgcmVxdWlyZWQgdG8gcmVuZGVyIHRoZSByb3cuXG4gICAqL1xuICBnZXRSb3dEYXRhKHNlY3Rpb25JbmRleDogbnVtYmVyLCByb3dJbmRleDogbnVtYmVyKTogYW55IHtcbiAgICBjb25zdCBzZWN0aW9uSUQgPSB0aGlzLnNlY3Rpb25JZGVudGl0aWVzW3NlY3Rpb25JbmRleF07XG4gICAgY29uc3Qgcm93SUQgPSB0aGlzLnJvd0lkZW50aXRpZXNbc2VjdGlvbkluZGV4XVtyb3dJbmRleF07XG4gICAgd2FybmluZyhcbiAgICAgIHNlY3Rpb25JRCAhPT0gdW5kZWZpbmVkICYmIHJvd0lEICE9PSB1bmRlZmluZWQsXG4gICAgICAncmVuZGVyaW5nIGludmFsaWQgc2VjdGlvbiwgcm93OiAnICsgc2VjdGlvbkluZGV4ICsgJywgJyArIHJvd0luZGV4LFxuICAgICk7XG4gICAgcmV0dXJuIHRoaXMuX2dldFJvd0RhdGEodGhpcy5fZGF0YUJsb2IsIHNlY3Rpb25JRCwgcm93SUQpO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldHMgdGhlIHJvd0lEIGF0IGluZGV4IHByb3ZpZGVkIGlmIHRoZSBkYXRhU291cmNlIGFycmF5cyB3ZXJlIGZsYXR0ZW5lZCxcbiAgICogb3IgbnVsbCBvZiBvdXQgb2YgcmFuZ2UgaW5kZXhlcy5cbiAgICovXG4gIGdldFJvd0lERm9yRmxhdEluZGV4KGluZGV4OiBudW1iZXIpOiA/c3RyaW5nIHtcbiAgICBsZXQgYWNjZXNzSW5kZXggPSBpbmRleDtcbiAgICBmb3IgKGxldCBpaSA9IDA7IGlpIDwgdGhpcy5zZWN0aW9uSWRlbnRpdGllcy5sZW5ndGg7IGlpKyspIHtcbiAgICAgIGlmIChhY2Nlc3NJbmRleCA+PSB0aGlzLnJvd0lkZW50aXRpZXNbaWldLmxlbmd0aCkge1xuICAgICAgICBhY2Nlc3NJbmRleCAtPSB0aGlzLnJvd0lkZW50aXRpZXNbaWldLmxlbmd0aDtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiB0aGlzLnJvd0lkZW50aXRpZXNbaWldW2FjY2Vzc0luZGV4XTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cblxuICAvKipcbiAgICogR2V0cyB0aGUgc2VjdGlvbklEIGF0IGluZGV4IHByb3ZpZGVkIGlmIHRoZSBkYXRhU291cmNlIGFycmF5cyB3ZXJlIGZsYXR0ZW5lZCxcbiAgICogb3IgbnVsbCBmb3Igb3V0IG9mIHJhbmdlIGluZGV4ZXMuXG4gICAqL1xuICBnZXRTZWN0aW9uSURGb3JGbGF0SW5kZXgoaW5kZXg6IG51bWJlcik6ID9zdHJpbmcge1xuICAgIGxldCBhY2Nlc3NJbmRleCA9IGluZGV4O1xuICAgIGZvciAobGV0IGlpID0gMDsgaWkgPCB0aGlzLnNlY3Rpb25JZGVudGl0aWVzLmxlbmd0aDsgaWkrKykge1xuICAgICAgaWYgKGFjY2Vzc0luZGV4ID49IHRoaXMucm93SWRlbnRpdGllc1tpaV0ubGVuZ3RoKSB7XG4gICAgICAgIGFjY2Vzc0luZGV4IC09IHRoaXMucm93SWRlbnRpdGllc1tpaV0ubGVuZ3RoO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc2VjdGlvbklkZW50aXRpZXNbaWldO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXR1cm5zIGFuIGFycmF5IGNvbnRhaW5pbmcgdGhlIG51bWJlciBvZiByb3dzIGluIGVhY2ggc2VjdGlvblxuICAgKi9cbiAgZ2V0U2VjdGlvbkxlbmd0aHMoKTogQXJyYXk8bnVtYmVyPiB7XG4gICAgY29uc3QgcmVzdWx0cyA9IFtdO1xuICAgIGZvciAobGV0IGlpID0gMDsgaWkgPCB0aGlzLnNlY3Rpb25JZGVudGl0aWVzLmxlbmd0aDsgaWkrKykge1xuICAgICAgcmVzdWx0cy5wdXNoKHRoaXMucm93SWRlbnRpdGllc1tpaV0ubGVuZ3RoKTtcbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdHM7XG4gIH1cblxuICAvKipcbiAgICogUmV0dXJucyBpZiB0aGUgc2VjdGlvbiBoZWFkZXIgaXMgZGlydGllZCBhbmQgbmVlZHMgdG8gYmUgcmVyZW5kZXJlZFxuICAgKi9cbiAgc2VjdGlvbkhlYWRlclNob3VsZFVwZGF0ZShzZWN0aW9uSW5kZXg6IG51bWJlcik6IGJvb2xlYW4ge1xuICAgIGNvbnN0IG5lZWRzVXBkYXRlID0gdGhpcy5fZGlydHlTZWN0aW9uc1tzZWN0aW9uSW5kZXhdO1xuICAgIHdhcm5pbmcoXG4gICAgICBuZWVkc1VwZGF0ZSAhPT0gdW5kZWZpbmVkLFxuICAgICAgJ21pc3NpbmcgZGlydHlCaXQgZm9yIHNlY3Rpb246ICcgKyBzZWN0aW9uSW5kZXgsXG4gICAgKTtcbiAgICByZXR1cm4gbmVlZHNVcGRhdGU7XG4gIH1cblxuICAvKipcbiAgICogR2V0cyB0aGUgZGF0YSByZXF1aXJlZCB0byByZW5kZXIgdGhlIHNlY3Rpb24gaGVhZGVyXG4gICAqL1xuICBnZXRTZWN0aW9uSGVhZGVyRGF0YShzZWN0aW9uSW5kZXg6IG51bWJlcik6IGFueSB7XG4gICAgaWYgKCF0aGlzLl9nZXRTZWN0aW9uSGVhZGVyRGF0YSkge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIGNvbnN0IHNlY3Rpb25JRCA9IHRoaXMuc2VjdGlvbklkZW50aXRpZXNbc2VjdGlvbkluZGV4XTtcbiAgICB3YXJuaW5nKFxuICAgICAgc2VjdGlvbklEICE9PSB1bmRlZmluZWQsXG4gICAgICAncmVuZGVyU2VjdGlvbiBjYWxsZWQgb24gaW52YWxpZCBzZWN0aW9uOiAnICsgc2VjdGlvbkluZGV4LFxuICAgICk7XG4gICAgcmV0dXJuIHRoaXMuX2dldFNlY3Rpb25IZWFkZXJEYXRhKHRoaXMuX2RhdGFCbG9iLCBzZWN0aW9uSUQpO1xuICB9XG5cbiAgLyoqXG4gICAqIFByaXZhdGUgbWVtYmVycyBhbmQgbWV0aG9kcy5cbiAgICovXG5cbiAgX2dldFJvd0RhdGE6IHR5cGVvZiBkZWZhdWx0R2V0Um93RGF0YTtcbiAgX2dldFNlY3Rpb25IZWFkZXJEYXRhOiB0eXBlb2YgZGVmYXVsdEdldFNlY3Rpb25IZWFkZXJEYXRhO1xuICBfcm93SGFzQ2hhbmdlZDogZGlmZmVyVHlwZTtcbiAgX3NlY3Rpb25IZWFkZXJIYXNDaGFuZ2VkOiA/ZGlmZmVyVHlwZTtcblxuICBfZGF0YUJsb2I6IGFueTtcbiAgX2RpcnR5Um93czogQXJyYXk8QXJyYXk8Ym9vbGVhbj4+O1xuICBfZGlydHlTZWN0aW9uczogQXJyYXk8Ym9vbGVhbj47XG4gIF9jYWNoZWRSb3dDb3VudDogbnVtYmVyO1xuXG4gIC8vIFRoZXNlIHR3byAncHJvdGVjdGVkJyB2YXJpYWJsZXMgYXJlIGFjY2Vzc2VkIGJ5IExpc3RWaWV3IHRvIGl0ZXJhdGUgb3ZlclxuICAvLyB0aGUgZGF0YSBpbiB0aGlzIGNsYXNzLlxuICByb3dJZGVudGl0aWVzOiBBcnJheTxBcnJheTxzdHJpbmc+PjtcbiAgc2VjdGlvbklkZW50aXRpZXM6IEFycmF5PHN0cmluZz47XG5cbiAgX2NhbGN1bGF0ZURpcnR5QXJyYXlzKFxuICAgIHByZXZEYXRhQmxvYjogYW55LFxuICAgIHByZXZTZWN0aW9uSURzOiBBcnJheTxzdHJpbmc+LFxuICAgIHByZXZSb3dJRHM6IEFycmF5PEFycmF5PHN0cmluZz4+LFxuICApOiB2b2lkIHtcbiAgICAvLyBjb25zdHJ1Y3QgYSBoYXNobWFwIG9mIHRoZSBleGlzdGluZyAob2xkKSBpZCBhcnJheXNcbiAgICBjb25zdCBwcmV2U2VjdGlvbnNIYXNoID0ga2V5ZWREaWN0aW9uYXJ5RnJvbUFycmF5KHByZXZTZWN0aW9uSURzKTtcbiAgICBjb25zdCBwcmV2Um93c0hhc2ggPSB7fTtcbiAgICBmb3IgKGxldCBpaSA9IDA7IGlpIDwgcHJldlJvd0lEcy5sZW5ndGg7IGlpKyspIHtcbiAgICAgIHZhciBzZWN0aW9uSUQgPSBwcmV2U2VjdGlvbklEc1tpaV07XG4gICAgICB3YXJuaW5nKFxuICAgICAgICAhcHJldlJvd3NIYXNoW3NlY3Rpb25JRF0sXG4gICAgICAgICdTZWN0aW9uSUQgYXBwZWFycyBtb3JlIHRoYW4gb25jZTogJyArIHNlY3Rpb25JRCxcbiAgICAgICk7XG4gICAgICBwcmV2Um93c0hhc2hbc2VjdGlvbklEXSA9IGtleWVkRGljdGlvbmFyeUZyb21BcnJheShwcmV2Um93SURzW2lpXSk7XG4gICAgfVxuXG4gICAgLy8gY29tcGFyZSB0aGUgMiBpZGVudGl0eSBhcnJheSBhbmQgZ2V0IHRoZSBkaXJ0aWVkIHJvd3NcbiAgICB0aGlzLl9kaXJ0eVNlY3Rpb25zID0gW107XG4gICAgdGhpcy5fZGlydHlSb3dzID0gW107XG5cbiAgICBsZXQgZGlydHk7XG4gICAgZm9yIChsZXQgc0luZGV4ID0gMDsgc0luZGV4IDwgdGhpcy5zZWN0aW9uSWRlbnRpdGllcy5sZW5ndGg7IHNJbmRleCsrKSB7XG4gICAgICB2YXIgc2VjdGlvbklEID0gdGhpcy5zZWN0aW9uSWRlbnRpdGllc1tzSW5kZXhdO1xuICAgICAgLy8gZGlydHkgaWYgdGhlIHNlY3Rpb25IZWFkZXIgaXMgbmV3IG9yIF9zZWN0aW9uSGFzQ2hhbmdlZCBpcyB0cnVlXG4gICAgICBkaXJ0eSA9ICFwcmV2U2VjdGlvbnNIYXNoW3NlY3Rpb25JRF07XG4gICAgICBjb25zdCBzZWN0aW9uSGVhZGVySGFzQ2hhbmdlZCA9IHRoaXMuX3NlY3Rpb25IZWFkZXJIYXNDaGFuZ2VkO1xuICAgICAgaWYgKCFkaXJ0eSAmJiBzZWN0aW9uSGVhZGVySGFzQ2hhbmdlZCkge1xuICAgICAgICBkaXJ0eSA9IHNlY3Rpb25IZWFkZXJIYXNDaGFuZ2VkKFxuICAgICAgICAgIHRoaXMuX2dldFNlY3Rpb25IZWFkZXJEYXRhKHByZXZEYXRhQmxvYiwgc2VjdGlvbklEKSxcbiAgICAgICAgICB0aGlzLl9nZXRTZWN0aW9uSGVhZGVyRGF0YSh0aGlzLl9kYXRhQmxvYiwgc2VjdGlvbklEKSxcbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICAgIHRoaXMuX2RpcnR5U2VjdGlvbnMucHVzaCghIWRpcnR5KTtcblxuICAgICAgdGhpcy5fZGlydHlSb3dzW3NJbmRleF0gPSBbXTtcbiAgICAgIGZvciAoXG4gICAgICAgIGxldCBySW5kZXggPSAwO1xuICAgICAgICBySW5kZXggPCB0aGlzLnJvd0lkZW50aXRpZXNbc0luZGV4XS5sZW5ndGg7XG4gICAgICAgIHJJbmRleCsrXG4gICAgICApIHtcbiAgICAgICAgY29uc3Qgcm93SUQgPSB0aGlzLnJvd0lkZW50aXRpZXNbc0luZGV4XVtySW5kZXhdO1xuICAgICAgICAvLyBkaXJ0eSBpZiB0aGUgc2VjdGlvbiBpcyBuZXcsIHJvdyBpcyBuZXcgb3IgX3Jvd0hhc0NoYW5nZWQgaXMgdHJ1ZVxuICAgICAgICBkaXJ0eSA9XG4gICAgICAgICAgIXByZXZTZWN0aW9uc0hhc2hbc2VjdGlvbklEXSB8fFxuICAgICAgICAgICFwcmV2Um93c0hhc2hbc2VjdGlvbklEXVtyb3dJRF0gfHxcbiAgICAgICAgICB0aGlzLl9yb3dIYXNDaGFuZ2VkKFxuICAgICAgICAgICAgdGhpcy5fZ2V0Um93RGF0YShwcmV2RGF0YUJsb2IsIHNlY3Rpb25JRCwgcm93SUQpLFxuICAgICAgICAgICAgdGhpcy5fZ2V0Um93RGF0YSh0aGlzLl9kYXRhQmxvYiwgc2VjdGlvbklELCByb3dJRCksXG4gICAgICAgICAgKTtcbiAgICAgICAgdGhpcy5fZGlydHlSb3dzW3NJbmRleF0ucHVzaCghIWRpcnR5KTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbn1cblxuZnVuY3Rpb24gY291bnRSb3dzKGFsbFJvd0lEcykge1xuICBsZXQgdG90YWxSb3dzID0gMDtcbiAgZm9yIChsZXQgc2VjdGlvbklkeCA9IDA7IHNlY3Rpb25JZHggPCBhbGxSb3dJRHMubGVuZ3RoOyBzZWN0aW9uSWR4KyspIHtcbiAgICBjb25zdCByb3dJRHMgPSBhbGxSb3dJRHNbc2VjdGlvbklkeF07XG4gICAgdG90YWxSb3dzICs9IHJvd0lEcy5sZW5ndGg7XG4gIH1cbiAgcmV0dXJuIHRvdGFsUm93cztcbn1cblxuZnVuY3Rpb24ga2V5ZWREaWN0aW9uYXJ5RnJvbUFycmF5KGFycikge1xuICBpZiAoaXNFbXB0eShhcnIpKSB7XG4gICAgcmV0dXJuIHt9O1xuICB9XG4gIGNvbnN0IHJlc3VsdCA9IHt9O1xuICBmb3IgKGxldCBpaSA9IDA7IGlpIDwgYXJyLmxlbmd0aDsgaWkrKykge1xuICAgIGNvbnN0IGtleSA9IGFycltpaV07XG4gICAgd2FybmluZyghcmVzdWx0W2tleV0sICdWYWx1ZSBhcHBlYXJzIG1vcmUgdGhhbiBvbmNlIGluIGFycmF5OiAnICsga2V5KTtcbiAgICByZXN1bHRba2V5XSA9IHRydWU7XG4gIH1cbiAgcmV0dXJuIHJlc3VsdDtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBMaXN0Vmlld0RhdGFTb3VyY2U7XG4iXX0=